============================= test session starts =============================
platform win32 -- Python 3.10.6, pytest-7.4.3, pluggy-1.5.0
rootdir: D:\Code\projects\tapp\code\2025\simpler_st
plugins: anyio-4.4.0, dash-2.17.1, cov-6.1.1
collected 61 items

tests\test_backtest_engine.py .F..F.......                               [ 19%]
tests\test_data_fetcher.py ....                                          [ 26%]
tests\test_market_regimes.py ........                                    [ 39%]
tests\test_pipeline.py FF.                                               [ 44%]
tests\test_report_generation.py ......F....F........F.FF.F.....          [ 95%]
tests\test_transaction_costs.py ...                                      [100%]

================================== FAILURES ===================================
___________________________ test_rsi_strategy_basic ___________________________

    def test_rsi_strategy_basic():
        # Minimal price data to simulate RSI overbought/oversold
        data = pd.DataFrame({
            'close': [1, 2, 3, 4, 5, 6, 7, 6, 5, 4, 3, 2, 1, 2, 3, 4, 5]
        })
        period = 5
        overbought = 70
        oversold = 30
        # For this test, expect a buy when RSI crosses above oversold, sell when crosses below overbought
        # We'll just check that the function returns a list of trades with correct actions
>       signals, trade_log = backtest.rsi_strategy_backtest(data[['close']], period, overbought, oversold)

tests\test_backtest_engine.py:44: 
_ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _

data =     close    rsi
0       1    NaN
1       2    NaN
2       3    NaN
3       4    NaN
4       5    NaN
5       6  100.0...
10      3   20.0
11      2    0.0
12      1    0.0
13      2   20.0
14      3   40.0
15      4   60.0
16      5   80.0
period = 5, overbought = 70, oversold = 30, strategy_params = None

    def rsi_strategy_backtest(data: pd.DataFrame, period: int, overbought: float, oversold: float, strategy_params: dict = None):
        data = data.copy()
        delta = data['close'].diff()
        gain = delta.clip(lower=0)
        loss = -delta.clip(upper=0)
        avg_gain = gain.rolling(window=period, min_periods=period).mean()
        avg_loss = loss.rolling(window=period, min_periods=period).mean()
        rs = avg_gain / avg_loss
        data['rsi'] = 100 - (100 / (1 + rs))
        signals = []
        trade_log = []
        position = None
        entry_index = None
        entry_price = None
        commission = 0.0
        slippage = 0.0
        if strategy_params:
            commission = strategy_params.get('commission', 0.0)
            slippage = strategy_params.get('slippage', 0.0)
        for idx, row in data.iterrows():
            if row['rsi'] < oversold and position != 'long':
                signals.append({'action': 'buy', 'index': idx})
                position = 'long'
                entry_index = idx
                entry_price = row['close']
            elif row['rsi'] > overbought and position == 'long':
                signals.append({'action': 'sell', 'index': idx})
                exit_index = idx
                exit_price = row['close']
                adj_entry, adj_exit, net_pnl, commission_cost = apply_transaction_costs(entry_price, exit_price, commission, slippage)
                trade_log.append({
                    'entry_index': entry_index,
                    'exit_index': exit_index,
                    'entry_price': adj_entry,
                    'exit_price': adj_exit,
                    'pnl': net_pnl,
                    'commission_cost': commission_cost,
                    'rationale': f"{'Buy' if net_pnl > 0 else 'Sell'}: RSI strategy trade",
                    # Always include ticker, context, indicators
>                   'ticker': strategy_params.get('ticker', 'UNKNOWN'),
                    'context': [],
                    'indicators': {
                        'rsi': row['rsi']
                    }
                })
E               AttributeError: 'NoneType' object has no attribute 'get'

tech_analysis\backtest.py:212: AttributeError
___________________ test_export_backtest_results_for_report ___________________

tmp_path = WindowsPath('C:/Users/user/AppData/Local/Temp/pytest-of-user/pytest-262/test_export_backtest_results_f0')

    def test_export_backtest_results_for_report(tmp_path):
        """
        Test exporting backtest results (trade log and metrics) to a JSON file for report generation.
        """
        data = pd.DataFrame({
            'close': [10, 11, 12, 13, 12, 11, 10, 9, 10, 11, 12, 13]
        })
        short_window = 2
        long_window = 3
        strategy_params = {'context_window': 10} # Add dummy params for the test
        trades, trade_log = backtest.sma_crossover_backtest_with_log(data[['close']], short_window, long_window, strategy_params)
        equity_curve = [row['exit_price'] if 'exit_price' in row else 0 for row in trade_log]
        metrics = backtest.calculate_performance_metrics(equity_curve, trade_log)
        output_file = tmp_path / "backtest_export.json"
        # This should raise if export_backtest_results is not implemented
>       backtest.export_backtest_results(trade_log, metrics, str(output_file))

tests\test_backtest_engine.py:145: 
_ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _
tech_analysis\backtest.py:303: in export_backtest_results
    json.dump({'trade_log': trade_log, 'metrics': metrics}, f)
C:\Users\user\AppData\Local\Programs\Python\Python310\lib\json\__init__.py:179: in dump
    for chunk in iterable:
C:\Users\user\AppData\Local\Programs\Python\Python310\lib\json\encoder.py:431: in _iterencode
    yield from _iterencode_dict(o, _current_indent_level)
C:\Users\user\AppData\Local\Programs\Python\Python310\lib\json\encoder.py:405: in _iterencode_dict
    yield from chunks
C:\Users\user\AppData\Local\Programs\Python\Python310\lib\json\encoder.py:325: in _iterencode_list
    yield from chunks
C:\Users\user\AppData\Local\Programs\Python\Python310\lib\json\encoder.py:405: in _iterencode_dict
    yield from chunks
C:\Users\user\AppData\Local\Programs\Python\Python310\lib\json\encoder.py:325: in _iterencode_list
    yield from chunks
C:\Users\user\AppData\Local\Programs\Python\Python310\lib\json\encoder.py:438: in _iterencode
    o = _default(o)
..\..\..\lib\site-packages\frozendict\__init__.py:32: in default
    return BaseJsonEncoder.default(self, obj)
_ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _

self = <frozendict._getFrozendictJsonEncoder.<locals>.FrozendictJsonEncoder object at 0x000001BD201D22C0>
o = 10

    def default(self, o):
        """Implement this method in a subclass such that it returns
        a serializable object for ``o``, or calls the base implementation
        (to raise a ``TypeError``).
    
        For example, to support arbitrary iterators, you could
        implement default like this::
    
            def default(self, o):
                try:
                    iterable = iter(o)
                except TypeError:
                    pass
                else:
                    return list(iterable)
                # Let the base class default method raise the TypeError
                return JSONEncoder.default(self, o)
    
        """
>       raise TypeError(f'Object of type {o.__class__.__name__} '
                        f'is not JSON serializable')
E       TypeError: Object of type int64 is not JSON serializable

C:\Users\user\AppData\Local\Programs\Python\Python310\lib\json\encoder.py:179: TypeError
___________________ test_pipeline_generates_markdown_report ___________________

tmp_path = WindowsPath('C:/Users/user/AppData/Local/Temp/pytest-of-user/pytest-262/test_pipeline_generates_markdo0')

    def test_pipeline_generates_markdown_report(tmp_path):
        """
        TDD: Integration test for pipeline orchestration.
        Runs the pipeline for a ticker and asserts that a Markdown report is generated.
        """
        import sys
        import shutil
        os.chdir(tmp_path)
        reports_dir = tmp_path / "reports"
        if reports_dir.exists():
            shutil.rmtree(reports_dir)
        # Run pipeline for a known ticker (now expects a list)
        ticker = "TCS.NS"
        sys.path.insert(0, str(Path(__file__).parent.parent))
        from pipeline import run_pipeline
>       run_pipeline([ticker], output_dir=tmp_path)

D:\Code\projects\tapp\code\2025\simpler_st\tests\test_pipeline.py:20: 
_ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _
D:\Code\projects\tapp\code\2025\simpler_st\pipeline.py:144: in run_pipeline
    generate_markdown_report(stats, pf)
_ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _

stats = {'_trades':                  entry_index                exit_index  ...        qty          PnL
0  2015-05-28 00:00:00...-04-28 00:00:00+05:30     ranging
2025-04-29 00:00:00+05:30     ranging
Name: regime, Length: 2469, dtype: object, ...}
bt = <tech_analysis.portfolio.PortfolioState object at 0x000001BD3A701A50>
parameter_sensitivity_results = None

    def generate_markdown_report(stats, bt, parameter_sensitivity_results=None):
        """
        Generates a portfolio report in Markdown format, including all key sections.
        Output file: reports/portfolio_report.md
        """
        os.makedirs("plots", exist_ok=True)
        os.makedirs("reports", exist_ok=True)
        # --- Pre-initialize chart path variables to None to avoid UnboundLocalError ---
        abs_legacy_equity_chart_path = None
        abs_chart_path = None
        abs_drawdown_chart_path = None
        abs_return_dist_chart_path = None
        md_lines = []
        # Cover Page
        md_lines.append("# Technical Analysis Report\n")
        md_lines.append("## Portfolio-Level Report\n")
        md_lines.append("---\n")
        # Table of Contents
        md_lines.append("## Table of Contents\n")
        md_lines.append("1. [Cover Page](#technical-analysis-report)")
        md_lines.append("2. [Table of Contents](#table-of-contents)")
        md_lines.append("3. [Assumptions: Slippage and Commission](#assumptions-slippage-and-commission)")
        md_lines.append("4. [Performance Metrics](#performance-metrics)")
        md_lines.append("5. [Benchmark Comparison](#benchmark-comparison)")
        md_lines.append("6. [Trade Log](#trade-log)")
        md_lines.append("7. [Regime Summary](#regime-summary)")
        md_lines.append("8. [Strategy Parameters](#strategy-parameters)")
        md_lines.append("9. [Risk and Position Sizing Logic](#risk-and-position-sizing-logic)")
        md_lines.append("10. [Analyst Notes and Suggestions](#analyst-notes-and-suggestions)")
        md_lines.append("11. [Rationale Summary](#rationale-summary)")
        md_lines.append("12. [Trade Statistics Breakdown](#trade-statistics-breakdown)")
        md_lines.append("13. [Regime Breakdown](#regime-breakdown)\n")
        # --- Out-of-Sample/Walk-Forward Validation Section ---
        out_of_sample = stats.get('out_of_sample')
        if out_of_sample:
            md_lines.append("## Out-of-Sample Walk-Forward Results\n")
            period = out_of_sample.get('period', '')
            ret = out_of_sample.get('return', None)
            sharpe = out_of_sample.get('sharpe', None)
            max_dd = out_of_sample.get('max_drawdown', None)
            note = out_of_sample.get('note', '')
            line = f"> The strategy was tested on {period} data not used in optimization. "
            if ret is not None:
                line += f"Out-of-sample return: {ret:.1f}%, "
            if sharpe is not None:
                line += f"Sharpe: {sharpe:.2f}, "
            if max_dd is not None:
                line += f"Max Drawdown: {max_dd:.1f}%. "
            if note:
                line += note
            md_lines.append(line + "\n")
        # --- Equity Curve Chart (legacy, always present) ---
        legacy_equity_chart_path = f"plots/portfolio_equity.png"
        equity_curve = stats.get('equity_curve')
        # If dict (multi-ticker), pick first ticker for legacy chart
        if isinstance(equity_curve, dict):
            first_ticker = next(iter(equity_curve)) if equity_curve else None
            equity_curve_legacy = equity_curve.get(first_ticker) if first_ticker else None
        else:
            equity_curve_legacy = equity_curve
        if equity_curve_legacy is not None:
            plt.figure(facecolor='white')
            plt.rcParams.update({
                'font.size': 12,
                'axes.labelsize': 12,
                'axes.titlesize': 14,
                'legend.fontsize': 12,
                'axes.edgecolor': 'gray',
                'axes.linewidth': 1,
                'axes.grid': True,
                'grid.color': '#e0e0e0',
                'axes.prop_cycle': plt.cycler(color=["#1f77b4"])
            })
            plt.plot(equity_curve_legacy, label='Equity Curve', color='#1f77b4')
            plt.legend(loc='best', frameon=True)
            plt.tight_layout()
            abs_legacy_equity_chart_path = os.path.abspath(legacy_equity_chart_path)
            os.makedirs(os.path.dirname(abs_legacy_equity_chart_path), exist_ok=True)
            plt.savefig(abs_legacy_equity_chart_path)
            plt.close()
    
        # --- Benchmark Comparison Plot (new, if both present) ---
        benchmark_curve = stats.get('benchmark_curve') or stats.get('benchmark_equity_curve')
        chart_path = f"plots/benchmark_comparison.png"
        benchmark_name = stats.get('benchmark_name', 'Benchmark')
        # Handle dicts for benchmark too
        if isinstance(benchmark_curve, dict):
            benchmark_curve_legacy = benchmark_curve.get(first_ticker) if first_ticker else None
        else:
            benchmark_curve_legacy = benchmark_curve
        if equity_curve_legacy is not None and benchmark_curve_legacy is not None:
            plt.figure(facecolor='white')
            plt.rcParams.update({
                'font.size': 12,
                'axes.labelsize': 12,
                'axes.titlesize': 14,
                'legend.fontsize': 12,
                'axes.edgecolor': 'gray',
                'axes.linewidth': 1,
                'axes.grid': True,
                'grid.color': '#e0e0e0',
                'axes.prop_cycle': plt.cycler(color=["#1f77b4", "#ff7f0e"])
            })
            plt.plot(equity_curve_legacy, label='Portfolio', color='#1f77b4')
            plt.plot(benchmark_curve_legacy, label=benchmark_name, color='#ff7f0e', linestyle='--')
            plt.legend(loc='best', frameon=True)
            plt.title(f"Portfolio vs {benchmark_name}")
            plt.tight_layout()
            abs_chart_path = os.path.abspath(chart_path)
            os.makedirs(os.path.dirname(abs_chart_path), exist_ok=True)
            plt.savefig(abs_chart_path)
            plt.close()
    
        # --- Drawdown Curve Visualization ---
        drawdown_curve = stats.get('drawdown_curve')
        drawdown_chart_path = f"plots/drawdown_curve.png"
        if drawdown_curve is not None:
            plt.figure(facecolor='white')
            plt.plot(drawdown_curve, label='Drawdown', color='red')
            plt.title('Drawdown Curve')
            plt.xlabel('Time')
            plt.ylabel('Drawdown')
            plt.legend()
            plt.tight_layout()
            abs_drawdown_chart_path = os.path.abspath(drawdown_chart_path)
            os.makedirs(os.path.dirname(abs_drawdown_chart_path), exist_ok=True)
            plt.savefig(abs_drawdown_chart_path)
            plt.close()
    
        # --- Return Distribution Visualization ---
        returns_dist = stats.get('returns_distribution')
        return_dist_chart_path = f"plots/return_distribution.png"
        if returns_dist is not None:
            plt.figure(facecolor='white')
            mean = np.mean(returns_dist)
            std = np.std(returns_dist)
            outliers = (np.abs(returns_dist - mean) > 2 * std)
            plt.hist(returns_dist[~outliers], bins=20, color='#1f77b4', alpha=0.7, label='Normal')
            if np.any(outliers):
                plt.hist(returns_dist[outliers], bins=5, color='red', alpha=0.8, label='Outlier')
            plt.title('Return Distribution')
            plt.xlabel('Return')
            plt.ylabel('Frequency')
            plt.legend()
            plt.tight_layout()
            abs_return_dist_chart_path = os.path.abspath(return_dist_chart_path)
            os.makedirs(os.path.dirname(abs_return_dist_chart_path), exist_ok=True)
            plt.savefig(abs_return_dist_chart_path)
            plt.close()
    
        # --- Drawdown Table Section ---
        equity_curve = stats.get('equity_curve')
        # Defensive: handle dict (multi-ticker) vs. list/array (single-ticker)
        equity_curve_for_drawdown = equity_curve
        if isinstance(equity_curve, dict):
            first_ticker = next(iter(equity_curve)) if equity_curve else None
            equity_curve_for_drawdown = equity_curve.get(first_ticker) if first_ticker else None
        if equity_curve_for_drawdown is not None:
            from tech_analysis.backtest import extract_drawdown_periods
            periods = extract_drawdown_periods(equity_curve_for_drawdown)
            if periods:
                df = pd.DataFrame(periods)
                df2 = df.copy()
                df2['depth'] = (df2['depth'] * 100).round(2)
                df2 = df2.rename(columns={'start': 'Start', 'trough': 'Trough', 'end': 'End', 'depth': 'Depth (%)', 'recovery': 'Recovery (bars)'})
                plots_dir = os.path.join(os.getcwd(), 'plots')
                os.makedirs(plots_dir, exist_ok=True)
                table_path = os.path.join(plots_dir, 'drawdown_table.png')
                fig, ax = plt.subplots(figsize=(min(10, 2+len(df2)*0.5), 1+0.5*len(df2)))
                ax.axis('off')
                tbl = ax.table(cellText=df2.values, colLabels=df2.columns, loc='center', cellLoc='center')
                tbl.auto_set_font_size(False)
                tbl.set_fontsize(10)
                tbl.scale(1, 1.5)
                plt.tight_layout()
                plt.savefig(table_path, bbox_inches='tight', dpi=150)
                plt.close(fig)
                md_lines.append('## Drawdown Table\n')
                md_lines.append('![](plots/drawdown_table.png)\n')
    
        # --- Holding Duration Histogram ---
        holding_duration_chart_path = f"plots/holding_duration.png"
        trade_log = stats.get('trades') or stats.get('_trades')
        holding_durations = []
        if isinstance(trade_log, pd.DataFrame) and not trade_log.empty:
            for idx, trade in trade_log.iterrows():
                entry = trade.get('entry_time')
                exit = trade.get('exit_time')
                if entry and exit:
                    try:
                        entry_dt = pd.to_datetime(entry)
                        exit_dt = pd.to_datetime(exit)
                        duration = (exit_dt - entry_dt).days
                        if duration >= 0:
                            holding_durations.append(duration)
                    except Exception:
                        continue
        elif isinstance(trade_log, list):
            for trade in trade_log:
                entry = trade.get('entry_time')
                exit = trade.get('exit_time')
                if entry and exit:
                    try:
                        entry_dt = pd.to_datetime(entry)
                        exit_dt = pd.to_datetime(exit)
                        duration = (exit_dt - entry_dt).days
                        if duration >= 0:
                            holding_durations.append(duration)
                    except Exception:
                        continue
        if holding_durations:
            plt.figure(facecolor='white')
            plt.hist(holding_durations, bins=range(1, max(holding_durations)+2), color='#1f77b4', alpha=0.7, rwidth=0.85)
            plt.title('Trade Holding Duration Distribution')
            plt.xlabel('Holding Duration (days)')
            plt.ylabel('Number of Trades')
            plt.tight_layout()
            abs_holding_duration_chart_path = os.path.abspath(holding_duration_chart_path)
            os.makedirs(os.path.dirname(abs_holding_duration_chart_path), exist_ok=True)
            plt.savefig(abs_holding_duration_chart_path)
            plt.close()
            md_lines.append("\n## Trade Holding Duration Distribution\n")
            md_lines.append(f"![Trade Holding Duration]({holding_duration_chart_path})\n")
    
        # --- Markdown Content ---
        # Section: Assumptions
        md_lines.append("## Assumptions: Slippage and Commission\n")
        commission = getattr(bt, '_commission', stats.get('strategy_params', {}).get('commission', 0.002))
        slippage = getattr(bt, '_slippage', stats.get('strategy_params', {}).get('slippage', 0.0))
        md_lines.append(f"- **Slippage:** A slippage of {slippage} per trade is applied to all executions (entry and exit prices adjusted by ±slippage). (slippage={slippage})\n")
        md_lines.append(f"- **Commission:** A fixed commission rate of {commission * 100:.2f}% per trade is applied, as set in the backtesting engine (commission={commission}).\n")
        md_lines.append("\nThese assumptions may affect real-world applicability and should be reviewed for live trading scenarios.\n")
        # Section: Performance Metrics
        md_lines.append("## Performance Metrics\n")
        strat_metrics = stats.get('strategy', {})
        bench_metrics = stats.get('benchmark', {})
        metrics = [
            f"- **Strategy Return:** {100 * strat_metrics.get('total_return', 0.0):.2f}%",
            f"- **Strategy Sharpe Ratio:** {strat_metrics.get('sharpe_ratio', 0.0):.2f}",
            f"- **Strategy Max Drawdown:** {100 * strat_metrics.get('max_drawdown', 0.0):.2f}%",
            f"- **Strategy Win Rate:** {100 * strat_metrics.get('win_rate', 0.0):.2f}%"
        ]
        if bench_metrics:
            metrics.extend([
                f"- **Benchmark Return:** {100 * bench_metrics.get('total_return', 0.0):.2f}%",
                f"- **Benchmark Sharpe Ratio:** {bench_metrics.get('sharpe_ratio', 0.0):.2f}",
                f"- **Benchmark Max Drawdown:** {100 * bench_metrics.get('max_drawdown', 0.0):.2f}%",
                f"- **Benchmark Win Rate:** {100 * bench_metrics.get('win_rate', 0.0):.2f}%"
            ])
        md_lines.extend(metrics)
        # Embed equity curve chart (legacy)
        if abs_legacy_equity_chart_path is not None and os.path.exists(abs_legacy_equity_chart_path):
            md_lines.append(f"\n![Equity Curve]({legacy_equity_chart_path})\n")
        # Benchmark Comparison Section (new)
        if abs_chart_path is not None and os.path.exists(abs_chart_path):
            md_lines.append(f"\n## Benchmark Comparison\n")
            md_lines.append(f"![]({chart_path})\n")
            # Minimal table comparing returns if both present
            strat_return = stats.get('Return [%]', None)
            bench_curve = stats.get('benchmark_curve') or stats.get('benchmark_equity_curve')
            if strat_return is not None and bench_curve is not None:
                # Calculate benchmark return as percent change from first to last
                bench_return = 100 * (bench_curve[-1] - bench_curve[0]) / bench_curve[0]
                md_lines.append("\n| Metric | Portfolio | " + benchmark_name + " |\n|---|---|---|")
                md_lines.append(f"| Total Return (%) | {strat_return:.2f} | {bench_return:.2f} |\n")
        # Drawdown Curve Section
        if abs_drawdown_chart_path is not None and os.path.exists(abs_drawdown_chart_path):
            md_lines.append(f"\n## Drawdown Curve\n")
            md_lines.append(f"![Drawdown Curve]({drawdown_chart_path})\n")
        # Return Distribution Section
        if abs_return_dist_chart_path is not None and os.path.exists(abs_return_dist_chart_path):
            md_lines.append(f"\n## Return Distribution\n")
            md_lines.append(f"![Return Distribution]({return_dist_chart_path})\n")
            if returns_dist is not None:
                mean = np.mean(returns_dist)
                std = np.std(returns_dist)
                outliers = (np.abs(returns_dist - mean) > 2 * std)
                if np.any(outliers):
                    md_lines.append("Note: Outlier(s) highlighted in red.\n")
        # Section: Trade Log
        md_lines.append("## Trade Log\n")
        trade_log = stats.get('trades') or stats.get('_trades')
        # Debug: Print trade log columns/keys for first entry
        if isinstance(trade_log, pd.DataFrame) and not trade_log.empty:
            print("DEBUG: Trade log columns:", list(trade_log.columns))
        elif isinstance(trade_log, list) and len(trade_log) > 0:
            print("DEBUG: Trade log keys (first entry):", list(trade_log[0].keys()))
        elif trade_log is not None:
            print("DEBUG: Trade log type:", type(trade_log))
        if isinstance(trade_log, pd.DataFrame):
            trade_log = trade_log.to_dict(orient='records')
        if isinstance(trade_log, list) and len(trade_log) > 0:
            # Helper for formatting numbers
            def fmt(val):
                if isinstance(val, float) or isinstance(val, int):
                    return f"{val:.2f}"
                return str(val)
            for trade in trade_log:
                def get_any(trade, *keys):
                    for k in keys:
                        v = trade.get(k)
                        if v not in (None, ""):
                            return v
                    return ''
                ticker = get_any(trade, 'ticker')
                entry_index = get_any(trade, 'entry_index', 'EntryIndex')
                exit_index = get_any(trade, 'exit_index', 'ExitIndex')
                entry_price = get_any(trade, 'entry_price', 'EntryPrice')
                exit_price = get_any(trade, 'exit_price', 'ExitPrice')
                pnl = get_any(trade, 'pnl', 'PnL')
                commission_cost = get_any(trade, 'commission_cost', 'CommissionCost')
                regime = get_any(trade, 'regime', 'Regime')
                exit_regime = get_any(trade, 'exit_regime', 'ExitRegime')
                volatility = get_any(trade, 'volatility', 'Volatility')
                exit_volatility = get_any(trade, 'exit_volatility', 'ExitVolatility')
                volume = get_any(trade, 'volume', 'Volume')
                exit_volume = get_any(trade, 'exit_volume', 'ExitVolume')
                atr_entry = get_any(trade, 'atr_entry', 'EntryATR')
                atr_exit = get_any(trade, 'atr_exit', 'ExitATR')
                entry_sma_short = get_any(trade, 'entry_sma_short', 'EntrySMA_Short', 'EntrySMA')
                exit_sma_short = get_any(trade, 'exit_sma_short', 'ExitSMA_Short', 'ExitSMA')
                entry_sma_long = get_any(trade, 'entry_sma_long', 'EntrySMA_Long')
                exit_sma_long = get_any(trade, 'exit_sma_long', 'ExitSMA_Long')
                entry_rsi = get_any(trade, 'entry_rsi', 'EntryRSI')
                exit_rsi = get_any(trade, 'exit_rsi', 'ExitRSI')
                rationale = get_any(trade, 'rationale', 'Rationale')
                context = trade.get('context', '')
                indicators = trade.get('indicators', '')
                # --- Output both bolded and plain versions for all critical trade log fields ---
                md_lines.append(f"**Ticker:** {ticker}")
                md_lines.append(f"Ticker: {ticker}")
                md_lines.append(f"**Entry:** {fmt(get_any(trade, 'entry_time', 'EntryTime', 'entry_index', 'EntryIndex'))}")
                md_lines.append(f"Entry: {fmt(get_any(trade, 'entry_time', 'EntryTime', 'entry_index', 'EntryIndex'))}")
                md_lines.append(f"**Entry Price:** {fmt(get_any(trade, 'entry_price', 'EntryPrice'))}")
                md_lines.append(f"Entry Price: {fmt(get_any(trade, 'entry_price', 'EntryPrice'))}")
                md_lines.append(f"**Exit:** {fmt(get_any(trade, 'exit_time', 'ExitTime', 'exit_index', 'ExitIndex'))}")
                md_lines.append(f"Exit: {fmt(get_any(trade, 'exit_time', 'ExitTime', 'exit_index', 'ExitIndex'))}")
                md_lines.append(f"**Exit Price:** {fmt(get_any(trade, 'exit_price', 'ExitPrice'))}")
                md_lines.append(f"Exit Price: {fmt(get_any(trade, 'exit_price', 'ExitPrice'))}")
                md_lines.append(f"**PnL:** {fmt(get_any(trade, 'pnl', 'PnL'))}")
                md_lines.append(f"PnL: {fmt(get_any(trade, 'pnl', 'PnL'))}")
                md_lines.append(f"**Commission Cost:** {fmt(get_any(trade, 'commission_cost', 'CommissionCost'))}")
                md_lines.append(f"Commission Cost: {fmt(get_any(trade, 'commission_cost', 'CommissionCost'))}")
                md_lines.append(f"**Position Size:** {fmt(get_any(trade, 'position_size', 'PositionSize'))}")
                md_lines.append(f"Position Size: {fmt(get_any(trade, 'position_size', 'PositionSize'))}")
                md_lines.append(f"**Entry Regime:** {get_any(trade, 'entry_regime', 'EntryRegime')}")
                md_lines.append(f"Entry Regime: {get_any(trade, 'entry_regime', 'EntryRegime')}")
                md_lines.append(f"**Exit Regime:** {get_any(trade, 'exit_regime', 'ExitRegime')}")
                md_lines.append(f"Exit Regime: {get_any(trade, 'exit_regime', 'ExitRegime')}")
                md_lines.append(f"**Entry Volatility:** {fmt(get_any(trade, 'entry_volatility', 'EntryVolatility'))}")
                md_lines.append(f"Entry Volatility: {fmt(get_any(trade, 'entry_volatility', 'EntryVolatility'))}")
                md_lines.append(f"**Exit Volatility:** {fmt(get_any(trade, 'exit_volatility', 'ExitVolatility'))}")
                md_lines.append(f"Exit Volatility: {fmt(get_any(trade, 'exit_volatility', 'ExitVolatility'))}")
                md_lines.append(f"**Entry Volume:** {fmt(get_any(trade, 'entry_volume', 'EntryVolume'))}")
                md_lines.append(f"Entry Volume: {fmt(get_any(trade, 'entry_volume', 'EntryVolume'))}")
                md_lines.append(f"**Exit Volume:** {fmt(get_any(trade, 'exit_volume', 'ExitVolume'))}")
                md_lines.append(f"Exit Volume: {fmt(get_any(trade, 'exit_volume', 'ExitVolume'))}")
                md_lines.append(f"**Entry SMA:** {fmt(get_any(trade, 'entry_sma_short', 'EntrySMA_Short', 'EntrySMA'))}")
                md_lines.append(f"Entry SMA: {fmt(get_any(trade, 'entry_sma_short', 'EntrySMA_Short', 'EntrySMA'))}")
                md_lines.append(f"**Exit SMA:** {fmt(get_any(trade, 'exit_sma_short', 'ExitSMA_Short', 'ExitSMA'))}")
                md_lines.append(f"Exit SMA: {fmt(get_any(trade, 'exit_sma_short', 'ExitSMA_Short', 'ExitSMA'))}")
                md_lines.append(f"**Entry RSI:** {fmt(get_any(trade, 'entry_rsi', 'EntryRSI'))}")
                md_lines.append(f"Entry RSI: {fmt(get_any(trade, 'entry_rsi', 'EntryRSI'))}")
                md_lines.append(f"**Exit RSI:** {fmt(get_any(trade, 'exit_rsi', 'ExitRSI'))}")
                md_lines.append(f"Exit RSI: {fmt(get_any(trade, 'exit_rsi', 'ExitRSI'))}")
                md_lines.append(f"**Rationale:** {get_any(trade, 'rationale', 'Rationale')}")
                md_lines.append(f"Rationale: {get_any(trade, 'rationale', 'Rationale')}")
                md_lines.append(f"**Context:** {trade.get('context', '')}")
                md_lines.append(f"Context: {trade.get('context', '')}")
                md_lines.append(f"**Indicators:** {trade.get('indicators', '')}\n")
                md_lines.append(f"Indicators: {trade.get('indicators', '')}\n")
        else:
            md_lines.append("No trade log available.\n")
        # Section: Regime Summary
        md_lines.append("## Regime Summary\n")
        params = stats.get('strategy_params', {})
        short_sma = params.get('short_window', 20)
        long_sma = params.get('long_window', 50)
        min_days = params.get('min_regime_days', 4)
        rsi_period = params.get('rsi_period', 14)
        overbought = params.get('overbought', 70)
        oversold = params.get('oversold', 30)
        md_lines.append("**Regime Definitions and Classification Criteria:**\n")
        md_lines.append(f"- **Trending:** A period where price exhibits a clear upward or downward movement, typically identified by the short-term SMA (window: {short_sma}) being consistently above (uptrend) or below (downtrend) the long-term SMA (window: {long_sma}) for more than {min_days - 1} days.\n")
        md_lines.append(f"- **Ranging:** A period where price oscillates within a horizontal channel, identified when the short-term SMA crosses above and below the long-term SMA frequently, with no sustained trend for more than {min_days - 1} days.\n")
        md_lines.append("- **Quantitative Parameters:**\n" +
            f"**Short SMA window:** {short_sma} days\n" +
            f"**Long SMA window:** {long_sma} days\n" +
            f"**Minimum regime duration:** {min_days} days (regimes shorter than this are filtered out)\n" +
            f"**RSI period:** {rsi_period}\n" +
            f"**RSI thresholds:** Overbought ({overbought}), Oversold ({oversold})\n"
        )
        regime_summary = stats.get('regime_summary')
        if regime_summary:
            md_lines.append(f"{regime_summary}\n")
        # Render filtered regime series table
        regime_series = stats.get('regime_series')
        if regime_series is not None and len(regime_series) > 0:
            # Pass min_days to the filter function
            def filter_regime_series(series, min_duration):
                filtered = []
                prev_regime = None
                start_date = None
                count = 0
                threshold = min_duration - 1 # Check against min_duration - 1
                for date, regime in series.items():
                    if regime != prev_regime:
                        # Use the threshold derived from min_duration
                        if prev_regime is not None and count > threshold:
                            filtered.append((start_date, date, prev_regime, count))
                        start_date = date
                        count = 1
                        prev_regime = regime
                    else:
                        count += 1
                # Handle last segment, using the threshold
                if prev_regime is not None and count > threshold:
                    filtered.append((start_date, date, prev_regime, count))
                return filtered
            # Call the function with the min_days parameter
            filtered_regimes = filter_regime_series(regime_series, min_days)
            if filtered_regimes:
                md_lines.append("\n| Start Date | End Date | Regime | Days |\n|---|---|---|---|")
                for start, end, regime, days in filtered_regimes:
                    md_lines.append(f"| {start} | {end} | {regime} | {days} |")
            else:
                # Update the message to use min_days
                md_lines.append(f"\n_No regime persisted more than {min_days - 1} days in a row._\n")
        # Trade-level chart with entry/exit markers and indicator overlays
        trade_chart_path = f"plots/trade_chart.png"
        price = stats.get('equity_curve')
        sma = stats.get('sma_curve')
        rsi = stats.get('rsi_curve')
        trades = stats.get('_trades')
        if trades is None or not hasattr(trades, 'iterrows'):
            trades = stats.get('trades')
        # Only plot summary chart if price and sma are 1D (not dict)
        if price is not None and sma is not None and trades is not None and not isinstance(price, dict) and not isinstance(sma, dict):
            plt.figure(facecolor='white')
            plt.plot(price, label='Price', color='#1f77b4')
            plt.plot(sma, label='SMA', color='orange')
            if rsi is not None and not isinstance(rsi, dict):
                ax1 = plt.gca()
                ax2 = ax1.twinx()
                ax2.plot(rsi, label='RSI', color='purple', alpha=0.4)
                ax2.set_ylabel('RSI', color='purple')
            # Plot trade entry/exit markers
            if hasattr(trades, 'iterrows'):
                for idx, trade in trades.iterrows():
                    entry = trade.get('entry_time')
                    entry_price = trade.get('entry_price')
                    exit = trade.get('exit_time')
                    exit_price = trade.get('exit_price')
                    if entry is not None and entry_price is not None:
                        plt.scatter(entry, entry_price, marker='^', color='green', label='Entry' if idx == 0 else "")
                    if exit is not None and exit_price is not None:
                        plt.scatter(exit, exit_price, marker='v', color='red', label='Exit' if idx == 0 else "")
            elif isinstance(trades, list):
                for i, trade in enumerate(trades):
                    entry = trade.get('entry_time')
                    entry_price = trade.get('entry_price')
                    exit = trade.get('exit_time')
                    exit_price = trade.get('exit_price')
                    if entry is not None and entry_price is not None:
                        plt.scatter(entry, entry_price, marker='^', color='green', label='Entry' if i == 0 else "")
                    if exit is not None and exit_price is not None:
                        plt.scatter(exit, exit_price, marker='v', color='red', label='Exit' if i == 0 else "")
            plt.legend(loc='best', frameon=True)
            plt.title('Trade Chart with Entry/Exit, SMA, Regime')
            plt.tight_layout()
            abs_trade_chart_path = os.path.abspath(trade_chart_path)
            os.makedirs(os.path.dirname(abs_trade_chart_path), exist_ok=True)
            plt.savefig(abs_trade_chart_path)
            plt.close()
            if os.path.exists(abs_trade_chart_path):
                md_lines.append(f"\n![Trade Chart]({trade_chart_path})\n")
        # If price is a dict (multi-ticker), skip this summary chart (per-ticker charts are generated below)
        # Trade Outcome Heatmap Visualization
        heatmap_chart_path = f"plots/trade_heatmap.png"
        trades_df = None
        if isinstance(trade_log, pd.DataFrame):
            trades_df = trade_log
        elif isinstance(trade_log, list) and len(trade_log) > 0:
            trades_df = pd.DataFrame(trade_log)
        if trades_df is not None and all(col in trades_df.columns for col in ['ticker', 'regime', 'pnl']):
            pivot = trades_df.pivot_table(index='ticker', columns='regime', values='pnl', aggfunc='mean', fill_value=0)
            plt.figure(figsize=(6,4), facecolor='white')
            sns.heatmap(pivot, annot=True, fmt=".2f", cmap="RdYlGn", cbar=True)
            plt.title('Trade Outcome Heatmap (Mean PnL by Ticker & Regime)')
            plt.tight_layout()
            abs_heatmap_chart_path = os.path.abspath(heatmap_chart_path)
            os.makedirs(os.path.dirname(abs_heatmap_chart_path), exist_ok=True)
            plt.savefig(abs_heatmap_chart_path)
            plt.close()
            md_lines.append(f"\n## Trade Outcome Heatmap\n")
            md_lines.append(f"![Trade Outcome Heatmap]({heatmap_chart_path})\n")
        # Section: Strategy Parameters
        md_lines.append("## Strategy Parameters\n")
        params = stats.get('strategy_params', {})
        if params:
            for k, v in params.items():
                md_lines.append(f"- **{k}:** {v}")
        else:
            md_lines.append("No strategy parameters available.\n")
        # Section: Risk and Position Sizing Logic
        if 'position_size' not in params or 'initial_cash' not in params:
            raise KeyError("Both 'position_size' and 'initial_cash' must be present in strategy parameters (from config.json).")
        position_size = params['position_size']
        initial_cash = params['initial_cash']
        percent_risked = (position_size / initial_cash) * 100 if initial_cash else 0
        max_positions = params.get('max_simultaneous_positions', None)
        md_lines.append("\n## Risk and Position Sizing Logic\n")
        md_lines.append(f"- **% Risked Per Trade:** {percent_risked:.2f}% of initial capital allocated to each trade (position_size={position_size}, initial_cash={initial_cash}).")
        md_lines.append("- **Allocation Rule:** Fixed allocation per trade; no leverage or short selling. Trades only executed if sufficient cash is available.")
        if max_positions is not None:
            md_lines.append(f"- **Max Simultaneous Positions:** {max_positions} (as set in configuration).")
        else:
            md_lines.append("- **Max Simultaneous Positions:** No explicit maximum; limited by available cash.")
        md_lines.append("\nEach trade allocates capital using a fixed position size. The number of shares bought is calculated as:\n")
        md_lines.append("\n    qty = int(position_size // price)\n")
        md_lines.append("\nThis ensures that:\n- No trade exceeds the specified position size or available cash.\n- No leverage or short selling is used.\n- Trades are only executed if sufficient cash is available.\n\nThis simple approach provides basic risk control by capping exposure per trade and preventing over-allocation. More advanced risk management (e.g., stop-loss, volatility targeting) is not implemented in this version.\n")
        # Section: Analyst Notes and Suggestions (substantive note)
        md_lines.append("## Analyst Notes and Suggestions\n")
        analyst_note = stats.get('analyst_notes', None)
        if analyst_note:
            md_lines.append(f"{analyst_note}\n")
        else:
            md_lines.append("The strategy underperformed in ranging markets; consider parameter tuning or regime filtering.\n")
        # Section: Rationale Summary
        md_lines.append("## Rationale Summary\n")
        trades = trade_log
        if isinstance(trades, pd.DataFrame):
            has_trades = not trades.empty
        else:
            has_trades = bool(trades)
        rationales = []
        if has_trades:
            if isinstance(trades, pd.DataFrame):
                for idx, trade in trades.iterrows():
                    if hasattr(trade, 'get'):
                        rationale = trade.get('rationale')
                        if rationale:
                            rationales.append(rationale)
                    elif isinstance(trade, str):
                        rationales.append(trade)
            elif isinstance(trades, list):
                for trade in trades:
                    if hasattr(trade, 'get'):
                        rationale = trade.get('rationale')
                        if rationale:
                            rationales.append(rationale)
                    elif isinstance(trade, str):
                        rationales.append(trade)
        if rationales:
            md_lines.append("\n".join([f"- {r}" for r in rationales]))
        else:
            md_lines.append("No rationale provided.\n")
        # Parameter Sensitivity Analysis
        param_sens_path = "plots/parameter_sensitivity.png"
        # Section header always present if results or plot exist
        if (parameter_sensitivity_results and len(parameter_sensitivity_results) > 0) or os.path.exists(param_sens_path):
            md_lines.append("\n## Parameter Sensitivity Analysis\n")
            if parameter_sensitivity_results and len(parameter_sensitivity_results) > 0:
                # Generate Markdown table
                keys = list(parameter_sensitivity_results[0].keys())
                md_lines.append("| " + " | ".join(keys) + " |")
                md_lines.append("|" + "---|" * len(keys))
                for row in parameter_sensitivity_results:
                    md_lines.append("| " + " | ".join(str(row[k]) for k in keys) + " |")
                md_lines.append("")
            if os.path.exists(param_sens_path):
                md_lines.append("The plot below compares equity curves for different parameter values, illustrating the impact of parameter changes on strategy performance.\n")
                md_lines.append(f"![Parameter Sensitivity]({param_sens_path})\n")
        # Strategy Logic Summary Section
        strategy_rule_summary = stats.get('strategy_rule_summary')
        if strategy_rule_summary:
            md_lines.append('## Strategy Logic Summary\n')
            md_lines.append(strategy_rule_summary + '\n')
        # Trade Duration and Exposure Statistics Section
        trade_duration_stats = stats.get('trade_duration_stats')
        if trade_duration_stats:
            md_lines.append('## Trade Duration and Exposure Statistics\n')
            md_lines.append(f"Average Duration: {trade_duration_stats['avg_duration']} days\n")
            md_lines.append(f"Median Duration: {trade_duration_stats['median_duration']} days\n")
            md_lines.append(f"Max Duration: {trade_duration_stats['max_duration']} days\n")
            md_lines.append(f"Average Portfolio Exposure: {trade_duration_stats['avg_exposure']*100:.1f}%\n")
        # Slippage/Commission Sensitivity Analysis Section
        slippage_commission_sensitivity = stats.get('slippage_commission_sensitivity')
        if slippage_commission_sensitivity:
            md_lines.append('## Slippage/Commission Sensitivity Analysis\n')
            md_lines.append('| Slippage | Commission | Sharpe | Return | Drawdown |\n')
            md_lines.append('|---|---|---|---|---|\n')
            for row in slippage_commission_sensitivity:
                md_lines.append(f"| {row['slippage']} | {row['commission']} | {row['sharpe']} | {row['return']} | {row['drawdown']} |\n")
        # Per-Period Benchmark Comparison Section
        per_period_benchmark = stats.get('per_period_benchmark')
        if per_period_benchmark:
            md_lines.append('## Per-Period Benchmark Comparison\n')
            md_lines.append('| Period | Strategy Return | Benchmark Return |\n')
            md_lines.append('|---|---|---|\n')
            for row in per_period_benchmark:
                md_lines.append(f"| {row['period']} | {row['strategy_return']} | {row['benchmark_return']} |\n")
        # Trade Statistics Breakdown
        md_lines.append("## Trade Statistics Breakdown\n")
        metrics = stats.get('strategy', {})
        if isinstance(trade_log, pd.DataFrame):
            has_trades = not trade_log.empty
        else:
            has_trades = bool(trade_log)
        if has_trades and metrics:
            md_lines.append("| Metric | Value |")
            md_lines.append("|---|---|")
            md_lines.append(f"| Average Win | {metrics.get('average_win', 0.0):.2f} |")
            md_lines.append(f"| Average Loss | {metrics.get('average_loss', 0.0):.2f} |")
            md_lines.append(f"| Largest Win | {metrics.get('largest_win', 0.0):.2f} |")
            md_lines.append(f"| Largest Loss | {metrics.get('largest_loss', 0.0):.2f} |")
            md_lines.append(f"| Profit Factor | {metrics.get('profit_factor', 0.0):.2f} |")
            md_lines.append(f"| Expectancy | {metrics.get('expectancy', 0.0):.2f} |")
        else:
            md_lines.append("No trade statistics available.\n")
        # Regime Breakdown
        md_lines.append("\n### Regime Breakdown\n")
        from tech_analysis.backtest import correlate_performance_with_regimes
        if isinstance(trade_log, pd.DataFrame):
            has_trades = not trade_log.empty
        else:
            has_trades = bool(trade_log)
        if has_trades:
            # Ensure trade_log is a list of dicts, not a DataFrame, before passing to correlate_performance_with_regimes
            if hasattr(trade_log, 'to_dict'):
                trade_log_records = trade_log.to_dict('records')
            else:
                trade_log_records = trade_log
            regime_stats = correlate_performance_with_regimes(trade_log_records)
            if regime_stats:
                md_lines.append("| Regime | Trades | Win Rate | Avg Win | Avg Loss | Largest Win | Largest Loss | Profit Factor | Expectancy | Mean PnL |")
                md_lines.append("|---|---|---|---|---|---|---|---|---|---|")
                for regime, regime_stat in regime_stats.items():
                    md_lines.append(
                        f"| {regime} | {regime_stat['count']} | {regime_stat['win_rate']:.2f} | {regime_stat['average_win']:.2f} | {regime_stat['average_loss']:.2f} | {regime_stat['largest_win']:.2f} | {regime_stat['largest_loss']:.2f} | {regime_stat['profit_factor']:.2f} | {regime_stat['expectancy']:.2f} | {regime_stat['mean_pnl']:.2f} |"
                    )
                # --- Regime-wise Barplot and Boxplot ---
                # Convert to DataFrame for plotting
                trades_df = pd.DataFrame(trade_log_records)
                if 'regime' in trades_df.columns and 'pnl' in trades_df.columns:
                    plots_dir = os.path.join(os.getcwd(), 'plots')
                    os.makedirs(plots_dir, exist_ok=True)
                    # Barplot: Mean PnL per regime
                    barplot_path = os.path.join(plots_dir, 'regime_barplot.png')
                    plt.figure(figsize=(5,3), facecolor='white')
                    sns.barplot(data=trades_df, x='regime', y='pnl', estimator='mean', errorbar=None, hue='regime', palette='Set2', legend=False)
                    plt.title('Mean PnL by Regime')
                    plt.xlabel('Regime')
                    plt.ylabel('Mean PnL')
                    plt.tight_layout()
                    plt.savefig(barplot_path)
                    plt.close()
                    md_lines.append(f"\n![Mean PnL by Regime](plots/regime_barplot.png)\n")
                    # Boxplot: PnL distribution per regime
                    boxplot_path = os.path.join(plots_dir, 'regime_boxplot.png')
                    plt.figure(figsize=(5,3), facecolor='white')
                    sns.boxplot(data=trades_df, x='regime', y='pnl', hue='regime', palette='Set2', legend=False)
                    plt.title('PnL Distribution by Regime')
                    plt.xlabel('Regime')
                    plt.ylabel('PnL')
                    plt.tight_layout()
                    plt.savefig(boxplot_path)
                    plt.close()
                    md_lines.append(f"\n![PnL Distribution by Regime](plots/regime_boxplot.png)\n")
            else:
                md_lines.append("No regime breakdown available.\n")
        else:
            md_lines.append("No trades for regime breakdown.\n")
        # --- Regime Barplot (always generate if regime_series present) ---
        regime_barplot_path = f"plots/regime_barplot.png"
        regime_series = stats.get('regime_series')
        if regime_series is not None and len(regime_series) > 0:
>           regime_counts = pd.Series(list(regime_series.values())).value_counts()
E           TypeError: 'numpy.ndarray' object is not callable

D:\Code\projects\tapp\code\2025\simpler_st\report_generator.py:686: TypeError
---------------------------- Captured stdout call -----------------------------
[DEBUG] portfolio_backtest result: {'portfolio_state': <tech_analysis.portfolio.PortfolioState object at 0x000001BD3A701A50>, 'trade_log': [{'entry_index': Timestamp('2015-05-28 00:00:00+0530', tz='Asia/Kolkata'), 'exit_index': Timestamp('2015-07-24 00:00:00+0530', tz='Asia/Kolkata'), 'entry_price': 1116.2579345703125, 'exit_price': 1083.907470703125, 'pnl': -36.750794677734376, 'commission_cost': 4.400330810546875, 'regime': 'trending', 'entry_regime': 'trending', 'exit_regime': 'ranging', 'EntryRegime': 'trending', 'ExitRegime': 'ranging', 'volatility': 20.344639809204683, 'exit_volatility': 14.96908450344755, 'entry_volatility': 20.344639809204683, 'EntryVolatility': 20.344639809204683, 'ExitVolatility': 14.96908450344755, 'volume': 2763608.0, 'exit_volume': 1574972.0, 'entry_volume': 2763608.0, 'volume_entry': 2763608.0, 'volume_exit': 1574972.0, 'EntryVolume': 2763608.0, 'ExitVolume': 1574972.0, 'atr_entry': 21.90367707550908, 'atr_exit': 19.496815017312816, 'EntryATR': 21.90367707550908, 'ExitATR': 19.496815017312816, 'entry_sma_short': 1086.560125732422, 'exit_sma_short': 1103.3007751464843, 'entry_sma_long': 1085.4851016090029, 'exit_sma_long': 1104.4010961914062, 'EntrySMA_Short': 1086.560125732422, 'ExitSMA_Short': 1103.3007751464843, 'EntrySMA_Long': 1085.4851016090029, 'ExitSMA_Long': 1104.4010961914062, 'entry_rsi': 65.84502628853397, 'exit_rsi': 34.948929541277536, 'EntryRSI': 65.84502628853397, 'ExitRSI': 34.948929541277536, 'rationale': 'Sell: short SMA crossed below long SMA at index 2015-07-24 00:00:00+05:30', 'Rationale': 'Sell: short SMA crossed below long SMA at index 2015-07-24 00:00:00+05:30', 'ticker': 'TCS.NS', 'context': [1068.2847900390625, 1083.482421875, 1079.1436767578125, 1099.11181640625, 1096.7149658203125, 1107.1636962890625, 1115.9251708984375, 1108.2451171875, 1093.8155517578125, 1076.74658203125, 1083.907470703125], 'indicators': {'sma_short': 1086.560125732422, 'sma_long': 1085.4851016090029, 'rsi': 65.84502628853397, 'atr': 21.90367707550908, 'volatility': 20.344639809204683}, 'action': 'buy', 'qty': 2763608.0}, {'entry_index': Timestamp('2015-08-17 00:00:00+0530', tz='Asia/Kolkata'), 'exit_index': Timestamp('2015-09-18 00:00:00+0530', tz='Asia/Kolkata'), 'entry_price': 1161.614990234375, 'exit_price': 1103.853759765625, 'pnl': -62.29216796875, 'commission_cost': 4.5309375, 'regime': 'trending', 'entry_regime': 'trending', 'exit_regime': 'ranging', 'EntryRegime': 'trending', 'ExitRegime': 'ranging', 'volatility': 29.72120300591647, 'exit_volatility': 8.036496458440938, 'entry_volatility': 29.72120300591647, 'EntryVolatility': 29.72120300591647, 'ExitVolatility': 8.036496458440938, 'volume': 773644.0, 'exit_volume': 2455294.0, 'entry_volume': 773644.0, 'volume_entry': 773644.0, 'volume_exit': 2455294.0, 'EntryVolume': 773644.0, 'ExitVolume': 2455294.0, 'atr_entry': 20.505525954524714, 'atr_exit': 22.495340504134614, 'EntryATR': 20.505525954524714, 'ExitATR': 22.495340504134614, 'entry_sma_short': 1106.4062438964843, 'exit_sma_short': 1109.9801147460937, 'entry_sma_long': 1105.1430322265626, 'exit_sma_long': 1110.174765625, 'EntrySMA_Short': 1106.4062438964843, 'ExitSMA_Short': 1109.9801147460937, 'EntrySMA_Long': 1105.1430322265626, 'ExitSMA_Long': 1110.174765625, 'entry_rsi': 73.41095421919863, 'exit_rsi': 45.488129459490004, 'EntryRSI': 73.41095421919863, 'ExitRSI': 45.488129459490004, 'rationale': 'Sell: short SMA crossed below long SMA at index 2015-09-18 00:00:00+05:30', 'Rationale': 'Sell: short SMA crossed below long SMA at index 2015-09-18 00:00:00+05:30', 'ticker': 'TCS.NS', 'context': [1127.368896484375, 1102.209228515625, 1098.8778076171875, 1099.1158447265625, 1103.20458984375, 1101.3223876953125, 1104.1776123046875, 1104.026611328125, 1097.796142578125, 1103.4638671875, 1103.853759765625], 'indicators': {'sma_short': 1106.4062438964843, 'sma_long': 1105.1430322265626, 'rsi': 73.41095421919863, 'atr': 20.505525954524714, 'volatility': 29.72120300591647}, 'action': 'buy', 'qty': 773644.0}, {'entry_index': Timestamp('2015-10-13 00:00:00+0530', tz='Asia/Kolkata'), 'exit_index': Timestamp('2015-10-14 00:00:00+0530', tz='Asia/Kolkata'), 'entry_price': 1124.319091796875, 'exit_price': 1074.626708984375, 'pnl': -54.0902744140625, 'commission_cost': 4.3978916015625, 'regime': 'ranging', 'entry_regime': 'ranging', 'exit_regime': 'ranging', 'EntryRegime': 'ranging', 'ExitRegime': 'ranging', 'volatility': 19.142614334220383, 'exit_volatility': 26.900984774612777, 'entry_volatility': 19.142614334220383, 'EntryVolatility': 19.142614334220383, 'ExitVolatility': 26.900984774612777, 'volume': 6179712.0, 'exit_volume': 8337128.0, 'entry_volume': 6179712.0, 'volume_entry': 6179712.0, 'volume_exit': 8337128.0, 'EntryVolume': 6179712.0, 'ExitVolume': 8337128.0, 'atr_entry': 24.97378475822862, 'atr_exit': 25.6677852450535, 'EntryATR': 24.97378475822862, 'ExitATR': 25.6677852450535, 'entry_sma_short': 1122.0949645996093, 'exit_sma_short': 1120.6174194335938, 'entry_sma_long': 1122.078056640625, 'exit_sma_long': 1121.843984375, 'EntrySMA_Short': 1122.0949645996093, 'ExitSMA_Short': 1120.6174194335938, 'EntrySMA_Long': 1122.078056640625, 'ExitSMA_Long': 1121.843984375, 'entry_rsi': 56.876174699754706, 'exit_rsi': 45.057325780488654, 'EntryRSI': 56.876174699754706, 'ExitRSI': 45.057325780488654, 'rationale': 'Sell: short SMA crossed below long SMA at index 2015-10-14 00:00:00+05:30', 'Rationale': 'Sell: short SMA crossed below long SMA at index 2015-10-14 00:00:00+05:30', 'ticker': 'TCS.NS', 'context': [1119.8624267578125, 1119.775634765625, 1144.24365234375, 1173.2540283203125, 1168.21337890625, 1148.2889404296875, 1139.570556640625, 1137.7750244140625, 1121.744873046875, 1124.319091796875, 1074.626708984375], 'indicators': {'sma_short': 1122.0949645996093, 'sma_long': 1122.078056640625, 'rsi': 56.876174699754706, 'atr': 24.97378475822862, 'volatility': 19.142614334220383}, 'action': 'buy', 'qty': 6179712.0}, {'entry_index': Timestamp('2016-03-21 00:00:00+0530', tz='Asia/Kolkata'), 'exit_index': Timestamp('2016-07-14 00:00:00+0530', tz='Asia/Kolkata'), 'entry_price': 1063.2938232421875, 'exit_price': 1107.548095703125, 'pnl': 39.91258862304687, 'commission_cost': 4.341683837890625, 'regime': 'ranging', 'entry_regime': 'ranging', 'exit_regime': 'ranging', 'EntryRegime': 'ranging', 'ExitRegime': 'ranging', 'volatility': 16.118863379677137, 'exit_volatility': 16.44117529346046, 'entry_volatility': 16.118863379677137, 'EntryVolatility': 16.118863379677137, 'ExitVolatility': 16.44117529346046, 'volume': 2336982.0, 'exit_volume': 2699988.0, 'entry_volume': 2336982.0, 'volume_entry': 2336982.0, 'volume_exit': 2699988.0, 'EntryVolume': 2336982.0, 'ExitVolume': 2699988.0, 'atr_entry': 24.32335939262365, 'atr_exit': 22.074454143748536, 'EntryATR': 24.32335939262365, 'ExitATR': 22.074454143748536, 'entry_sma_short': 1007.9480926513672, 'exit_sma_short': 1112.3132080078126, 'entry_sma_long': 1006.7764245605468, 'exit_sma_long': 1113.5601440429687, 'EntrySMA_Short': 1007.9480926513672, 'ExitSMA_Short': 1112.3132080078126, 'EntrySMA_Long': 1006.7764245605468, 'ExitSMA_Long': 1113.5601440429687, 'entry_rsi': 83.55997636854161, 'exit_rsi': 37.46312101500903, 'EntryRSI': 83.55997636854161, 'ExitRSI': 37.46312101500903, 'rationale': 'Buy: short SMA crossed above long SMA at index 2016-03-21 00:00:00+05:30', 'Rationale': 'Buy: short SMA crossed above long SMA at index 2016-03-21 00:00:00+05:30', 'ticker': 'TCS.NS', 'context': [1099.203369140625, 1121.250244140625, 1098.3035888671875, 1095.383056640625, 1091.4744873046875, 1067.100341796875, 1065.695068359375, 1082.1861572265625, 1082.53759765625, 1094.900146484375, 1107.548095703125], 'indicators': {'sma_short': 1007.9480926513672, 'sma_long': 1006.7764245605468, 'rsi': 83.55997636854161, 'atr': 24.32335939262365, 'volatility': 16.118863379677137}, 'action': 'buy', 'qty': 2336982.0}, {'entry_index': Timestamp('2016-08-08 00:00:00+0530', tz='Asia/Kolkata'), 'exit_index': Timestamp('2016-09-12 00:00:00+0530', tz='Asia/Kolkata'), 'entry_price': 1166.6014404296875, 'exit_price': 1038.71337890625, 'pnl': -132.29869116210938, 'commission_cost': 4.4106296386718755, 'regime': 'ranging', 'entry_regime': 'ranging', 'exit_regime': 'ranging', 'EntryRegime': 'ranging', 'ExitRegime': 'ranging', 'volatility': 22.811093014092922, 'exit_volatility': 34.827970973933326, 'entry_volatility': 22.811093014092922, 'EntryVolatility': 22.811093014092922, 'ExitVolatility': 34.827970973933326, 'volume': 2058244.0, 'exit_volume': 2024454.0, 'entry_volume': 2058244.0, 'volume_entry': 2058244.0, 'volume_exit': 2024454.0, 'EntryVolume': 2058244.0, 'ExitVolume': 2024454.0, 'atr_entry': 22.882056499296397, 'atr_exit': 23.487764427607736, 'EntryATR': 22.882056499296397, 'ExitATR': 23.487764427607736, 'entry_sma_short': 1127.7510620117187, 'exit_sma_short': 1114.6680908203125, 'entry_sma_long': 1125.5620581054689, 'exit_sma_long': 1120.1577563476562, 'EntrySMA_Short': 1127.7510620117187, 'ExitSMA_Short': 1114.6680908203125, 'EntrySMA_Long': 1125.5620581054689, 'ExitSMA_Long': 1120.1577563476562, 'entry_rsi': 79.5742282194841, 'exit_rsi': 29.826526387311162, 'EntryRSI': 79.5742282194841, 'ExitRSI': 29.826526387311162, 'rationale': 'Sell: short SMA crossed below long SMA at index 2016-09-12 00:00:00+05:30', 'Rationale': 'Sell: short SMA crossed below long SMA at index 2016-09-12 00:00:00+05:30', 'ticker': 'TCS.NS', 'context': [1111.7606201171875, 1101.017822265625, 1120.21484375, 1105.750732421875, 1104.07763671875, 1107.2918701171875, 1093.751953125, 1074.598876953125, 1022.4437255859375, 1035.807373046875, 1038.71337890625], 'indicators': {'sma_short': 1127.7510620117187, 'sma_long': 1125.5620581054689, 'rsi': 79.5742282194841, 'atr': 22.882056499296397, 'volatility': 22.811093014092922}, 'action': 'buy', 'qty': 2058244.0}, {'entry_index': Timestamp('2017-01-02 00:00:00+0530', tz='Asia/Kolkata'), 'exit_index': Timestamp('2017-04-18 00:00:00+0530', tz='Asia/Kolkata'), 'entry_price': 1042.51611328125, 'exit_price': 1022.223388671875, 'pnl': -24.42220361328125, 'commission_cost': 4.12947900390625, 'regime': 'ranging', 'entry_regime': 'ranging', 'exit_regime': 'ranging', 'EntryRegime': 'ranging', 'ExitRegime': 'ranging', 'volatility': 12.530790767565804, 'exit_volatility': 20.675956984591572, 'entry_volatility': 12.530790767565804, 'EntryVolatility': 12.530790767565804, 'ExitVolatility': 20.675956984591572, 'volume': 823132.0, 'exit_volume': 1730620.0, 'entry_volume': 823132.0, 'volume_entry': 823132.0, 'volume_exit': 1730620.0, 'EntryVolume': 823132.0, 'ExitVolume': 1730620.0, 'atr_entry': 23.674647283152307, 'atr_exit': 20.22264083283411, 'EntryATR': 23.674647283152307, 'ExitATR': 20.22264083283411, 'entry_sma_short': 1002.8934997558594, 'exit_sma_short': 1069.725079345703, 'entry_sma_long': 999.1856970214844, 'exit_sma_long': 1073.886239013672, 'EntrySMA_Short': 1002.8934997558594, 'ExitSMA_Short': 1069.725079345703, 'EntrySMA_Long': 999.1856970214844, 'ExitSMA_Long': 1073.886239013672, 'entry_rsi': 77.59095441443617, 'exit_rsi': 27.19259032791257, 'EntryRSI': 77.59095441443617, 'ExitRSI': 27.19259032791257, 'rationale': 'Sell: short SMA crossed below long SMA at index 2017-04-18 00:00:00+05:30', 'Rationale': 'Sell: short SMA crossed below long SMA at index 2017-04-18 00:00:00+05:30', 'ticker': 'TCS.NS', 'context': [1076.6817626953125, 1067.7823486328125, 1063.1558837890625, 1062.6243896484375, 1075.464111328125, 1072.453857421875, 1071.147705078125, 1059.613525390625, 1031.0120849609375, 1024.902099609375, 1022.223388671875], 'indicators': {'sma_short': 1002.8934997558594, 'sma_long': 999.1856970214844, 'rsi': 77.59095441443617, 'atr': 23.674647283152307, 'volatility': 12.530790767565804}, 'action': 'buy', 'qty': 823132.0}, {'entry_index': Timestamp('2017-05-26 00:00:00+0530', tz='Asia/Kolkata'), 'exit_index': Timestamp('2017-07-05 00:00:00+0530', tz='Asia/Kolkata'), 'entry_price': 1141.5228271484375, 'exit_price': 1054.7835693359375, 'pnl': -91.13187060546875, 'commission_cost': 4.39261279296875, 'regime': 'trending', 'entry_regime': 'trending', 'exit_regime': 'ranging', 'EntryRegime': 'trending', 'ExitRegime': 'ranging', 'volatility': 37.69958038743053, 'exit_volatility': 14.399672945579374, 'entry_volatility': 37.69958038743053, 'EntryVolatility': 37.69958038743053, 'ExitVolatility': 14.399672945579374, 'volume': 1362550.0, 'exit_volume': 815856.0, 'entry_volume': 1362550.0, 'volume_entry': 1362550.0, 'volume_exit': 815856.0, 'EntryVolume': 1362550.0, 'ExitVolume': 815856.0, 'atr_entry': 19.972469347631815, 'atr_exit': 22.641982633423087, 'EntryATR': 19.972469347631815, 'ExitATR': 22.641982633423087, 'entry_sma_short': 1071.3797760009766, 'exit_sma_short': 1080.6648254394531, 'entry_sma_long': 1066.5980932617188, 'exit_sma_long': 1082.3128552246094, 'EntrySMA_Short': 1071.3797760009766, 'ExitSMA_Short': 1080.6648254394531, 'EntrySMA_Long': 1066.5980932617188, 'ExitSMA_Long': 1082.3128552246094, 'entry_rsi': 76.42924465622788, 'exit_rsi': 30.960269115374132, 'EntryRSI': 76.42924465622788, 'ExitRSI': 30.960269115374132, 'rationale': 'Sell: short SMA crossed below long SMA at index 2017-07-05 00:00:00+05:30', 'Rationale': 'Sell: short SMA crossed below long SMA at index 2017-07-05 00:00:00+05:30', 'ticker': 'TCS.NS', 'context': [1094.6290283203125, 1077.302978515625, 1072.177001953125, 1057.33544921875, 1048.8963623046875, 1052.119873046875, 1044.598388671875, 1057.6263427734375, 1062.6627197265625, 1059.641357421875, 1054.7835693359375], 'indicators': {'sma_short': 1071.3797760009766, 'sma_long': 1066.5980932617188, 'rsi': 76.42924465622788, 'atr': 19.972469347631815, 'volatility': 37.69958038743053}, 'action': 'buy', 'qty': 1362550.0}, {'entry_index': Timestamp('2017-08-03 00:00:00+0530', tz='Asia/Kolkata'), 'exit_index': Timestamp('2017-09-20 00:00:00+0530', tz='Asia/Kolkata'), 'entry_price': 1117.66943359375, 'exit_price': 1119.5107421875, 'pnl': -2.6330517578125, 'commission_cost': 4.4743603515625, 'regime': 'ranging', 'entry_regime': 'ranging', 'exit_regime': 'ranging', 'EntryRegime': 'ranging', 'ExitRegime': 'ranging', 'volatility': 17.24492547682601, 'exit_volatility': 8.497332082256023, 'entry_volatility': 17.24492547682601, 'EntryVolatility': 17.24492547682601, 'ExitVolatility': 8.497332082256023, 'volume': 1882548.0, 'exit_volume': 1334642.0, 'entry_volume': 1882548.0, 'volume_entry': 1882548.0, 'volume_exit': 1334642.0, 'EntryVolume': 1882548.0, 'ExitVolume': 1334642.0, 'atr_entry': 23.979718785750137, 'atr_exit': 20.243034224560553, 'EntryATR': 23.979718785750137, 'ExitATR': 20.243034224560553, 'entry_sma_short': 1104.9222290039063, 'exit_sma_short': 1113.9197692871094, 'entry_sma_long': 1101.5046118164062, 'exit_sma_long': 1114.5577807617187, 'EntrySMA_Short': 1104.9222290039063, 'ExitSMA_Short': 1113.9197692871094, 'EntrySMA_Long': 1101.5046118164062, 'ExitSMA_Long': 1114.5577807617187, 'entry_rsi': 64.19437100226554, 'exit_rsi': 49.30570353486992, 'EntryRSI': 64.19437100226554, 'ExitRSI': 49.30570353486992, 'rationale': 'Sell: short SMA crossed below long SMA at index 2017-09-20 00:00:00+05:30', 'Rationale': 'Sell: short SMA crossed below long SMA at index 2017-09-20 00:00:00+05:30', 'ticker': 'TCS.NS', 'context': [1101.3948974609375, 1104.492431640625, 1109.20654296875, 1101.955810546875, 1117.2205810546875, 1117.557373046875, 1116.5472412109375, 1125.122802734375, 1121.9796142578125, 1121.6202392578125, 1119.5107421875], 'indicators': {'sma_short': 1104.9222290039063, 'sma_long': 1101.5046118164062, 'rsi': 64.19437100226554, 'atr': 23.979718785750137, 'volatility': 17.24492547682601}, 'action': 'buy', 'qty': 1882548.0}, {'entry_index': Timestamp('2017-10-16 00:00:00+0530', tz='Asia/Kolkata'), 'exit_index': Timestamp('2017-12-20 00:00:00+0530', tz='Asia/Kolkata'), 'entry_price': 1160.298583984375, 'exit_price': 1165.5057373046875, 'pnl': 0.5555446777343747, 'commission_cost': 4.651608642578125, 'regime': 'ranging', 'entry_regime': 'ranging', 'exit_regime': 'ranging', 'EntryRegime': 'ranging', 'ExitRegime': 'ranging', 'volatility': 25.070780817490167, 'exit_volatility': 15.56132382083433, 'entry_volatility': 25.070780817490167, 'EntryVolatility': 25.070780817490167, 'ExitVolatility': 15.56132382083433, 'volume': 1218590.0, 'exit_volume': 1577570.0, 'entry_volume': 1218590.0, 'volume_entry': 1218590.0, 'volume_exit': 1577570.0, 'EntryVolume': 1218590.0, 'ExitVolume': 1577570.0, 'atr_entry': 18.487825911629443, 'atr_exit': 22.464162956941788, 'EntryATR': 18.487825911629443, 'ExitATR': 22.464162956941788, 'entry_sma_short': 1117.558575439453, 'exit_sma_short': 1182.5294555664063, 'entry_sma_long': 1117.386416015625, 'exit_sma_long': 1185.00658203125, 'EntrySMA_Short': 1117.558575439453, 'ExitSMA_Short': 1182.5294555664063, 'EntrySMA_Long': 1117.386416015625, 'ExitSMA_Long': 1185.00658203125, 'entry_rsi': 62.207836573259094, 'exit_rsi': 42.20111613823214, 'EntryRSI': 62.207836573259094, 'ExitRSI': 42.20111613823214, 'rationale': 'Buy: short SMA crossed above long SMA at index 2017-10-16 00:00:00+05:30', 'Rationale': 'Buy: short SMA crossed above long SMA at index 2017-10-16 00:00:00+05:30', 'ticker': 'TCS.NS', 'context': [1185.471435546875, 1178.2457275390625, 1171.1552734375, 1197.98681640625, 1175.9500732421875, 1183.265625, 1151.4822998046875, 1145.9906005859375, 1161.70166015625, 1159.360595703125, 1165.5057373046875], 'indicators': {'sma_short': 1117.558575439453, 'sma_long': 1117.386416015625, 'rsi': 62.207836573259094, 'atr': 18.487825911629443, 'volatility': 25.070780817490167}, 'action': 'buy', 'qty': 1218590.0}, {'entry_index': Timestamp('2018-01-15 00:00:00+0530', tz='Asia/Kolkata'), 'exit_index': Timestamp('2018-03-22 00:00:00+0530', tz='Asia/Kolkata'), 'entry_price': 1236.2523193359375, 'exit_price': 1277.6527099609375, 'pnl': 36.37258056640625, 'commission_cost': 5.02781005859375, 'regime': 'ranging', 'entry_regime': 'ranging', 'exit_regime': 'ranging', 'EntryRegime': 'ranging', 'ExitRegime': 'ranging', 'volatility': 28.54815844587923, 'exit_volatility': 38.05862519378415, 'entry_volatility': 28.54815844587923, 'EntryVolatility': 28.54815844587923, 'ExitVolatility': 38.05862519378415, 'volume': 1457214.0, 'exit_volume': 2326094.0, 'entry_volume': 1457214.0, 'volume_entry': 1457214.0, 'volume_exit': 2326094.0, 'EntryVolume': 1457214.0, 'ExitVolume': 2326094.0, 'atr_entry': 23.32632129116307, 'atr_exit': 35.3867411018588, 'EntryATR': 23.32632129116307, 'ExitATR': 35.3867411018588, 'entry_sma_short': 1201.75458984375, 'exit_sma_short': 1340.0416870117188, 'entry_sma_long': 1201.3228735351563, 'exit_sma_long': 1342.0076831054687, 'EntrySMA_Short': 1201.75458984375, 'ExitSMA_Short': 1340.0416870117188, 'EntrySMA_Long': 1201.3228735351563, 'ExitSMA_Long': 1342.0076831054687, 'entry_rsi': 61.30272645978805, 'exit_rsi': 30.06466119904684, 'EntryRSI': 61.30272645978805, 'ExitRSI': 30.06466119904684, 'rationale': 'Buy: short SMA crossed above long SMA at index 2018-01-15 00:00:00+05:30', 'Rationale': 'Buy: short SMA crossed above long SMA at index 2018-01-15 00:00:00+05:30', 'ticker': 'TCS.NS', 'context': [1355.538818359375, 1369.14404296875, 1377.289306640625, 1302.6744384765625, 1302.7193603515625, 1294.9581298828125, 1275.103271484375, 1277.4947509765625, 1292.769775390625, 1289.1142578125, 1277.6527099609375], 'indicators': {'sma_short': 1201.75458984375, 'sma_long': 1201.3228735351563, 'rsi': 61.30272645978805, 'atr': 23.32632129116307, 'volatility': 28.54815844587923}, 'action': 'buy', 'qty': 1457214.0}, {'entry_index': Timestamp('2018-04-20 00:00:00+0530', tz='Asia/Kolkata'), 'exit_index': Timestamp('2018-10-24 00:00:00+0530', tz='Asia/Kolkata'), 'entry_price': 1535.3626708984375, 'exit_price': 1689.101318359375, 'pnl': 147.28971948242187, 'commission_cost': 6.448927978515625, 'regime': 'trending', 'entry_regime': 'trending', 'exit_regime': 'trending', 'EntryRegime': 'trending', 'ExitRegime': 'trending', 'volatility': 64.68997203970447, 'exit_volatility': 67.38974352706316, 'entry_volatility': 64.68997203970447, 'EntryVolatility': 64.68997203970447, 'ExitVolatility': 67.38974352706316, 'volume': 8558576.400000006, 'exit_volume': 2735913.0, 'entry_volume': 8558576.400000006, 'volume_entry': 8558576.400000006, 'volume_exit': 2735913.0, 'EntryVolume': 8558576.400000006, 'ExitVolume': 2735913.0, 'atr_entry': 31.597591452476085, 'atr_exit': 41.47564671077476, 'EntryATR': 31.597591452476085, 'ExitATR': 41.47564671077476, 'entry_sma_short': 1355.5286499023437, 'exit_sma_short': 1857.9934997558594, 'entry_sma_long': 1346.411796875, 'exit_sma_long': 1866.0821826171875, 'EntrySMA_Short': 1355.5286499023437, 'ExitSMA_Short': 1857.9934997558594, 'EntrySMA_Long': 1346.411796875, 'ExitSMA_Long': 1866.0821826171875, 'entry_rsi': 89.82520911551711, 'exit_rsi': 19.70449875176196, 'EntryRSI': 89.82520911551711, 'ExitRSI': 19.70449875176196, 'rationale': 'Buy: short SMA crossed above long SMA at index 2018-04-20 00:00:00+05:30', 'Rationale': 'Buy: short SMA crossed above long SMA at index 2018-04-20 00:00:00+05:30', 'ticker': 'TCS.NS', 'context': [1907.403076171875, 1863.451904296875, 1805.41259765625, 1749.197021484375, 1777.6473388671875, 1789.3187255859375, 1759.3192138671875, 1744.5469970703125, 1735.2462158203125, 1684.6688232421875, 1689.101318359375], 'indicators': {'sma_short': 1355.5286499023437, 'sma_long': 1346.411796875, 'rsi': 89.82520911551711, 'atr': 31.597591452476085, 'volatility': 64.68997203970447}, 'action': 'buy', 'qty': 8558576.400000006}, {'entry_index': Timestamp('2018-12-14 00:00:00+0530', tz='Asia/Kolkata'), 'exit_index': Timestamp('2019-01-10 00:00:00+0530', tz='Asia/Kolkata'), 'entry_price': 1818.1710205078125, 'exit_price': 1725.697265625, 'pnl': -99.56149145507813, 'commission_cost': 7.087736572265626, 'regime': 'ranging', 'entry_regime': 'ranging', 'exit_regime': 'ranging', 'EntryRegime': 'ranging', 'ExitRegime': 'ranging', 'volatility': 13.758803755881244, 'exit_volatility': 11.133004690065835, 'entry_volatility': 13.758803755881244, 'EntryVolatility': 13.758803755881244, 'ExitVolatility': 11.133004690065835, 'volume': 2473761.0, 'exit_volume': 3053461.0, 'entry_volume': 2473761.0, 'volume_entry': 2473761.0, 'volume_exit': 3053461.0, 'EntryVolume': 2473761.0, 'ExitVolume': 3053461.0, 'atr_entry': 50.385429460266685, 'atr_exit': 40.192103562664414, 'EntryATR': 50.385429460266685, 'ExitATR': 40.192103562664414, 'entry_sma_short': 1776.9940063476563, 'exit_sma_short': 1756.6466064453125, 'entry_sma_long': 1774.782958984375, 'exit_sma_long': 1760.4689208984375, 'EntrySMA_Short': 1776.9940063476563, 'ExitSMA_Short': 1756.6466064453125, 'EntrySMA_Long': 1774.782958984375, 'ExitSMA_Long': 1760.4689208984375, 'entry_rsi': 71.51423795916783, 'exit_rsi': 37.217041268318376, 'EntryRSI': 71.51423795916783, 'ExitRSI': 37.217041268318376, 'rationale': 'Sell: short SMA crossed below long SMA at index 2019-01-10 00:00:00+05:30', 'Rationale': 'Sell: short SMA crossed below long SMA at index 2019-01-10 00:00:00+05:30', 'ticker': 'TCS.NS', 'context': [1744.337890625, 1732.5509033203125, 1729.809326171875, 1738.718505859375, 1757.45068359375, 1736.114013671875, 1715.006103515625, 1734.2412109375, 1730.2659912109375, 1724.2349853515625, 1725.697265625], 'indicators': {'sma_short': 1776.9940063476563, 'sma_long': 1774.782958984375, 'rsi': 71.51423795916783, 'atr': 50.385429460266685, 'volatility': 13.758803755881244}, 'action': 'buy', 'qty': 2473761.0}, {'entry_index': Timestamp('2019-02-07 00:00:00+0530', tz='Asia/Kolkata'), 'exit_index': Timestamp('2019-07-23 00:00:00+0530', tz='Asia/Kolkata'), 'entry_price': 1907.3680419921875, 'exit_price': 1954.63671875, 'pnl': 39.544667236328124, 'commission_cost': 7.724009521484375, 'regime': 'trending', 'entry_regime': 'trending', 'exit_regime': 'ranging', 'EntryRegime': 'trending', 'ExitRegime': 'ranging', 'volatility': 55.380696588194034, 'exit_volatility': 19.457800629609387, 'entry_volatility': 55.380696588194034, 'EntryVolatility': 55.380696588194034, 'ExitVolatility': 19.457800629609387, 'volume': 1339945.0, 'exit_volume': 3538588.0, 'entry_volume': 1339945.0, 'volume_entry': 1339945.0, 'volume_exit': 3538588.0, 'EntryVolume': 1339945.0, 'ExitVolume': 3538588.0, 'atr_entry': 35.061515957989656, 'atr_exit': 42.56218603898725, 'EntryATR': 35.061515957989656, 'ExitATR': 42.56218603898725, 'entry_sma_short': 1780.957861328125, 'exit_sma_short': 1996.7326782226562, 'entry_sma_long': 1778.8915698242188, 'exit_sma_long': 1999.0076220703124, 'EntrySMA_Short': 1780.957861328125, 'ExitSMA_Short': 1996.7326782226562, 'EntrySMA_Long': 1778.8915698242188, 'ExitSMA_Long': 1999.0076220703124, 'entry_rsi': 84.70768568379302, 'exit_rsi': 33.15290076443344, 'EntryRSI': 84.70768568379302, 'ExitRSI': 33.15290076443344, 'rationale': 'Buy: short SMA crossed above long SMA at index 2019-02-07 00:00:00+05:30', 'Rationale': 'Buy: short SMA crossed above long SMA at index 2019-02-07 00:00:00+05:30', 'ticker': 'TCS.NS', 'context': [1969.375244140625, 1946.1583251953125, 1940.94287109375, 1945.604736328125, 1980.7760009765625, 1948.6688232421875, 1959.0775146484375, 1911.6102294921875, 1921.788818359375, 1952.2763671875, 1954.63671875], 'indicators': {'sma_short': 1780.957861328125, 'sma_long': 1778.8915698242188, 'rsi': 84.70768568379302, 'atr': 35.061515957989656, 'volatility': 55.380696588194034}, 'action': 'buy', 'qty': 1339945.0}, {'entry_index': Timestamp('2019-08-23 00:00:00+0530', tz='Asia/Kolkata'), 'exit_index': Timestamp('2019-09-25 00:00:00+0530', tz='Asia/Kolkata'), 'entry_price': 2079.781982421875, 'exit_price': 1932.4293212890625, 'pnl': -155.37708374023438, 'commission_cost': 8.024422607421876, 'regime': 'ranging', 'entry_regime': 'ranging', 'exit_regime': 'ranging', 'EntryRegime': 'ranging', 'ExitRegime': 'ranging', 'volatility': 30.01268203463836, 'exit_volatility': 42.890237956883496, 'entry_volatility': 30.01268203463836, 'EntryVolatility': 30.01268203463836, 'ExitVolatility': 42.890237956883496, 'volume': 2826425.0, 'exit_volume': 4002232.0, 'entry_volume': 2826425.0, 'volume_entry': 2826425.0, 'volume_exit': 4002232.0, 'EntryVolume': 2826425.0, 'ExitVolume': 4002232.0, 'atr_entry': 41.128940479160136, 'atr_exit': 43.6184748197578, 'EntryATR': 41.128940479160136, 'ExitATR': 43.6184748197578, 'entry_sma_short': 2030.4203552246095, 'exit_sma_short': 1999.4924621582031, 'entry_sma_long': 2025.1902075195312, 'exit_sma_long': 2004.3819580078125, 'EntrySMA_Short': 2030.4203552246095, 'ExitSMA_Short': 1999.4924621582031, 'EntrySMA_Long': 2025.1902075195312, 'ExitSMA_Long': 2004.3819580078125, 'entry_rsi': 59.973385116048206, 'exit_rsi': 28.608345946941213, 'EntryRSI': 59.973385116048206, 'ExitRSI': 28.608345946941213, 'rationale': 'Sell: short SMA crossed below long SMA at index 2019-09-25 00:00:00+05:30', 'Rationale': 'Sell: short SMA crossed below long SMA at index 2019-09-25 00:00:00+05:30', 'ticker': 'TCS.NS', 'context': [1993.08251953125, 1974.206787109375, 1981.9322509765625, 1989.3812255859375, 1964.0743408203125, 1978.7869873046875, 1944.9207763671875, 1911.1478271484375, 1865.20703125, 1891.94775390625, 1932.4293212890625], 'indicators': {'sma_short': 2030.4203552246095, 'sma_long': 2025.1902075195312, 'rsi': 59.973385116048206, 'atr': 41.128940479160136, 'volatility': 30.01268203463836}, 'action': 'buy', 'qty': 2826425.0}, {'entry_index': Timestamp('2019-11-11 00:00:00+0530', tz='Asia/Kolkata'), 'exit_index': Timestamp('2019-12-09 00:00:00+0530', tz='Asia/Kolkata'), 'entry_price': 1948.75732421875, 'exit_price': 1911.1910400390625, 'pnl': -45.28618090820312, 'commission_cost': 7.719896728515625, 'regime': 'ranging', 'entry_regime': 'ranging', 'exit_regime': 'ranging', 'EntryRegime': 'ranging', 'ExitRegime': 'ranging', 'volatility': 48.54074398505094, 'exit_volatility': 28.864382925161543, 'entry_volatility': 48.54074398505094, 'EntryVolatility': 48.54074398505094, 'ExitVolatility': 28.864382925161543, 'volume': 2983768.0, 'exit_volume': 2244747.0, 'entry_volume': 2983768.0, 'volume_entry': 2983768.0, 'volume_exit': 2244747.0, 'EntryVolume': 2983768.0, 'ExitVolume': 2244747.0, 'atr_entry': 45.04804706016177, 'atr_exit': 44.45522714856272, 'EntryATR': 45.04804706016177, 'ExitATR': 44.45522714856272, 'entry_sma_short': 1972.9657348632813, 'exit_sma_short': 1946.925244140625, 'entry_sma_long': 1968.3851245117187, 'exit_sma_long': 1947.0316772460938, 'EntrySMA_Short': 1972.9657348632813, 'ExitSMA_Short': 1946.925244140625, 'EntrySMA_Long': 1968.3851245117187, 'ExitSMA_Long': 1947.0316772460938, 'entry_rsi': 55.88137343786221, 'exit_rsi': 43.16217506972928, 'EntryRSI': 55.88137343786221, 'ExitRSI': 43.16217506972928, 'rationale': 'Sell: short SMA crossed below long SMA at index 2019-12-09 00:00:00+05:30', 'Rationale': 'Sell: short SMA crossed below long SMA at index 2019-12-09 00:00:00+05:30', 'ticker': 'TCS.NS', 'context': [1930.7159423828125, 1898.3909912109375, 1905.486572265625, 1926.8665771484375, 1904.5123291015625, 1874.64501953125, 1902.4259033203125, 1927.933349609375, 1967.63330078125, 1969.7666015625, 1911.1910400390625], 'indicators': {'sma_short': 1972.9657348632813, 'sma_long': 1968.3851245117187, 'rsi': 55.88137343786221, 'atr': 45.04804706016177, 'volatility': 48.54074398505094}, 'action': 'buy', 'qty': 2983768.0}, {'entry_index': Timestamp('2019-12-31 00:00:00+0530', tz='Asia/Kolkata'), 'exit_index': Timestamp('2020-02-13 00:00:00+0530', tz='Asia/Kolkata'), 'entry_price': 2005.106201171875, 'exit_price': 2037.781982421875, 'pnl': 24.5900048828125, 'commission_cost': 8.085776367187501, 'regime': 'ranging', 'entry_regime': 'ranging', 'exit_regime': 'ranging', 'EntryRegime': 'ranging', 'ExitRegime': 'ranging', 'volatility': 30.998875047161544, 'exit_volatility': 30.28562958273886, 'entry_volatility': 30.998875047161544, 'EntryVolatility': 30.998875047161544, 'ExitVolatility': 30.28562958273886, 'volume': 1909289.0, 'exit_volume': 1645948.0, 'entry_volume': 1909289.0, 'volume_entry': 1909289.0, 'volume_exit': 1645948.0, 'EntryVolume': 1909289.0, 'ExitVolume': 1645948.0, 'atr_entry': 46.01159689321325, 'atr_exit': 42.962248236659576, 'EntryATR': 46.01159689321325, 'ExitATR': 42.962248236659576, 'entry_sma_short': 1979.6820007324218, 'exit_sma_short': 2005.5753479003906, 'entry_sma_long': 1976.6256787109376, 'exit_sma_long': 2008.6999560546874, 'EntrySMA_Short': 1979.6820007324218, 'ExitSMA_Short': 2005.5753479003906, 'EntrySMA_Long': 1976.6256787109376, 'ExitSMA_Long': 2008.6999560546874, 'entry_rsi': 71.688715625006, 'exit_rsi': 51.4262672881713, 'EntryRSI': 71.688715625006, 'ExitRSI': 51.4262672881713, 'rationale': 'Buy: short SMA crossed above long SMA at index 2019-12-31 00:00:00+05:30', 'Rationale': 'Buy: short SMA crossed above long SMA at index 2019-12-31 00:00:00+05:30', 'ticker': 'TCS.NS', 'context': [1987.487060546875, 1932.8223876953125, 1954.6231689453125, 1959.504150390625, 1995.5745849609375, 1978.6551513671875, 1986.2786865234375, 2009.8922119140625, 2001.943115234375, 2018.0726318359375, 2037.781982421875], 'indicators': {'sma_short': 1979.6820007324218, 'sma_long': 1976.6256787109376, 'rsi': 71.688715625006, 'atr': 46.01159689321325, 'volatility': 30.998875047161544}, 'action': 'buy', 'qty': 1909289.0}, {'entry_index': Timestamp('2020-05-12 00:00:00+0530', tz='Asia/Kolkata'), 'exit_index': Timestamp('2021-03-02 00:00:00+0530', tz='Asia/Kolkata'), 'entry_price': 1825.62646484375, 'exit_price': 2847.40673828125, 'pnl': 1012.43420703125, 'commission_cost': 9.34606640625, 'regime': 'ranging', 'entry_regime': 'ranging', 'exit_regime': 'ranging', 'EntryRegime': 'ranging', 'ExitRegime': 'ranging', 'volatility': 44.45770449619443, 'exit_volatility': 65.20471491332768, 'entry_volatility': 44.45770449619443, 'EntryVolatility': 44.45770449619443, 'ExitVolatility': 65.20471491332768, 'volume': 3256595.0, 'exit_volume': 3306469.0, 'entry_volume': 3256595.0, 'volume_entry': 3256595.0, 'volume_exit': 3306469.0, 'EntryVolume': 3256595.0, 'ExitVolume': 3306469.0, 'atr_entry': 92.27967128874559, 'atr_exit': 72.90029215243368, 'EntryATR': 92.27967128874559, 'ExitATR': 72.90029215243368, 'entry_sma_short': 1736.7400512695312, 'exit_sma_short': 2922.1538818359377, 'entry_sma_long': 1732.641044921875, 'exit_sma_long': 2928.202958984375, 'EntrySMA_Short': 1736.7400512695312, 'ExitSMA_Short': 2922.1538818359377, 'EntrySMA_Long': 1732.641044921875, 'ExitSMA_Long': 2928.202958984375, 'entry_rsi': 68.21741591610947, 'exit_rsi': 32.6949903953263, 'EntryRSI': 68.21741591610947, 'ExitRSI': 32.6949903953263, 'rationale': 'Buy: short SMA crossed above long SMA at index 2020-05-12 00:00:00+05:30', 'Rationale': 'Buy: short SMA crossed above long SMA at index 2020-05-12 00:00:00+05:30', 'ticker': 'TCS.NS', 'context': [2944.43994140625, 2910.626953125, 2895.710693359375, 2909.443115234375, 2802.038818359375, 2822.638916015625, 2792.236083984375, 2836.940185546875, 2741.280517578125, 2769.599365234375, 2847.40673828125], 'indicators': {'sma_short': 1736.7400512695312, 'sma_long': 1732.641044921875, 'rsi': 68.21741591610947, 'atr': 92.27967128874559, 'volatility': 44.45770449619443}, 'action': 'buy', 'qty': 3256595.0}, {'entry_index': Timestamp('2021-04-07 00:00:00+0530', tz='Asia/Kolkata'), 'exit_index': Timestamp('2021-05-17 00:00:00+0530', tz='Asia/Kolkata'), 'entry_price': 3098.44287109375, 'exit_price': 2907.45458984375, 'pnl': -203.000076171875, 'commission_cost': 12.011794921875, 'regime': 'ranging', 'entry_regime': 'ranging', 'exit_regime': 'ranging', 'EntryRegime': 'ranging', 'ExitRegime': 'ranging', 'volatility': 67.14859585359592, 'exit_volatility': 37.31778591246115, 'entry_volatility': 67.14859585359592, 'EntryVolatility': 67.14859585359592, 'ExitVolatility': 37.31778591246115, 'volume': 2491268.0, 'exit_volume': 2890462.0, 'entry_volume': 2491268.0, 'volume_entry': 2491268.0, 'volume_exit': 2890462.0, 'EntryVolume': 2491268.0, 'ExitVolume': 2890462.0, 'atr_entry': 74.45298367857532, 'atr_exit': 67.52475255904574, 'EntryATR': 74.45298367857532, 'ExitATR': 67.52475255904574, 'entry_sma_short': 2953.34521484375, 'exit_sma_short': 2942.798962402344, 'entry_sma_long': 2949.221904296875, 'exit_sma_long': 2950.5383984375, 'EntrySMA_Short': 2953.34521484375, 'ExitSMA_Short': 2942.798962402344, 'EntrySMA_Long': 2949.221904296875, 'ExitSMA_Long': 2950.5383984375, 'entry_rsi': 66.28307101280075, 'exit_rsi': 45.55992725144182, 'EntryRSI': 66.28307101280075, 'ExitRSI': 45.55992725144182, 'rationale': 'Sell: short SMA crossed below long SMA at index 2021-05-17 00:00:00+05:30', 'Rationale': 'Sell: short SMA crossed below long SMA at index 2021-05-17 00:00:00+05:30', 'ticker': 'TCS.NS', 'context': [2875.1572265625, 2876.436279296875, 2888.51171875, 2932.032470703125, 2946.949462890625, 2967.265380859375, 2979.199951171875, 2957.510498046875, 2924.360595703125, 2890.169189453125, 2907.45458984375], 'indicators': {'sma_short': 2953.34521484375, 'sma_long': 2949.221904296875, 'rsi': 66.28307101280075, 'atr': 74.45298367857532, 'volatility': 67.14859585359592}, 'action': 'buy', 'qty': 2491268.0}, {'entry_index': Timestamp('2021-06-11 00:00:00+0530', tz='Asia/Kolkata'), 'exit_index': Timestamp('2021-07-30 00:00:00+0530', tz='Asia/Kolkata'), 'entry_price': 3115.8837890625, 'exit_price': 3021.24267578125, 'pnl': -106.9153662109375, 'commission_cost': 12.274252929687501, 'regime': 'ranging', 'entry_regime': 'ranging', 'exit_regime': 'ranging', 'EntryRegime': 'ranging', 'ExitRegime': 'ranging', 'volatility': 41.18331996931355, 'exit_volatility': 13.367823766267437, 'entry_volatility': 41.18331996931355, 'EntryVolatility': 41.18331996931355, 'ExitVolatility': 13.367823766267437, 'volume': 3452954.0, 'exit_volume': 2999943.0, 'entry_volume': 3452954.0, 'volume_entry': 3452954.0, 'volume_exit': 2999943.0, 'EntryVolume': 3452954.0, 'ExitVolume': 2999943.0, 'atr_entry': 57.76879797213847, 'atr_exit': 48.310584024513794, 'EntryATR': 57.76879797213847, 'ExitATR': 48.310584024513794, 'entry_sma_short': 2987.0900146484373, 'exit_sma_short': 3068.5420166015624, 'entry_sma_long': 2985.9955224609375, 'exit_sma_long': 3072.1698193359375, 'EntrySMA_Short': 2987.0900146484373, 'ExitSMA_Short': 3068.5420166015624, 'EntrySMA_Long': 2985.9955224609375, 'ExitSMA_Long': 3072.1698193359375, 'entry_rsi': 80.5303636474911, 'exit_rsi': 40.676363245116555, 'EntryRSI': 80.5303636474911, 'ExitRSI': 40.676363245116555, 'rationale': 'Sell: short SMA crossed below long SMA at index 2021-07-30 00:00:00+05:30', 'Rationale': 'Sell: short SMA crossed below long SMA at index 2021-07-30 00:00:00+05:30', 'ticker': 'TCS.NS', 'context': [3055.10400390625, 3047.330810546875, 3037.600830078125, 3057.822265625, 3067.8857421875, 3064.547119140625, 3049.953857421875, 3036.027099609375, 3050.19189453125, 3048.284423828125, 3021.24267578125], 'indicators': {'sma_short': 2987.0900146484373, 'sma_long': 2985.9955224609375, 'rsi': 80.5303636474911, 'atr': 57.76879797213847, 'volatility': 41.18331996931355}, 'action': 'buy', 'qty': 3452954.0}, {'entry_index': Timestamp('2021-08-16 00:00:00+0530', tz='Asia/Kolkata'), 'exit_index': Timestamp('2021-10-25 00:00:00+0530', tz='Asia/Kolkata'), 'entry_price': 3312.640869140625, 'exit_price': 3338.1103515625, 'pnl': 12.16797998046875, 'commission_cost': 13.30150244140625, 'regime': 'trending', 'entry_regime': 'trending', 'exit_regime': 'ranging', 'EntryRegime': 'trending', 'ExitRegime': 'ranging', 'volatility': 73.15600951783601, 'exit_volatility': 112.42891950059735, 'entry_volatility': 73.15600951783601, 'EntryVolatility': 73.15600951783601, 'ExitVolatility': 112.42891950059735, 'volume': 2083489.0, 'exit_volume': 2595594.0, 'entry_volume': 2083489.0, 'volume_entry': 2083489.0, 'volume_exit': 2595594.0, 'EntryVolume': 2083489.0, 'ExitVolume': 2595594.0, 'atr_entry': 50.40535237468853, 'atr_exit': 77.03893444146293, 'EntryATR': 50.40535237468853, 'ExitATR': 77.03893444146293, 'entry_sma_short': 3120.1106567382812, 'exit_sma_short': 3540.054235839844, 'entry_sma_long': 3115.688271484375, 'exit_sma_long': 3554.2244677734375, 'EntrySMA_Short': 3120.1106567382812, 'ExitSMA_Short': 3540.054235839844, 'EntrySMA_Long': 3115.688271484375, 'ExitSMA_Long': 3554.2244677734375, 'entry_rsi': 88.91574078017644, 'exit_rsi': 30.980367041678235, 'EntryRSI': 88.91574078017644, 'ExitRSI': 30.980367041678235, 'rationale': 'Buy: short SMA crossed above long SMA at index 2021-08-16 00:00:00+05:30', 'Rationale': 'Buy: short SMA crossed above long SMA at index 2021-08-16 00:00:00+05:30', 'ticker': 'TCS.NS', 'context': [3753.98291015625, 3515.4755859375, 3484.237060546875, 3486.47802734375, 3451.35791015625, 3485.47509765625, 3473.051025390625, 3448.873046875, 3375.907958984375, 3343.7490234375, 3338.1103515625], 'indicators': {'sma_short': 3120.1106567382812, 'sma_long': 3115.688271484375, 'rsi': 88.91574078017644, 'atr': 50.40535237468853, 'volatility': 73.15600951783601}, 'action': 'buy', 'qty': 2083489.0}, {'entry_index': Timestamp('2021-12-20 00:00:00+0530', tz='Asia/Kolkata'), 'exit_index': Timestamp('2022-02-22 00:00:00+0530', tz='Asia/Kolkata'), 'entry_price': 3399.225341796875, 'exit_price': 3433.440673828125, 'pnl': 20.549999999999997, 'commission_cost': 13.665332031250001, 'regime': 'ranging', 'entry_regime': 'ranging', 'exit_regime': 'ranging', 'EntryRegime': 'ranging', 'ExitRegime': 'ranging', 'volatility': 29.699406136453703, 'exit_volatility': 62.88385506011072, 'entry_volatility': 29.699406136453703, 'EntryVolatility': 29.699406136453703, 'ExitVolatility': 62.88385506011072, 'volume': 2312310.0, 'exit_volume': 5408531.0, 'entry_volume': 2312310.0, 'volume_entry': 2312310.0, 'volume_exit': 5408531.0, 'EntryVolume': 2312310.0, 'ExitVolume': 5408531.0, 'atr_entry': 66.38589311772309, 'atr_exit': 71.5409834641629, 'EntryATR': 66.38589311772309, 'ExitATR': 71.5409834641629, 'entry_sma_short': 3402.4559692382813, 'exit_sma_short': 3596.7, 'entry_sma_long': 3399.1990625, 'exit_sma_long': 3602.088857421875, 'EntrySMA_Short': 3402.4559692382813, 'ExitSMA_Short': 3596.7, 'EntrySMA_Long': 3399.1990625, 'ExitSMA_Long': 3602.088857421875, 'entry_rsi': 52.73584801113037, 'exit_rsi': 27.085050741422123, 'EntryRSI': 52.73584801113037, 'ExitRSI': 27.085050741422123, 'rationale': 'Buy: short SMA crossed above long SMA at index 2021-12-20 00:00:00+05:30', 'Rationale': 'Buy: short SMA crossed above long SMA at index 2021-12-20 00:00:00+05:30', 'ticker': 'TCS.NS', 'context': [3583.792724609375, 3600.163330078125, 3609.545166015625, 3537.361083984375, 3574.506103515625, 3654.971923828125, 3650.471923828125, 3622.804931640625, 3632.090576171875, 3560.76806640625, 3433.440673828125], 'indicators': {'sma_short': 3402.4559692382813, 'sma_long': 3399.1990625, 'rsi': 52.73584801113037, 'atr': 66.38589311772309, 'volatility': 29.699406136453703}, 'action': 'buy', 'qty': 2312310.0}, {'entry_index': Timestamp('2022-04-06 00:00:00+0530', tz='Asia/Kolkata'), 'exit_index': Timestamp('2022-04-29 00:00:00+0530', tz='Asia/Kolkata'), 'entry_price': 3595.1845703125, 'exit_price': 3395.433837890625, 'pnl': -213.73196923828124, 'commission_cost': 13.98123681640625, 'regime': 'ranging', 'entry_regime': 'ranging', 'exit_regime': 'ranging', 'EntryRegime': 'ranging', 'ExitRegime': 'ranging', 'volatility': 32.210665100125425, 'exit_volatility': 49.81421720666413, 'entry_volatility': 32.210665100125425, 'EntryVolatility': 32.210665100125425, 'ExitVolatility': 49.81421720666413, 'volume': 2051729.0, 'exit_volume': 2051115.0, 'entry_volume': 2051729.0, 'volume_entry': 2051729.0, 'volume_exit': 2051115.0, 'EntryVolume': 2051729.0, 'ExitVolume': 2051115.0, 'atr_entry': 73.34448232406695, 'atr_exit': 74.4885086285055, 'EntryATR': 73.34448232406695, 'ExitATR': 74.4885086285055, 'entry_sma_short': 3537.3801147460936, 'exit_sma_short': 3486.817626953125, 'entry_sma_long': 3533.570859375, 'exit_sma_long': 3487.7846044921876, 'EntrySMA_Short': 3537.3801147460936, 'ExitSMA_Short': 3486.817626953125, 'EntrySMA_Long': 3533.570859375, 'ExitSMA_Long': 3487.7846044921876, 'entry_rsi': 62.43280242654096, 'exit_rsi': 37.53740630215552, 'EntryRSI': 62.43280242654096, 'ExitRSI': 37.53740630215552, 'rationale': 'Sell: short SMA crossed below long SMA at index 2022-04-29 00:00:00+05:30', 'Rationale': 'Sell: short SMA crossed below long SMA at index 2022-04-29 00:00:00+05:30', 'ticker': 'TCS.NS', 'context': [3505.768310546875, 3377.579345703125, 3323.82373046875, 3405.102783203125, 3473.888671875, 3458.4755859375, 3396.8701171875, 3395.051025390625, 3409.3154296875, 3431.429931640625, 3395.433837890625], 'indicators': {'sma_short': 3537.3801147460936, 'sma_long': 3533.570859375, 'rsi': 62.43280242654096, 'atr': 73.34448232406695, 'volatility': 32.210665100125425}, 'action': 'buy', 'qty': 2051729.0}, {'entry_index': Timestamp('2022-08-12 00:00:00+0530', tz='Asia/Kolkata'), 'exit_index': Timestamp('2022-09-15 00:00:00+0530', tz='Asia/Kolkata'), 'entry_price': 3287.064208984375, 'exit_price': 2999.866943359375, 'pnl': -299.7711279296875, 'commission_cost': 12.5738623046875, 'regime': 'trending', 'entry_regime': 'trending', 'exit_regime': 'ranging', 'EntryRegime': 'trending', 'ExitRegime': 'ranging', 'volatility': 47.90023527071091, 'exit_volatility': 46.694623049524694, 'entry_volatility': 47.90023527071091, 'EntryVolatility': 47.90023527071091, 'ExitVolatility': 46.694623049524694, 'volume': 1472354.0, 'exit_volume': 2138023.0, 'entry_volume': 1472354.0, 'volume_entry': 1472354.0, 'volume_exit': 2138023.0, 'EntryVolume': 1472354.0, 'ExitVolume': 2138023.0, 'atr_entry': 69.46224829311399, 'atr_exit': 60.24547618296845, 'EntryATR': 69.46224829311399, 'ExitATR': 60.24547618296845, 'entry_sma_short': 3134.9230102539063, 'exit_sma_short': 3102.0625122070314, 'entry_sma_long': 3132.5360107421875, 'exit_sma_long': 3113.2832373046876, 'EntrySMA_Short': 3134.9230102539063, 'ExitSMA_Short': 3102.0625122070314, 'EntrySMA_Long': 3132.5360107421875, 'ExitSMA_Long': 3113.2832373046876, 'entry_rsi': 76.0068146945699, 'exit_rsi': 38.98615772509217, 'EntryRSI': 76.0068146945699, 'ExitRSI': 38.98615772509217, 'rationale': 'Sell: short SMA crossed below long SMA at index 2022-09-15 00:00:00+05:30', 'Rationale': 'Sell: short SMA crossed below long SMA at index 2022-09-15 00:00:00+05:30', 'ticker': 'TCS.NS', 'context': [3026.29638671875, 3025.0400390625, 3027.939208984375, 3021.80322265625, 3043.59375, 3062.96923828125, 3109.35302734375, 3133.80224609375, 3120.659423828125, 3015.376220703125, 2999.866943359375], 'indicators': {'sma_short': 3134.9230102539063, 'sma_long': 3132.5360107421875, 'rsi': 76.0068146945699, 'atr': 69.46224829311399, 'volatility': 47.90023527071091}, 'action': 'buy', 'qty': 1472354.0}, {'entry_index': Timestamp('2022-11-02 00:00:00+0530', tz='Asia/Kolkata'), 'exit_index': Timestamp('2023-01-02 00:00:00+0530', tz='Asia/Kolkata'), 'entry_price': 3140.701416015625, 'exit_price': 3159.836181640625, 'pnl': 6.5336904296875, 'commission_cost': 12.6010751953125, 'regime': 'ranging', 'entry_regime': 'ranging', 'exit_regime': 'ranging', 'EntryRegime': 'ranging', 'ExitRegime': 'ranging', 'volatility': 41.28437583879449, 'exit_volatility': 19.16248878088338, 'entry_volatility': 41.28437583879449, 'EntryVolatility': 41.28437583879449, 'ExitVolatility': 19.16248878088338, 'volume': 1405955.0, 'exit_volume': 709547.0, 'entry_volume': 1405955.0, 'volume_entry': 1405955.0, 'volume_exit': 709547.0, 'EntryVolume': 1405955.0, 'ExitVolume': 709547.0, 'atr_entry': 58.008347366658384, 'atr_exit': 51.64712527112506, 'EntryATR': 58.008347366658384, 'ExitATR': 51.64712527112506, 'entry_sma_short': 3037.2004638671874, 'exit_sma_short': 3182.5312255859376, 'entry_sma_long': 3022.67310546875, 'exit_sma_long': 3187.22431640625, 'EntrySMA_Short': 3037.2004638671874, 'ExitSMA_Short': 3182.5312255859376, 'EntrySMA_Long': 3022.67310546875, 'ExitSMA_Long': 3187.22431640625, 'entry_rsi': 75.84824473946581, 'exit_rsi': 40.328483897652, 'EntryRSI': 75.84824473946581, 'ExitRSI': 40.328483897652, 'rationale': 'Buy: short SMA crossed above long SMA at index 2022-11-02 00:00:00+05:30', 'Rationale': 'Buy: short SMA crossed above long SMA at index 2022-11-02 00:00:00+05:30', 'ticker': 'TCS.NS', 'context': [3102.28662109375, 3142.881103515625, 3166.71484375, 3158.140380859375, 3127.767578125, 3151.552490234375, 3157.94677734375, 3155.62158203125, 3166.908447265625, 3155.234130859375, 3159.836181640625], 'indicators': {'sma_short': 3037.2004638671874, 'sma_long': 3022.67310546875, 'rsi': 75.84824473946581, 'atr': 58.008347366658384, 'volatility': 41.28437583879449}, 'action': 'buy', 'qty': 1405955.0}, {'entry_index': Timestamp('2023-01-25 00:00:00+0530', tz='Asia/Kolkata'), 'exit_index': Timestamp('2023-03-15 00:00:00+0530', tz='Asia/Kolkata'), 'entry_price': 3330.788818359375, 'exit_price': 3106.599365234375, 'pnl': -237.0642294921875, 'commission_cost': 12.8747763671875, 'regime': 'ranging', 'entry_regime': 'ranging', 'exit_regime': 'ranging', 'EntryRegime': 'ranging', 'ExitRegime': 'ranging', 'volatility': 38.55979038609464, 'exit_volatility': 61.39422761490684, 'entry_volatility': 38.55979038609464, 'EntryVolatility': 38.55979038609464, 'ExitVolatility': 61.39422761490684, 'volume': 874110.0, 'exit_volume': 1780522.0, 'entry_volume': 874110.0, 'volume_entry': 874110.0, 'volume_exit': 1780522.0, 'EntryVolume': 874110.0, 'ExitVolume': 1780522.0, 'atr_entry': 55.24870187498369, 'atr_exit': 60.21204107209431, 'EntryATR': 55.24870187498369, 'ExitATR': 60.21204107209431, 'entry_sma_short': 3234.1728271484376, 'exit_sma_short': 3280.2333374023438, 'entry_sma_long': 3227.5533447265625, 'exit_sma_long': 3291.4743115234373, 'EntrySMA_Short': 3234.1728271484376, 'ExitSMA_Short': 3280.2333374023438, 'EntrySMA_Long': 3227.5533447265625, 'ExitSMA_Long': 3291.4743115234373, 'entry_rsi': 62.071291660569365, 'exit_rsi': 30.161492762111962, 'EntryRSI': 62.071291660569365, 'ExitRSI': 30.161492762111962, 'rationale': 'Sell: short SMA crossed below long SMA at index 2023-03-15 00:00:00+05:30', 'Rationale': 'Sell: short SMA crossed below long SMA at index 2023-03-15 00:00:00+05:30', 'ticker': 'TCS.NS', 'context': [3217.261962890625, 3288.009765625, 3225.613525390625, 3245.71630859375, 3274.559326171875, 3292.573974609375, 3240.5693359375, 3234.887939453125, 3187.253173828125, 3122.186767578125, 3106.599365234375], 'indicators': {'sma_short': 3234.1728271484376, 'sma_long': 3227.5533447265625, 'rsi': 62.071291660569365, 'atr': 55.24870187498369, 'volatility': 38.55979038609464}, 'action': 'buy', 'qty': 874110.0}, {'entry_index': Timestamp('2023-05-18 00:00:00+0530', tz='Asia/Kolkata'), 'exit_index': Timestamp('2023-07-03 00:00:00+0530', tz='Asia/Kolkata'), 'entry_price': 3107.522216796875, 'exit_price': 3201.515869140625, 'pnl': 81.375576171875, 'commission_cost': 12.618076171875, 'regime': 'ranging', 'entry_regime': 'ranging', 'exit_regime': 'ranging', 'EntryRegime': 'ranging', 'ExitRegime': 'ranging', 'volatility': 30.133503520741414, 'exit_volatility': 37.034165375510774, 'entry_volatility': 30.133503520741414, 'EntryVolatility': 30.133503520741414, 'ExitVolatility': 37.034165375510774, 'volume': 1369364.0, 'exit_volume': 1687264.0, 'entry_volume': 1369364.0, 'volume_entry': 1369364.0, 'volume_exit': 1687264.0, 'EntryVolume': 1369364.0, 'ExitVolume': 1687264.0, 'atr_entry': 52.75655551755595, 'atr_exit': 42.887854835139386, 'EntryATR': 52.75655551755595, 'ExitATR': 42.887854835139386, 'entry_sma_short': 3125.69970703125, 'exit_sma_short': 3155.7790771484374, 'entry_sma_long': 3120.51716796875, 'exit_sma_long': 3157.339384765625, 'EntrySMA_Short': 3125.69970703125, 'ExitSMA_Short': 3155.7790771484374, 'EntrySMA_Long': 3120.51716796875, 'ExitSMA_Long': 3157.339384765625, 'entry_rsi': 52.19557582380476, 'exit_rsi': 56.913993916417844, 'EntryRSI': 52.19557582380476, 'ExitRSI': 56.913993916417844, 'rationale': 'Buy: short SMA crossed above long SMA at index 2023-05-18 00:00:00+05:30', 'Rationale': 'Buy: short SMA crossed above long SMA at index 2023-05-18 00:00:00+05:30', 'ticker': 'TCS.NS', 'context': [3106.222900390625, 3140.955078125, 3157.881103515625, 3187.72119140625, 3168.447509765625, 3146.776611328125, 3120.65380859375, 3128.187744140625, 3145.89599609375, 3230.818603515625, 3201.515869140625], 'indicators': {'sma_short': 3125.69970703125, 'sma_long': 3120.51716796875, 'rsi': 52.19557582380476, 'atr': 52.75655551755595, 'volatility': 30.133503520741414}, 'action': 'buy', 'qty': 1369364.0}, {'entry_index': Timestamp('2023-07-07 00:00:00+0530', tz='Asia/Kolkata'), 'exit_index': Timestamp('2023-11-02 00:00:00+0530', tz='Asia/Kolkata'), 'entry_price': 3257.234130859375, 'exit_price': 3304.493896484375, 'pnl': 34.1363095703125, 'commission_cost': 13.1234560546875, 'regime': 'ranging', 'entry_regime': 'ranging', 'exit_regime': 'ranging', 'EntryRegime': 'ranging', 'ExitRegime': 'ranging', 'volatility': 53.266358183328926, 'exit_volatility': 55.993446625605145, 'entry_volatility': 53.266358183328926, 'EntryVolatility': 53.266358183328926, 'ExitVolatility': 55.993446625605145, 'volume': 1789326.0, 'exit_volume': 1245384.0, 'entry_volume': 1789326.0, 'volume_entry': 1789326.0, 'volume_exit': 1245384.0, 'EntryVolume': 1789326.0, 'ExitVolume': 1245384.0, 'atr_entry': 42.006077640903804, 'atr_exit': 50.81962916803139, 'EntryATR': 42.006077640903804, 'ExitATR': 50.81962916803139, 'entry_sma_short': 3172.6368041992187, 'exit_sma_short': 3417.672473144531, 'entry_sma_long': 3170.3512255859373, 'exit_sma_long': 3420.3335302734376, 'EntrySMA_Short': 3172.6368041992187, 'ExitSMA_Short': 3417.672473144531, 'EntrySMA_Long': 3170.3512255859373, 'ExitSMA_Long': 3420.3335302734376, 'entry_rsi': 71.96517628476015, 'exit_rsi': 30.746314430245974, 'EntryRSI': 71.96517628476015, 'ExitRSI': 30.746314430245974, 'rationale': 'Buy: short SMA crossed above long SMA at index 2023-07-07 00:00:00+05:30', 'Rationale': 'Buy: short SMA crossed above long SMA at index 2023-07-07 00:00:00+05:30', 'ticker': 'TCS.NS', 'context': [3420.688232421875, 3398.462646484375, 3436.718994140625, 3353.71533203125, 3333.997314453125, 3281.530029296875, 3295.4951171875, 3322.638671875, 3313.00048828125, 3275.531005859375, 3304.493896484375], 'indicators': {'sma_short': 3172.6368041992187, 'sma_long': 3170.3512255859373, 'rsi': 71.96517628476015, 'atr': 42.006077640903804, 'volatility': 53.266358183328926}, 'action': 'buy', 'qty': 1789326.0}, {'entry_index': Timestamp('2023-12-08 00:00:00+0530', tz='Asia/Kolkata'), 'exit_index': Timestamp('2024-04-05 00:00:00+0530', tz='Asia/Kolkata'), 'entry_price': 3566.681884765625, 'exit_price': 3922.443359375, 'pnl': 340.7832241210937, 'commission_cost': 14.978250488281251, 'regime': 'ranging', 'entry_regime': 'ranging', 'exit_regime': 'ranging', 'EntryRegime': 'ranging', 'ExitRegime': 'ranging', 'volatility': 57.44747338604715, 'exit_volatility': 51.82343194469709, 'entry_volatility': 57.44747338604715, 'EntryVolatility': 57.44747338604715, 'ExitVolatility': 51.82343194469709, 'volume': 1641155.0, 'exit_volume': 1636819.0, 'entry_volume': 1641155.0, 'volume_entry': 1641155.0, 'volume_exit': 1636819.0, 'EntryVolume': 1641155.0, 'ExitVolume': 1636819.0, 'atr_entry': 50.72764380146919, 'atr_exit': 84.18179831226074, 'EntryATR': 50.72764380146919, 'ExitATR': 84.18179831226074, 'entry_sma_short': 3432.9939453125, 'exit_sma_short': 3961.2807739257814, 'entry_sma_long': 3423.1778759765625, 'exit_sma_long': 3961.7322509765627, 'EntrySMA_Short': 3432.9939453125, 'ExitSMA_Short': 3961.2807739257814, 'EntrySMA_Long': 3423.1778759765625, 'ExitSMA_Long': 3961.7322509765627, 'entry_rsi': 68.19444888748004, 'exit_rsi': 32.338183796541074, 'EntryRSI': 68.19444888748004, 'ExitRSI': 32.338183796541074, 'rationale': 'Buy: short SMA crossed above long SMA at index 2023-12-08 00:00:00+05:30', 'Rationale': 'Buy: short SMA crossed above long SMA at index 2023-12-08 00:00:00+05:30', 'ticker': 'TCS.NS', 'context': [3914.21240234375, 3916.233154296875, 3855.069091796875, 3822.145751953125, 3786.068115234375, 3820.962890625, 3860.83544921875, 3828.35595703125, 3890.949462890625, 3946.14990234375, 3922.443359375], 'indicators': {'sma_short': 3432.9939453125, 'sma_long': 3423.1778759765625, 'rsi': 68.19444888748004, 'atr': 50.72764380146919, 'volatility': 57.44747338604715}, 'action': 'buy', 'qty': 1641155.0}, {'entry_index': Timestamp('2024-07-02 00:00:00+0530', tz='Asia/Kolkata'), 'exit_index': Timestamp('2024-10-04 00:00:00+0530', tz='Asia/Kolkata'), 'entry_price': 3988.830810546875, 'exit_price': 4231.81689453125, 'pnl': 226.54478857421876, 'commission_cost': 16.44129541015625, 'regime': 'trending', 'entry_regime': 'trending', 'exit_regime': 'ranging', 'EntryRegime': 'trending', 'ExitRegime': 'ranging', 'volatility': 77.39997163923952, 'exit_volatility': 21.201782227182264, 'entry_volatility': 77.39997163923952, 'EntryVolatility': 77.39997163923952, 'ExitVolatility': 21.201782227182264, 'volume': 2307449.0, 'exit_volume': 2965463.0, 'entry_volume': 2307449.0, 'volume_entry': 2307449.0, 'volume_exit': 2965463.0, 'EntryVolume': 2307449.0, 'ExitVolume': 2965463.0, 'atr_entry': 68.00283621938388, 'atr_exit': 79.29424334589821, 'EntryATR': 68.00283621938388, 'ExitATR': 79.29424334589821, 'entry_sma_short': 3822.534533691406, 'exit_sma_short': 4330.551202148437, 'entry_sma_long': 3815.7201806640624, 'exit_sma_long': 4338.532907421875, 'EntrySMA_Short': 3822.534533691406, 'ExitSMA_Short': 4330.551202148437, 'EntrySMA_Long': 3815.7201806640624, 'ExitSMA_Long': 4338.532907421875, 'entry_rsi': 68.44863139071735, 'exit_rsi': 21.825197198152495, 'EntryRSI': 68.44863139071735, 'ExitRSI': 21.825197198152495, 'rationale': 'Buy: short SMA crossed above long SMA at index 2024-07-02 00:00:00+05:30', 'Rationale': 'Buy: short SMA crossed above long SMA at index 2024-07-02 00:00:00+05:30', 'ticker': 'TCS.NS', 'context': [4275.50537109375, 4264.3095703125, 4247.98876953125, 4250.77490234375, 4254.208984375, 4271.873046875, 4287.99560546875, 4247.98876953125, 4267.29541015625, 4212.41064453125, 4231.81689453125], 'indicators': {'sma_short': 3822.534533691406, 'sma_long': 3815.7201806640624, 'rsi': 68.44863139071735, 'atr': 68.00283621938388, 'volatility': 77.39997163923952}, 'action': 'buy', 'qty': 2307449.0}, {'entry_index': Timestamp('2024-12-03 00:00:00+0530', tz='Asia/Kolkata'), 'exit_index': Timestamp('2025-01-09 00:00:00+0530', tz='Asia/Kolkata'), 'entry_price': 4292.5205078125, 'exit_price': 4029.248291015625, 'pnl': -279.91575439453123, 'commission_cost': 16.643537597656252, 'regime': 'ranging', 'entry_regime': 'ranging', 'exit_regime': 'ranging', 'EntryRegime': 'ranging', 'ExitRegime': 'ranging', 'volatility': 121.1025508120866, 'exit_volatility': 50.269203375669775, 'entry_volatility': 121.1025508120866, 'EntryVolatility': 121.1025508120866, 'ExitVolatility': 50.269203375669775, 'volume': 2010905.0, 'exit_volume': 2392472.0, 'entry_volume': 2010905.0, 'volume_entry': 2010905.0, 'volume_exit': 2392472.0, 'EntryVolume': 2010905.0, 'ExitVolume': 2392472.0, 'atr_entry': 79.03150472629727, 'atr_exit': 89.05119208920703, 'EntryATR': 79.03150472629727, 'ExitATR': 89.05119208920703, 'entry_sma_short': 4166.939904785157, 'exit_sma_short': 4190.464346679687, 'entry_sma_long': 4155.905068359375, 'exit_sma_long': 4194.207292773437, 'EntrySMA_Short': 4166.939904785157, 'ExitSMA_Short': 4190.464346679687, 'EntrySMA_Long': 4155.905068359375, 'ExitSMA_Long': 4194.207292773437, 'entry_rsi': 57.67270414755591, 'exit_rsi': 30.49954028778599, 'EntryRSI': 57.67270414755591, 'ExitRSI': 30.49954028778599, 'rationale': 'Sell: short SMA crossed below long SMA at index 2025-01-09 00:00:00+05:30', 'Rationale': 'Sell: short SMA crossed below long SMA at index 2025-01-09 00:00:00+05:30', 'ticker': 'TCS.NS', 'context': [4159.1884765625, 4154.94873046875, 4148.91259765625, 4085.065185546875, 4102.67333984375, 4165.82275390625, 4090.15283203125, 4085.2646484375, 4018.72314453125, 4098.6328125, 4029.248291015625], 'indicators': {'sma_short': 4166.939904785157, 'sma_long': 4155.905068359375, 'rsi': 57.67270414755591, 'atr': 79.03150472629727, 'volatility': 121.1025508120866}, 'action': 'buy', 'qty': 2010905.0}], 'strategy_params': {'short_window': 20, 'long_window': 50, 'rsi_period': 14, 'overbought': 70, 'oversold': 30, 'context_window': 10, 'commission': 0.002, 'slippage': 0.0, 'position_size': 100, 'initial_cash': 10000}, 'assets': ['TCS.NS']}
[DEBUG] Trade log: [{'entry_index': Timestamp('2015-05-28 00:00:00+0530', tz='Asia/Kolkata'), 'exit_index': Timestamp('2015-07-24 00:00:00+0530', tz='Asia/Kolkata'), 'entry_price': 1116.2579345703125, 'exit_price': 1083.907470703125, 'pnl': -36.750794677734376, 'commission_cost': 4.400330810546875, 'regime': 'trending', 'entry_regime': 'trending', 'exit_regime': 'ranging', 'EntryRegime': 'trending', 'ExitRegime': 'ranging', 'volatility': 20.344639809204683, 'exit_volatility': 14.96908450344755, 'entry_volatility': 20.344639809204683, 'EntryVolatility': 20.344639809204683, 'ExitVolatility': 14.96908450344755, 'volume': 2763608.0, 'exit_volume': 1574972.0, 'entry_volume': 2763608.0, 'volume_entry': 2763608.0, 'volume_exit': 1574972.0, 'EntryVolume': 2763608.0, 'ExitVolume': 1574972.0, 'atr_entry': 21.90367707550908, 'atr_exit': 19.496815017312816, 'EntryATR': 21.90367707550908, 'ExitATR': 19.496815017312816, 'entry_sma_short': 1086.560125732422, 'exit_sma_short': 1103.3007751464843, 'entry_sma_long': 1085.4851016090029, 'exit_sma_long': 1104.4010961914062, 'EntrySMA_Short': 1086.560125732422, 'ExitSMA_Short': 1103.3007751464843, 'EntrySMA_Long': 1085.4851016090029, 'ExitSMA_Long': 1104.4010961914062, 'entry_rsi': 65.84502628853397, 'exit_rsi': 34.948929541277536, 'EntryRSI': 65.84502628853397, 'ExitRSI': 34.948929541277536, 'rationale': 'Sell: short SMA crossed below long SMA at index 2015-07-24 00:00:00+05:30', 'Rationale': 'Sell: short SMA crossed below long SMA at index 2015-07-24 00:00:00+05:30', 'ticker': 'TCS.NS', 'context': [1068.2847900390625, 1083.482421875, 1079.1436767578125, 1099.11181640625, 1096.7149658203125, 1107.1636962890625, 1115.9251708984375, 1108.2451171875, 1093.8155517578125, 1076.74658203125, 1083.907470703125], 'indicators': {'sma_short': 1086.560125732422, 'sma_long': 1085.4851016090029, 'rsi': 65.84502628853397, 'atr': 21.90367707550908, 'volatility': 20.344639809204683}, 'action': 'buy', 'qty': 2763608.0}, {'entry_index': Timestamp('2015-08-17 00:00:00+0530', tz='Asia/Kolkata'), 'exit_index': Timestamp('2015-09-18 00:00:00+0530', tz='Asia/Kolkata'), 'entry_price': 1161.614990234375, 'exit_price': 1103.853759765625, 'pnl': -62.29216796875, 'commission_cost': 4.5309375, 'regime': 'trending', 'entry_regime': 'trending', 'exit_regime': 'ranging', 'EntryRegime': 'trending', 'ExitRegime': 'ranging', 'volatility': 29.72120300591647, 'exit_volatility': 8.036496458440938, 'entry_volatility': 29.72120300591647, 'EntryVolatility': 29.72120300591647, 'ExitVolatility': 8.036496458440938, 'volume': 773644.0, 'exit_volume': 2455294.0, 'entry_volume': 773644.0, 'volume_entry': 773644.0, 'volume_exit': 2455294.0, 'EntryVolume': 773644.0, 'ExitVolume': 2455294.0, 'atr_entry': 20.505525954524714, 'atr_exit': 22.495340504134614, 'EntryATR': 20.505525954524714, 'ExitATR': 22.495340504134614, 'entry_sma_short': 1106.4062438964843, 'exit_sma_short': 1109.9801147460937, 'entry_sma_long': 1105.1430322265626, 'exit_sma_long': 1110.174765625, 'EntrySMA_Short': 1106.4062438964843, 'ExitSMA_Short': 1109.9801147460937, 'EntrySMA_Long': 1105.1430322265626, 'ExitSMA_Long': 1110.174765625, 'entry_rsi': 73.41095421919863, 'exit_rsi': 45.488129459490004, 'EntryRSI': 73.41095421919863, 'ExitRSI': 45.488129459490004, 'rationale': 'Sell: short SMA crossed below long SMA at index 2015-09-18 00:00:00+05:30', 'Rationale': 'Sell: short SMA crossed below long SMA at index 2015-09-18 00:00:00+05:30', 'ticker': 'TCS.NS', 'context': [1127.368896484375, 1102.209228515625, 1098.8778076171875, 1099.1158447265625, 1103.20458984375, 1101.3223876953125, 1104.1776123046875, 1104.026611328125, 1097.796142578125, 1103.4638671875, 1103.853759765625], 'indicators': {'sma_short': 1106.4062438964843, 'sma_long': 1105.1430322265626, 'rsi': 73.41095421919863, 'atr': 20.505525954524714, 'volatility': 29.72120300591647}, 'action': 'buy', 'qty': 773644.0}, {'entry_index': Timestamp('2015-10-13 00:00:00+0530', tz='Asia/Kolkata'), 'exit_index': Timestamp('2015-10-14 00:00:00+0530', tz='Asia/Kolkata'), 'entry_price': 1124.319091796875, 'exit_price': 1074.626708984375, 'pnl': -54.0902744140625, 'commission_cost': 4.3978916015625, 'regime': 'ranging', 'entry_regime': 'ranging', 'exit_regime': 'ranging', 'EntryRegime': 'ranging', 'ExitRegime': 'ranging', 'volatility': 19.142614334220383, 'exit_volatility': 26.900984774612777, 'entry_volatility': 19.142614334220383, 'EntryVolatility': 19.142614334220383, 'ExitVolatility': 26.900984774612777, 'volume': 6179712.0, 'exit_volume': 8337128.0, 'entry_volume': 6179712.0, 'volume_entry': 6179712.0, 'volume_exit': 8337128.0, 'EntryVolume': 6179712.0, 'ExitVolume': 8337128.0, 'atr_entry': 24.97378475822862, 'atr_exit': 25.6677852450535, 'EntryATR': 24.97378475822862, 'ExitATR': 25.6677852450535, 'entry_sma_short': 1122.0949645996093, 'exit_sma_short': 1120.6174194335938, 'entry_sma_long': 1122.078056640625, 'exit_sma_long': 1121.843984375, 'EntrySMA_Short': 1122.0949645996093, 'ExitSMA_Short': 1120.6174194335938, 'EntrySMA_Long': 1122.078056640625, 'ExitSMA_Long': 1121.843984375, 'entry_rsi': 56.876174699754706, 'exit_rsi': 45.057325780488654, 'EntryRSI': 56.876174699754706, 'ExitRSI': 45.057325780488654, 'rationale': 'Sell: short SMA crossed below long SMA at index 2015-10-14 00:00:00+05:30', 'Rationale': 'Sell: short SMA crossed below long SMA at index 2015-10-14 00:00:00+05:30', 'ticker': 'TCS.NS', 'context': [1119.8624267578125, 1119.775634765625, 1144.24365234375, 1173.2540283203125, 1168.21337890625, 1148.2889404296875, 1139.570556640625, 1137.7750244140625, 1121.744873046875, 1124.319091796875, 1074.626708984375], 'indicators': {'sma_short': 1122.0949645996093, 'sma_long': 1122.078056640625, 'rsi': 56.876174699754706, 'atr': 24.97378475822862, 'volatility': 19.142614334220383}, 'action': 'buy', 'qty': 6179712.0}, {'entry_index': Timestamp('2016-03-21 00:00:00+0530', tz='Asia/Kolkata'), 'exit_index': Timestamp('2016-07-14 00:00:00+0530', tz='Asia/Kolkata'), 'entry_price': 1063.2938232421875, 'exit_price': 1107.548095703125, 'pnl': 39.91258862304687, 'commission_cost': 4.341683837890625, 'regime': 'ranging', 'entry_regime': 'ranging', 'exit_regime': 'ranging', 'EntryRegime': 'ranging', 'ExitRegime': 'ranging', 'volatility': 16.118863379677137, 'exit_volatility': 16.44117529346046, 'entry_volatility': 16.118863379677137, 'EntryVolatility': 16.118863379677137, 'ExitVolatility': 16.44117529346046, 'volume': 2336982.0, 'exit_volume': 2699988.0, 'entry_volume': 2336982.0, 'volume_entry': 2336982.0, 'volume_exit': 2699988.0, 'EntryVolume': 2336982.0, 'ExitVolume': 2699988.0, 'atr_entry': 24.32335939262365, 'atr_exit': 22.074454143748536, 'EntryATR': 24.32335939262365, 'ExitATR': 22.074454143748536, 'entry_sma_short': 1007.9480926513672, 'exit_sma_short': 1112.3132080078126, 'entry_sma_long': 1006.7764245605468, 'exit_sma_long': 1113.5601440429687, 'EntrySMA_Short': 1007.9480926513672, 'ExitSMA_Short': 1112.3132080078126, 'EntrySMA_Long': 1006.7764245605468, 'ExitSMA_Long': 1113.5601440429687, 'entry_rsi': 83.55997636854161, 'exit_rsi': 37.46312101500903, 'EntryRSI': 83.55997636854161, 'ExitRSI': 37.46312101500903, 'rationale': 'Buy: short SMA crossed above long SMA at index 2016-03-21 00:00:00+05:30', 'Rationale': 'Buy: short SMA crossed above long SMA at index 2016-03-21 00:00:00+05:30', 'ticker': 'TCS.NS', 'context': [1099.203369140625, 1121.250244140625, 1098.3035888671875, 1095.383056640625, 1091.4744873046875, 1067.100341796875, 1065.695068359375, 1082.1861572265625, 1082.53759765625, 1094.900146484375, 1107.548095703125], 'indicators': {'sma_short': 1007.9480926513672, 'sma_long': 1006.7764245605468, 'rsi': 83.55997636854161, 'atr': 24.32335939262365, 'volatility': 16.118863379677137}, 'action': 'buy', 'qty': 2336982.0}, {'entry_index': Timestamp('2016-08-08 00:00:00+0530', tz='Asia/Kolkata'), 'exit_index': Timestamp('2016-09-12 00:00:00+0530', tz='Asia/Kolkata'), 'entry_price': 1166.6014404296875, 'exit_price': 1038.71337890625, 'pnl': -132.29869116210938, 'commission_cost': 4.4106296386718755, 'regime': 'ranging', 'entry_regime': 'ranging', 'exit_regime': 'ranging', 'EntryRegime': 'ranging', 'ExitRegime': 'ranging', 'volatility': 22.811093014092922, 'exit_volatility': 34.827970973933326, 'entry_volatility': 22.811093014092922, 'EntryVolatility': 22.811093014092922, 'ExitVolatility': 34.827970973933326, 'volume': 2058244.0, 'exit_volume': 2024454.0, 'entry_volume': 2058244.0, 'volume_entry': 2058244.0, 'volume_exit': 2024454.0, 'EntryVolume': 2058244.0, 'ExitVolume': 2024454.0, 'atr_entry': 22.882056499296397, 'atr_exit': 23.487764427607736, 'EntryATR': 22.882056499296397, 'ExitATR': 23.487764427607736, 'entry_sma_short': 1127.7510620117187, 'exit_sma_short': 1114.6680908203125, 'entry_sma_long': 1125.5620581054689, 'exit_sma_long': 1120.1577563476562, 'EntrySMA_Short': 1127.7510620117187, 'ExitSMA_Short': 1114.6680908203125, 'EntrySMA_Long': 1125.5620581054689, 'ExitSMA_Long': 1120.1577563476562, 'entry_rsi': 79.5742282194841, 'exit_rsi': 29.826526387311162, 'EntryRSI': 79.5742282194841, 'ExitRSI': 29.826526387311162, 'rationale': 'Sell: short SMA crossed below long SMA at index 2016-09-12 00:00:00+05:30', 'Rationale': 'Sell: short SMA crossed below long SMA at index 2016-09-12 00:00:00+05:30', 'ticker': 'TCS.NS', 'context': [1111.7606201171875, 1101.017822265625, 1120.21484375, 1105.750732421875, 1104.07763671875, 1107.2918701171875, 1093.751953125, 1074.598876953125, 1022.4437255859375, 1035.807373046875, 1038.71337890625], 'indicators': {'sma_short': 1127.7510620117187, 'sma_long': 1125.5620581054689, 'rsi': 79.5742282194841, 'atr': 22.882056499296397, 'volatility': 22.811093014092922}, 'action': 'buy', 'qty': 2058244.0}, {'entry_index': Timestamp('2017-01-02 00:00:00+0530', tz='Asia/Kolkata'), 'exit_index': Timestamp('2017-04-18 00:00:00+0530', tz='Asia/Kolkata'), 'entry_price': 1042.51611328125, 'exit_price': 1022.223388671875, 'pnl': -24.42220361328125, 'commission_cost': 4.12947900390625, 'regime': 'ranging', 'entry_regime': 'ranging', 'exit_regime': 'ranging', 'EntryRegime': 'ranging', 'ExitRegime': 'ranging', 'volatility': 12.530790767565804, 'exit_volatility': 20.675956984591572, 'entry_volatility': 12.530790767565804, 'EntryVolatility': 12.530790767565804, 'ExitVolatility': 20.675956984591572, 'volume': 823132.0, 'exit_volume': 1730620.0, 'entry_volume': 823132.0, 'volume_entry': 823132.0, 'volume_exit': 1730620.0, 'EntryVolume': 823132.0, 'ExitVolume': 1730620.0, 'atr_entry': 23.674647283152307, 'atr_exit': 20.22264083283411, 'EntryATR': 23.674647283152307, 'ExitATR': 20.22264083283411, 'entry_sma_short': 1002.8934997558594, 'exit_sma_short': 1069.725079345703, 'entry_sma_long': 999.1856970214844, 'exit_sma_long': 1073.886239013672, 'EntrySMA_Short': 1002.8934997558594, 'ExitSMA_Short': 1069.725079345703, 'EntrySMA_Long': 999.1856970214844, 'ExitSMA_Long': 1073.886239013672, 'entry_rsi': 77.59095441443617, 'exit_rsi': 27.19259032791257, 'EntryRSI': 77.59095441443617, 'ExitRSI': 27.19259032791257, 'rationale': 'Sell: short SMA crossed below long SMA at index 2017-04-18 00:00:00+05:30', 'Rationale': 'Sell: short SMA crossed below long SMA at index 2017-04-18 00:00:00+05:30', 'ticker': 'TCS.NS', 'context': [1076.6817626953125, 1067.7823486328125, 1063.1558837890625, 1062.6243896484375, 1075.464111328125, 1072.453857421875, 1071.147705078125, 1059.613525390625, 1031.0120849609375, 1024.902099609375, 1022.223388671875], 'indicators': {'sma_short': 1002.8934997558594, 'sma_long': 999.1856970214844, 'rsi': 77.59095441443617, 'atr': 23.674647283152307, 'volatility': 12.530790767565804}, 'action': 'buy', 'qty': 823132.0}, {'entry_index': Timestamp('2017-05-26 00:00:00+0530', tz='Asia/Kolkata'), 'exit_index': Timestamp('2017-07-05 00:00:00+0530', tz='Asia/Kolkata'), 'entry_price': 1141.5228271484375, 'exit_price': 1054.7835693359375, 'pnl': -91.13187060546875, 'commission_cost': 4.39261279296875, 'regime': 'trending', 'entry_regime': 'trending', 'exit_regime': 'ranging', 'EntryRegime': 'trending', 'ExitRegime': 'ranging', 'volatility': 37.69958038743053, 'exit_volatility': 14.399672945579374, 'entry_volatility': 37.69958038743053, 'EntryVolatility': 37.69958038743053, 'ExitVolatility': 14.399672945579374, 'volume': 1362550.0, 'exit_volume': 815856.0, 'entry_volume': 1362550.0, 'volume_entry': 1362550.0, 'volume_exit': 815856.0, 'EntryVolume': 1362550.0, 'ExitVolume': 815856.0, 'atr_entry': 19.972469347631815, 'atr_exit': 22.641982633423087, 'EntryATR': 19.972469347631815, 'ExitATR': 22.641982633423087, 'entry_sma_short': 1071.3797760009766, 'exit_sma_short': 1080.6648254394531, 'entry_sma_long': 1066.5980932617188, 'exit_sma_long': 1082.3128552246094, 'EntrySMA_Short': 1071.3797760009766, 'ExitSMA_Short': 1080.6648254394531, 'EntrySMA_Long': 1066.5980932617188, 'ExitSMA_Long': 1082.3128552246094, 'entry_rsi': 76.42924465622788, 'exit_rsi': 30.960269115374132, 'EntryRSI': 76.42924465622788, 'ExitRSI': 30.960269115374132, 'rationale': 'Sell: short SMA crossed below long SMA at index 2017-07-05 00:00:00+05:30', 'Rationale': 'Sell: short SMA crossed below long SMA at index 2017-07-05 00:00:00+05:30', 'ticker': 'TCS.NS', 'context': [1094.6290283203125, 1077.302978515625, 1072.177001953125, 1057.33544921875, 1048.8963623046875, 1052.119873046875, 1044.598388671875, 1057.6263427734375, 1062.6627197265625, 1059.641357421875, 1054.7835693359375], 'indicators': {'sma_short': 1071.3797760009766, 'sma_long': 1066.5980932617188, 'rsi': 76.42924465622788, 'atr': 19.972469347631815, 'volatility': 37.69958038743053}, 'action': 'buy', 'qty': 1362550.0}, {'entry_index': Timestamp('2017-08-03 00:00:00+0530', tz='Asia/Kolkata'), 'exit_index': Timestamp('2017-09-20 00:00:00+0530', tz='Asia/Kolkata'), 'entry_price': 1117.66943359375, 'exit_price': 1119.5107421875, 'pnl': -2.6330517578125, 'commission_cost': 4.4743603515625, 'regime': 'ranging', 'entry_regime': 'ranging', 'exit_regime': 'ranging', 'EntryRegime': 'ranging', 'ExitRegime': 'ranging', 'volatility': 17.24492547682601, 'exit_volatility': 8.497332082256023, 'entry_volatility': 17.24492547682601, 'EntryVolatility': 17.24492547682601, 'ExitVolatility': 8.497332082256023, 'volume': 1882548.0, 'exit_volume': 1334642.0, 'entry_volume': 1882548.0, 'volume_entry': 1882548.0, 'volume_exit': 1334642.0, 'EntryVolume': 1882548.0, 'ExitVolume': 1334642.0, 'atr_entry': 23.979718785750137, 'atr_exit': 20.243034224560553, 'EntryATR': 23.979718785750137, 'ExitATR': 20.243034224560553, 'entry_sma_short': 1104.9222290039063, 'exit_sma_short': 1113.9197692871094, 'entry_sma_long': 1101.5046118164062, 'exit_sma_long': 1114.5577807617187, 'EntrySMA_Short': 1104.9222290039063, 'ExitSMA_Short': 1113.9197692871094, 'EntrySMA_Long': 1101.5046118164062, 'ExitSMA_Long': 1114.5577807617187, 'entry_rsi': 64.19437100226554, 'exit_rsi': 49.30570353486992, 'EntryRSI': 64.19437100226554, 'ExitRSI': 49.30570353486992, 'rationale': 'Sell: short SMA crossed below long SMA at index 2017-09-20 00:00:00+05:30', 'Rationale': 'Sell: short SMA crossed below long SMA at index 2017-09-20 00:00:00+05:30', 'ticker': 'TCS.NS', 'context': [1101.3948974609375, 1104.492431640625, 1109.20654296875, 1101.955810546875, 1117.2205810546875, 1117.557373046875, 1116.5472412109375, 1125.122802734375, 1121.9796142578125, 1121.6202392578125, 1119.5107421875], 'indicators': {'sma_short': 1104.9222290039063, 'sma_long': 1101.5046118164062, 'rsi': 64.19437100226554, 'atr': 23.979718785750137, 'volatility': 17.24492547682601}, 'action': 'buy', 'qty': 1882548.0}, {'entry_index': Timestamp('2017-10-16 00:00:00+0530', tz='Asia/Kolkata'), 'exit_index': Timestamp('2017-12-20 00:00:00+0530', tz='Asia/Kolkata'), 'entry_price': 1160.298583984375, 'exit_price': 1165.5057373046875, 'pnl': 0.5555446777343747, 'commission_cost': 4.651608642578125, 'regime': 'ranging', 'entry_regime': 'ranging', 'exit_regime': 'ranging', 'EntryRegime': 'ranging', 'ExitRegime': 'ranging', 'volatility': 25.070780817490167, 'exit_volatility': 15.56132382083433, 'entry_volatility': 25.070780817490167, 'EntryVolatility': 25.070780817490167, 'ExitVolatility': 15.56132382083433, 'volume': 1218590.0, 'exit_volume': 1577570.0, 'entry_volume': 1218590.0, 'volume_entry': 1218590.0, 'volume_exit': 1577570.0, 'EntryVolume': 1218590.0, 'ExitVolume': 1577570.0, 'atr_entry': 18.487825911629443, 'atr_exit': 22.464162956941788, 'EntryATR': 18.487825911629443, 'ExitATR': 22.464162956941788, 'entry_sma_short': 1117.558575439453, 'exit_sma_short': 1182.5294555664063, 'entry_sma_long': 1117.386416015625, 'exit_sma_long': 1185.00658203125, 'EntrySMA_Short': 1117.558575439453, 'ExitSMA_Short': 1182.5294555664063, 'EntrySMA_Long': 1117.386416015625, 'ExitSMA_Long': 1185.00658203125, 'entry_rsi': 62.207836573259094, 'exit_rsi': 42.20111613823214, 'EntryRSI': 62.207836573259094, 'ExitRSI': 42.20111613823214, 'rationale': 'Buy: short SMA crossed above long SMA at index 2017-10-16 00:00:00+05:30', 'Rationale': 'Buy: short SMA crossed above long SMA at index 2017-10-16 00:00:00+05:30', 'ticker': 'TCS.NS', 'context': [1185.471435546875, 1178.2457275390625, 1171.1552734375, 1197.98681640625, 1175.9500732421875, 1183.265625, 1151.4822998046875, 1145.9906005859375, 1161.70166015625, 1159.360595703125, 1165.5057373046875], 'indicators': {'sma_short': 1117.558575439453, 'sma_long': 1117.386416015625, 'rsi': 62.207836573259094, 'atr': 18.487825911629443, 'volatility': 25.070780817490167}, 'action': 'buy', 'qty': 1218590.0}, {'entry_index': Timestamp('2018-01-15 00:00:00+0530', tz='Asia/Kolkata'), 'exit_index': Timestamp('2018-03-22 00:00:00+0530', tz='Asia/Kolkata'), 'entry_price': 1236.2523193359375, 'exit_price': 1277.6527099609375, 'pnl': 36.37258056640625, 'commission_cost': 5.02781005859375, 'regime': 'ranging', 'entry_regime': 'ranging', 'exit_regime': 'ranging', 'EntryRegime': 'ranging', 'ExitRegime': 'ranging', 'volatility': 28.54815844587923, 'exit_volatility': 38.05862519378415, 'entry_volatility': 28.54815844587923, 'EntryVolatility': 28.54815844587923, 'ExitVolatility': 38.05862519378415, 'volume': 1457214.0, 'exit_volume': 2326094.0, 'entry_volume': 1457214.0, 'volume_entry': 1457214.0, 'volume_exit': 2326094.0, 'EntryVolume': 1457214.0, 'ExitVolume': 2326094.0, 'atr_entry': 23.32632129116307, 'atr_exit': 35.3867411018588, 'EntryATR': 23.32632129116307, 'ExitATR': 35.3867411018588, 'entry_sma_short': 1201.75458984375, 'exit_sma_short': 1340.0416870117188, 'entry_sma_long': 1201.3228735351563, 'exit_sma_long': 1342.0076831054687, 'EntrySMA_Short': 1201.75458984375, 'ExitSMA_Short': 1340.0416870117188, 'EntrySMA_Long': 1201.3228735351563, 'ExitSMA_Long': 1342.0076831054687, 'entry_rsi': 61.30272645978805, 'exit_rsi': 30.06466119904684, 'EntryRSI': 61.30272645978805, 'ExitRSI': 30.06466119904684, 'rationale': 'Buy: short SMA crossed above long SMA at index 2018-01-15 00:00:00+05:30', 'Rationale': 'Buy: short SMA crossed above long SMA at index 2018-01-15 00:00:00+05:30', 'ticker': 'TCS.NS', 'context': [1355.538818359375, 1369.14404296875, 1377.289306640625, 1302.6744384765625, 1302.7193603515625, 1294.9581298828125, 1275.103271484375, 1277.4947509765625, 1292.769775390625, 1289.1142578125, 1277.6527099609375], 'indicators': {'sma_short': 1201.75458984375, 'sma_long': 1201.3228735351563, 'rsi': 61.30272645978805, 'atr': 23.32632129116307, 'volatility': 28.54815844587923}, 'action': 'buy', 'qty': 1457214.0}, {'entry_index': Timestamp('2018-04-20 00:00:00+0530', tz='Asia/Kolkata'), 'exit_index': Timestamp('2018-10-24 00:00:00+0530', tz='Asia/Kolkata'), 'entry_price': 1535.3626708984375, 'exit_price': 1689.101318359375, 'pnl': 147.28971948242187, 'commission_cost': 6.448927978515625, 'regime': 'trending', 'entry_regime': 'trending', 'exit_regime': 'trending', 'EntryRegime': 'trending', 'ExitRegime': 'trending', 'volatility': 64.68997203970447, 'exit_volatility': 67.38974352706316, 'entry_volatility': 64.68997203970447, 'EntryVolatility': 64.68997203970447, 'ExitVolatility': 67.38974352706316, 'volume': 8558576.400000006, 'exit_volume': 2735913.0, 'entry_volume': 8558576.400000006, 'volume_entry': 8558576.400000006, 'volume_exit': 2735913.0, 'EntryVolume': 8558576.400000006, 'ExitVolume': 2735913.0, 'atr_entry': 31.597591452476085, 'atr_exit': 41.47564671077476, 'EntryATR': 31.597591452476085, 'ExitATR': 41.47564671077476, 'entry_sma_short': 1355.5286499023437, 'exit_sma_short': 1857.9934997558594, 'entry_sma_long': 1346.411796875, 'exit_sma_long': 1866.0821826171875, 'EntrySMA_Short': 1355.5286499023437, 'ExitSMA_Short': 1857.9934997558594, 'EntrySMA_Long': 1346.411796875, 'ExitSMA_Long': 1866.0821826171875, 'entry_rsi': 89.82520911551711, 'exit_rsi': 19.70449875176196, 'EntryRSI': 89.82520911551711, 'ExitRSI': 19.70449875176196, 'rationale': 'Buy: short SMA crossed above long SMA at index 2018-04-20 00:00:00+05:30', 'Rationale': 'Buy: short SMA crossed above long SMA at index 2018-04-20 00:00:00+05:30', 'ticker': 'TCS.NS', 'context': [1907.403076171875, 1863.451904296875, 1805.41259765625, 1749.197021484375, 1777.6473388671875, 1789.3187255859375, 1759.3192138671875, 1744.5469970703125, 1735.2462158203125, 1684.6688232421875, 1689.101318359375], 'indicators': {'sma_short': 1355.5286499023437, 'sma_long': 1346.411796875, 'rsi': 89.82520911551711, 'atr': 31.597591452476085, 'volatility': 64.68997203970447}, 'action': 'buy', 'qty': 8558576.400000006}, {'entry_index': Timestamp('2018-12-14 00:00:00+0530', tz='Asia/Kolkata'), 'exit_index': Timestamp('2019-01-10 00:00:00+0530', tz='Asia/Kolkata'), 'entry_price': 1818.1710205078125, 'exit_price': 1725.697265625, 'pnl': -99.56149145507813, 'commission_cost': 7.087736572265626, 'regime': 'ranging', 'entry_regime': 'ranging', 'exit_regime': 'ranging', 'EntryRegime': 'ranging', 'ExitRegime': 'ranging', 'volatility': 13.758803755881244, 'exit_volatility': 11.133004690065835, 'entry_volatility': 13.758803755881244, 'EntryVolatility': 13.758803755881244, 'ExitVolatility': 11.133004690065835, 'volume': 2473761.0, 'exit_volume': 3053461.0, 'entry_volume': 2473761.0, 'volume_entry': 2473761.0, 'volume_exit': 3053461.0, 'EntryVolume': 2473761.0, 'ExitVolume': 3053461.0, 'atr_entry': 50.385429460266685, 'atr_exit': 40.192103562664414, 'EntryATR': 50.385429460266685, 'ExitATR': 40.192103562664414, 'entry_sma_short': 1776.9940063476563, 'exit_sma_short': 1756.6466064453125, 'entry_sma_long': 1774.782958984375, 'exit_sma_long': 1760.4689208984375, 'EntrySMA_Short': 1776.9940063476563, 'ExitSMA_Short': 1756.6466064453125, 'EntrySMA_Long': 1774.782958984375, 'ExitSMA_Long': 1760.4689208984375, 'entry_rsi': 71.51423795916783, 'exit_rsi': 37.217041268318376, 'EntryRSI': 71.51423795916783, 'ExitRSI': 37.217041268318376, 'rationale': 'Sell: short SMA crossed below long SMA at index 2019-01-10 00:00:00+05:30', 'Rationale': 'Sell: short SMA crossed below long SMA at index 2019-01-10 00:00:00+05:30', 'ticker': 'TCS.NS', 'context': [1744.337890625, 1732.5509033203125, 1729.809326171875, 1738.718505859375, 1757.45068359375, 1736.114013671875, 1715.006103515625, 1734.2412109375, 1730.2659912109375, 1724.2349853515625, 1725.697265625], 'indicators': {'sma_short': 1776.9940063476563, 'sma_long': 1774.782958984375, 'rsi': 71.51423795916783, 'atr': 50.385429460266685, 'volatility': 13.758803755881244}, 'action': 'buy', 'qty': 2473761.0}, {'entry_index': Timestamp('2019-02-07 00:00:00+0530', tz='Asia/Kolkata'), 'exit_index': Timestamp('2019-07-23 00:00:00+0530', tz='Asia/Kolkata'), 'entry_price': 1907.3680419921875, 'exit_price': 1954.63671875, 'pnl': 39.544667236328124, 'commission_cost': 7.724009521484375, 'regime': 'trending', 'entry_regime': 'trending', 'exit_regime': 'ranging', 'EntryRegime': 'trending', 'ExitRegime': 'ranging', 'volatility': 55.380696588194034, 'exit_volatility': 19.457800629609387, 'entry_volatility': 55.380696588194034, 'EntryVolatility': 55.380696588194034, 'ExitVolatility': 19.457800629609387, 'volume': 1339945.0, 'exit_volume': 3538588.0, 'entry_volume': 1339945.0, 'volume_entry': 1339945.0, 'volume_exit': 3538588.0, 'EntryVolume': 1339945.0, 'ExitVolume': 3538588.0, 'atr_entry': 35.061515957989656, 'atr_exit': 42.56218603898725, 'EntryATR': 35.061515957989656, 'ExitATR': 42.56218603898725, 'entry_sma_short': 1780.957861328125, 'exit_sma_short': 1996.7326782226562, 'entry_sma_long': 1778.8915698242188, 'exit_sma_long': 1999.0076220703124, 'EntrySMA_Short': 1780.957861328125, 'ExitSMA_Short': 1996.7326782226562, 'EntrySMA_Long': 1778.8915698242188, 'ExitSMA_Long': 1999.0076220703124, 'entry_rsi': 84.70768568379302, 'exit_rsi': 33.15290076443344, 'EntryRSI': 84.70768568379302, 'ExitRSI': 33.15290076443344, 'rationale': 'Buy: short SMA crossed above long SMA at index 2019-02-07 00:00:00+05:30', 'Rationale': 'Buy: short SMA crossed above long SMA at index 2019-02-07 00:00:00+05:30', 'ticker': 'TCS.NS', 'context': [1969.375244140625, 1946.1583251953125, 1940.94287109375, 1945.604736328125, 1980.7760009765625, 1948.6688232421875, 1959.0775146484375, 1911.6102294921875, 1921.788818359375, 1952.2763671875, 1954.63671875], 'indicators': {'sma_short': 1780.957861328125, 'sma_long': 1778.8915698242188, 'rsi': 84.70768568379302, 'atr': 35.061515957989656, 'volatility': 55.380696588194034}, 'action': 'buy', 'qty': 1339945.0}, {'entry_index': Timestamp('2019-08-23 00:00:00+0530', tz='Asia/Kolkata'), 'exit_index': Timestamp('2019-09-25 00:00:00+0530', tz='Asia/Kolkata'), 'entry_price': 2079.781982421875, 'exit_price': 1932.4293212890625, 'pnl': -155.37708374023438, 'commission_cost': 8.024422607421876, 'regime': 'ranging', 'entry_regime': 'ranging', 'exit_regime': 'ranging', 'EntryRegime': 'ranging', 'ExitRegime': 'ranging', 'volatility': 30.01268203463836, 'exit_volatility': 42.890237956883496, 'entry_volatility': 30.01268203463836, 'EntryVolatility': 30.01268203463836, 'ExitVolatility': 42.890237956883496, 'volume': 2826425.0, 'exit_volume': 4002232.0, 'entry_volume': 2826425.0, 'volume_entry': 2826425.0, 'volume_exit': 4002232.0, 'EntryVolume': 2826425.0, 'ExitVolume': 4002232.0, 'atr_entry': 41.128940479160136, 'atr_exit': 43.6184748197578, 'EntryATR': 41.128940479160136, 'ExitATR': 43.6184748197578, 'entry_sma_short': 2030.4203552246095, 'exit_sma_short': 1999.4924621582031, 'entry_sma_long': 2025.1902075195312, 'exit_sma_long': 2004.3819580078125, 'EntrySMA_Short': 2030.4203552246095, 'ExitSMA_Short': 1999.4924621582031, 'EntrySMA_Long': 2025.1902075195312, 'ExitSMA_Long': 2004.3819580078125, 'entry_rsi': 59.973385116048206, 'exit_rsi': 28.608345946941213, 'EntryRSI': 59.973385116048206, 'ExitRSI': 28.608345946941213, 'rationale': 'Sell: short SMA crossed below long SMA at index 2019-09-25 00:00:00+05:30', 'Rationale': 'Sell: short SMA crossed below long SMA at index 2019-09-25 00:00:00+05:30', 'ticker': 'TCS.NS', 'context': [1993.08251953125, 1974.206787109375, 1981.9322509765625, 1989.3812255859375, 1964.0743408203125, 1978.7869873046875, 1944.9207763671875, 1911.1478271484375, 1865.20703125, 1891.94775390625, 1932.4293212890625], 'indicators': {'sma_short': 2030.4203552246095, 'sma_long': 2025.1902075195312, 'rsi': 59.973385116048206, 'atr': 41.128940479160136, 'volatility': 30.01268203463836}, 'action': 'buy', 'qty': 2826425.0}, {'entry_index': Timestamp('2019-11-11 00:00:00+0530', tz='Asia/Kolkata'), 'exit_index': Timestamp('2019-12-09 00:00:00+0530', tz='Asia/Kolkata'), 'entry_price': 1948.75732421875, 'exit_price': 1911.1910400390625, 'pnl': -45.28618090820312, 'commission_cost': 7.719896728515625, 'regime': 'ranging', 'entry_regime': 'ranging', 'exit_regime': 'ranging', 'EntryRegime': 'ranging', 'ExitRegime': 'ranging', 'volatility': 48.54074398505094, 'exit_volatility': 28.864382925161543, 'entry_volatility': 48.54074398505094, 'EntryVolatility': 48.54074398505094, 'ExitVolatility': 28.864382925161543, 'volume': 2983768.0, 'exit_volume': 2244747.0, 'entry_volume': 2983768.0, 'volume_entry': 2983768.0, 'volume_exit': 2244747.0, 'EntryVolume': 2983768.0, 'ExitVolume': 2244747.0, 'atr_entry': 45.04804706016177, 'atr_exit': 44.45522714856272, 'EntryATR': 45.04804706016177, 'ExitATR': 44.45522714856272, 'entry_sma_short': 1972.9657348632813, 'exit_sma_short': 1946.925244140625, 'entry_sma_long': 1968.3851245117187, 'exit_sma_long': 1947.0316772460938, 'EntrySMA_Short': 1972.9657348632813, 'ExitSMA_Short': 1946.925244140625, 'EntrySMA_Long': 1968.3851245117187, 'ExitSMA_Long': 1947.0316772460938, 'entry_rsi': 55.88137343786221, 'exit_rsi': 43.16217506972928, 'EntryRSI': 55.88137343786221, 'ExitRSI': 43.16217506972928, 'rationale': 'Sell: short SMA crossed below long SMA at index 2019-12-09 00:00:00+05:30', 'Rationale': 'Sell: short SMA crossed below long SMA at index 2019-12-09 00:00:00+05:30', 'ticker': 'TCS.NS', 'context': [1930.7159423828125, 1898.3909912109375, 1905.486572265625, 1926.8665771484375, 1904.5123291015625, 1874.64501953125, 1902.4259033203125, 1927.933349609375, 1967.63330078125, 1969.7666015625, 1911.1910400390625], 'indicators': {'sma_short': 1972.9657348632813, 'sma_long': 1968.3851245117187, 'rsi': 55.88137343786221, 'atr': 45.04804706016177, 'volatility': 48.54074398505094}, 'action': 'buy', 'qty': 2983768.0}, {'entry_index': Timestamp('2019-12-31 00:00:00+0530', tz='Asia/Kolkata'), 'exit_index': Timestamp('2020-02-13 00:00:00+0530', tz='Asia/Kolkata'), 'entry_price': 2005.106201171875, 'exit_price': 2037.781982421875, 'pnl': 24.5900048828125, 'commission_cost': 8.085776367187501, 'regime': 'ranging', 'entry_regime': 'ranging', 'exit_regime': 'ranging', 'EntryRegime': 'ranging', 'ExitRegime': 'ranging', 'volatility': 30.998875047161544, 'exit_volatility': 30.28562958273886, 'entry_volatility': 30.998875047161544, 'EntryVolatility': 30.998875047161544, 'ExitVolatility': 30.28562958273886, 'volume': 1909289.0, 'exit_volume': 1645948.0, 'entry_volume': 1909289.0, 'volume_entry': 1909289.0, 'volume_exit': 1645948.0, 'EntryVolume': 1909289.0, 'ExitVolume': 1645948.0, 'atr_entry': 46.01159689321325, 'atr_exit': 42.962248236659576, 'EntryATR': 46.01159689321325, 'ExitATR': 42.962248236659576, 'entry_sma_short': 1979.6820007324218, 'exit_sma_short': 2005.5753479003906, 'entry_sma_long': 1976.6256787109376, 'exit_sma_long': 2008.6999560546874, 'EntrySMA_Short': 1979.6820007324218, 'ExitSMA_Short': 2005.5753479003906, 'EntrySMA_Long': 1976.6256787109376, 'ExitSMA_Long': 2008.6999560546874, 'entry_rsi': 71.688715625006, 'exit_rsi': 51.4262672881713, 'EntryRSI': 71.688715625006, 'ExitRSI': 51.4262672881713, 'rationale': 'Buy: short SMA crossed above long SMA at index 2019-12-31 00:00:00+05:30', 'Rationale': 'Buy: short SMA crossed above long SMA at index 2019-12-31 00:00:00+05:30', 'ticker': 'TCS.NS', 'context': [1987.487060546875, 1932.8223876953125, 1954.6231689453125, 1959.504150390625, 1995.5745849609375, 1978.6551513671875, 1986.2786865234375, 2009.8922119140625, 2001.943115234375, 2018.0726318359375, 2037.781982421875], 'indicators': {'sma_short': 1979.6820007324218, 'sma_long': 1976.6256787109376, 'rsi': 71.688715625006, 'atr': 46.01159689321325, 'volatility': 30.998875047161544}, 'action': 'buy', 'qty': 1909289.0}, {'entry_index': Timestamp('2020-05-12 00:00:00+0530', tz='Asia/Kolkata'), 'exit_index': Timestamp('2021-03-02 00:00:00+0530', tz='Asia/Kolkata'), 'entry_price': 1825.62646484375, 'exit_price': 2847.40673828125, 'pnl': 1012.43420703125, 'commission_cost': 9.34606640625, 'regime': 'ranging', 'entry_regime': 'ranging', 'exit_regime': 'ranging', 'EntryRegime': 'ranging', 'ExitRegime': 'ranging', 'volatility': 44.45770449619443, 'exit_volatility': 65.20471491332768, 'entry_volatility': 44.45770449619443, 'EntryVolatility': 44.45770449619443, 'ExitVolatility': 65.20471491332768, 'volume': 3256595.0, 'exit_volume': 3306469.0, 'entry_volume': 3256595.0, 'volume_entry': 3256595.0, 'volume_exit': 3306469.0, 'EntryVolume': 3256595.0, 'ExitVolume': 3306469.0, 'atr_entry': 92.27967128874559, 'atr_exit': 72.90029215243368, 'EntryATR': 92.27967128874559, 'ExitATR': 72.90029215243368, 'entry_sma_short': 1736.7400512695312, 'exit_sma_short': 2922.1538818359377, 'entry_sma_long': 1732.641044921875, 'exit_sma_long': 2928.202958984375, 'EntrySMA_Short': 1736.7400512695312, 'ExitSMA_Short': 2922.1538818359377, 'EntrySMA_Long': 1732.641044921875, 'ExitSMA_Long': 2928.202958984375, 'entry_rsi': 68.21741591610947, 'exit_rsi': 32.6949903953263, 'EntryRSI': 68.21741591610947, 'ExitRSI': 32.6949903953263, 'rationale': 'Buy: short SMA crossed above long SMA at index 2020-05-12 00:00:00+05:30', 'Rationale': 'Buy: short SMA crossed above long SMA at index 2020-05-12 00:00:00+05:30', 'ticker': 'TCS.NS', 'context': [2944.43994140625, 2910.626953125, 2895.710693359375, 2909.443115234375, 2802.038818359375, 2822.638916015625, 2792.236083984375, 2836.940185546875, 2741.280517578125, 2769.599365234375, 2847.40673828125], 'indicators': {'sma_short': 1736.7400512695312, 'sma_long': 1732.641044921875, 'rsi': 68.21741591610947, 'atr': 92.27967128874559, 'volatility': 44.45770449619443}, 'action': 'buy', 'qty': 3256595.0}, {'entry_index': Timestamp('2021-04-07 00:00:00+0530', tz='Asia/Kolkata'), 'exit_index': Timestamp('2021-05-17 00:00:00+0530', tz='Asia/Kolkata'), 'entry_price': 3098.44287109375, 'exit_price': 2907.45458984375, 'pnl': -203.000076171875, 'commission_cost': 12.011794921875, 'regime': 'ranging', 'entry_regime': 'ranging', 'exit_regime': 'ranging', 'EntryRegime': 'ranging', 'ExitRegime': 'ranging', 'volatility': 67.14859585359592, 'exit_volatility': 37.31778591246115, 'entry_volatility': 67.14859585359592, 'EntryVolatility': 67.14859585359592, 'ExitVolatility': 37.31778591246115, 'volume': 2491268.0, 'exit_volume': 2890462.0, 'entry_volume': 2491268.0, 'volume_entry': 2491268.0, 'volume_exit': 2890462.0, 'EntryVolume': 2491268.0, 'ExitVolume': 2890462.0, 'atr_entry': 74.45298367857532, 'atr_exit': 67.52475255904574, 'EntryATR': 74.45298367857532, 'ExitATR': 67.52475255904574, 'entry_sma_short': 2953.34521484375, 'exit_sma_short': 2942.798962402344, 'entry_sma_long': 2949.221904296875, 'exit_sma_long': 2950.5383984375, 'EntrySMA_Short': 2953.34521484375, 'ExitSMA_Short': 2942.798962402344, 'EntrySMA_Long': 2949.221904296875, 'ExitSMA_Long': 2950.5383984375, 'entry_rsi': 66.28307101280075, 'exit_rsi': 45.55992725144182, 'EntryRSI': 66.28307101280075, 'ExitRSI': 45.55992725144182, 'rationale': 'Sell: short SMA crossed below long SMA at index 2021-05-17 00:00:00+05:30', 'Rationale': 'Sell: short SMA crossed below long SMA at index 2021-05-17 00:00:00+05:30', 'ticker': 'TCS.NS', 'context': [2875.1572265625, 2876.436279296875, 2888.51171875, 2932.032470703125, 2946.949462890625, 2967.265380859375, 2979.199951171875, 2957.510498046875, 2924.360595703125, 2890.169189453125, 2907.45458984375], 'indicators': {'sma_short': 2953.34521484375, 'sma_long': 2949.221904296875, 'rsi': 66.28307101280075, 'atr': 74.45298367857532, 'volatility': 67.14859585359592}, 'action': 'buy', 'qty': 2491268.0}, {'entry_index': Timestamp('2021-06-11 00:00:00+0530', tz='Asia/Kolkata'), 'exit_index': Timestamp('2021-07-30 00:00:00+0530', tz='Asia/Kolkata'), 'entry_price': 3115.8837890625, 'exit_price': 3021.24267578125, 'pnl': -106.9153662109375, 'commission_cost': 12.274252929687501, 'regime': 'ranging', 'entry_regime': 'ranging', 'exit_regime': 'ranging', 'EntryRegime': 'ranging', 'ExitRegime': 'ranging', 'volatility': 41.18331996931355, 'exit_volatility': 13.367823766267437, 'entry_volatility': 41.18331996931355, 'EntryVolatility': 41.18331996931355, 'ExitVolatility': 13.367823766267437, 'volume': 3452954.0, 'exit_volume': 2999943.0, 'entry_volume': 3452954.0, 'volume_entry': 3452954.0, 'volume_exit': 2999943.0, 'EntryVolume': 3452954.0, 'ExitVolume': 2999943.0, 'atr_entry': 57.76879797213847, 'atr_exit': 48.310584024513794, 'EntryATR': 57.76879797213847, 'ExitATR': 48.310584024513794, 'entry_sma_short': 2987.0900146484373, 'exit_sma_short': 3068.5420166015624, 'entry_sma_long': 2985.9955224609375, 'exit_sma_long': 3072.1698193359375, 'EntrySMA_Short': 2987.0900146484373, 'ExitSMA_Short': 3068.5420166015624, 'EntrySMA_Long': 2985.9955224609375, 'ExitSMA_Long': 3072.1698193359375, 'entry_rsi': 80.5303636474911, 'exit_rsi': 40.676363245116555, 'EntryRSI': 80.5303636474911, 'ExitRSI': 40.676363245116555, 'rationale': 'Sell: short SMA crossed below long SMA at index 2021-07-30 00:00:00+05:30', 'Rationale': 'Sell: short SMA crossed below long SMA at index 2021-07-30 00:00:00+05:30', 'ticker': 'TCS.NS', 'context': [3055.10400390625, 3047.330810546875, 3037.600830078125, 3057.822265625, 3067.8857421875, 3064.547119140625, 3049.953857421875, 3036.027099609375, 3050.19189453125, 3048.284423828125, 3021.24267578125], 'indicators': {'sma_short': 2987.0900146484373, 'sma_long': 2985.9955224609375, 'rsi': 80.5303636474911, 'atr': 57.76879797213847, 'volatility': 41.18331996931355}, 'action': 'buy', 'qty': 3452954.0}, {'entry_index': Timestamp('2021-08-16 00:00:00+0530', tz='Asia/Kolkata'), 'exit_index': Timestamp('2021-10-25 00:00:00+0530', tz='Asia/Kolkata'), 'entry_price': 3312.640869140625, 'exit_price': 3338.1103515625, 'pnl': 12.16797998046875, 'commission_cost': 13.30150244140625, 'regime': 'trending', 'entry_regime': 'trending', 'exit_regime': 'ranging', 'EntryRegime': 'trending', 'ExitRegime': 'ranging', 'volatility': 73.15600951783601, 'exit_volatility': 112.42891950059735, 'entry_volatility': 73.15600951783601, 'EntryVolatility': 73.15600951783601, 'ExitVolatility': 112.42891950059735, 'volume': 2083489.0, 'exit_volume': 2595594.0, 'entry_volume': 2083489.0, 'volume_entry': 2083489.0, 'volume_exit': 2595594.0, 'EntryVolume': 2083489.0, 'ExitVolume': 2595594.0, 'atr_entry': 50.40535237468853, 'atr_exit': 77.03893444146293, 'EntryATR': 50.40535237468853, 'ExitATR': 77.03893444146293, 'entry_sma_short': 3120.1106567382812, 'exit_sma_short': 3540.054235839844, 'entry_sma_long': 3115.688271484375, 'exit_sma_long': 3554.2244677734375, 'EntrySMA_Short': 3120.1106567382812, 'ExitSMA_Short': 3540.054235839844, 'EntrySMA_Long': 3115.688271484375, 'ExitSMA_Long': 3554.2244677734375, 'entry_rsi': 88.91574078017644, 'exit_rsi': 30.980367041678235, 'EntryRSI': 88.91574078017644, 'ExitRSI': 30.980367041678235, 'rationale': 'Buy: short SMA crossed above long SMA at index 2021-08-16 00:00:00+05:30', 'Rationale': 'Buy: short SMA crossed above long SMA at index 2021-08-16 00:00:00+05:30', 'ticker': 'TCS.NS', 'context': [3753.98291015625, 3515.4755859375, 3484.237060546875, 3486.47802734375, 3451.35791015625, 3485.47509765625, 3473.051025390625, 3448.873046875, 3375.907958984375, 3343.7490234375, 3338.1103515625], 'indicators': {'sma_short': 3120.1106567382812, 'sma_long': 3115.688271484375, 'rsi': 88.91574078017644, 'atr': 50.40535237468853, 'volatility': 73.15600951783601}, 'action': 'buy', 'qty': 2083489.0}, {'entry_index': Timestamp('2021-12-20 00:00:00+0530', tz='Asia/Kolkata'), 'exit_index': Timestamp('2022-02-22 00:00:00+0530', tz='Asia/Kolkata'), 'entry_price': 3399.225341796875, 'exit_price': 3433.440673828125, 'pnl': 20.549999999999997, 'commission_cost': 13.665332031250001, 'regime': 'ranging', 'entry_regime': 'ranging', 'exit_regime': 'ranging', 'EntryRegime': 'ranging', 'ExitRegime': 'ranging', 'volatility': 29.699406136453703, 'exit_volatility': 62.88385506011072, 'entry_volatility': 29.699406136453703, 'EntryVolatility': 29.699406136453703, 'ExitVolatility': 62.88385506011072, 'volume': 2312310.0, 'exit_volume': 5408531.0, 'entry_volume': 2312310.0, 'volume_entry': 2312310.0, 'volume_exit': 5408531.0, 'EntryVolume': 2312310.0, 'ExitVolume': 5408531.0, 'atr_entry': 66.38589311772309, 'atr_exit': 71.5409834641629, 'EntryATR': 66.38589311772309, 'ExitATR': 71.5409834641629, 'entry_sma_short': 3402.4559692382813, 'exit_sma_short': 3596.7, 'entry_sma_long': 3399.1990625, 'exit_sma_long': 3602.088857421875, 'EntrySMA_Short': 3402.4559692382813, 'ExitSMA_Short': 3596.7, 'EntrySMA_Long': 3399.1990625, 'ExitSMA_Long': 3602.088857421875, 'entry_rsi': 52.73584801113037, 'exit_rsi': 27.085050741422123, 'EntryRSI': 52.73584801113037, 'ExitRSI': 27.085050741422123, 'rationale': 'Buy: short SMA crossed above long SMA at index 2021-12-20 00:00:00+05:30', 'Rationale': 'Buy: short SMA crossed above long SMA at index 2021-12-20 00:00:00+05:30', 'ticker': 'TCS.NS', 'context': [3583.792724609375, 3600.163330078125, 3609.545166015625, 3537.361083984375, 3574.506103515625, 3654.971923828125, 3650.471923828125, 3622.804931640625, 3632.090576171875, 3560.76806640625, 3433.440673828125], 'indicators': {'sma_short': 3402.4559692382813, 'sma_long': 3399.1990625, 'rsi': 52.73584801113037, 'atr': 66.38589311772309, 'volatility': 29.699406136453703}, 'action': 'buy', 'qty': 2312310.0}, {'entry_index': Timestamp('2022-04-06 00:00:00+0530', tz='Asia/Kolkata'), 'exit_index': Timestamp('2022-04-29 00:00:00+0530', tz='Asia/Kolkata'), 'entry_price': 3595.1845703125, 'exit_price': 3395.433837890625, 'pnl': -213.73196923828124, 'commission_cost': 13.98123681640625, 'regime': 'ranging', 'entry_regime': 'ranging', 'exit_regime': 'ranging', 'EntryRegime': 'ranging', 'ExitRegime': 'ranging', 'volatility': 32.210665100125425, 'exit_volatility': 49.81421720666413, 'entry_volatility': 32.210665100125425, 'EntryVolatility': 32.210665100125425, 'ExitVolatility': 49.81421720666413, 'volume': 2051729.0, 'exit_volume': 2051115.0, 'entry_volume': 2051729.0, 'volume_entry': 2051729.0, 'volume_exit': 2051115.0, 'EntryVolume': 2051729.0, 'ExitVolume': 2051115.0, 'atr_entry': 73.34448232406695, 'atr_exit': 74.4885086285055, 'EntryATR': 73.34448232406695, 'ExitATR': 74.4885086285055, 'entry_sma_short': 3537.3801147460936, 'exit_sma_short': 3486.817626953125, 'entry_sma_long': 3533.570859375, 'exit_sma_long': 3487.7846044921876, 'EntrySMA_Short': 3537.3801147460936, 'ExitSMA_Short': 3486.817626953125, 'EntrySMA_Long': 3533.570859375, 'ExitSMA_Long': 3487.7846044921876, 'entry_rsi': 62.43280242654096, 'exit_rsi': 37.53740630215552, 'EntryRSI': 62.43280242654096, 'ExitRSI': 37.53740630215552, 'rationale': 'Sell: short SMA crossed below long SMA at index 2022-04-29 00:00:00+05:30', 'Rationale': 'Sell: short SMA crossed below long SMA at index 2022-04-29 00:00:00+05:30', 'ticker': 'TCS.NS', 'context': [3505.768310546875, 3377.579345703125, 3323.82373046875, 3405.102783203125, 3473.888671875, 3458.4755859375, 3396.8701171875, 3395.051025390625, 3409.3154296875, 3431.429931640625, 3395.433837890625], 'indicators': {'sma_short': 3537.3801147460936, 'sma_long': 3533.570859375, 'rsi': 62.43280242654096, 'atr': 73.34448232406695, 'volatility': 32.210665100125425}, 'action': 'buy', 'qty': 2051729.0}, {'entry_index': Timestamp('2022-08-12 00:00:00+0530', tz='Asia/Kolkata'), 'exit_index': Timestamp('2022-09-15 00:00:00+0530', tz='Asia/Kolkata'), 'entry_price': 3287.064208984375, 'exit_price': 2999.866943359375, 'pnl': -299.7711279296875, 'commission_cost': 12.5738623046875, 'regime': 'trending', 'entry_regime': 'trending', 'exit_regime': 'ranging', 'EntryRegime': 'trending', 'ExitRegime': 'ranging', 'volatility': 47.90023527071091, 'exit_volatility': 46.694623049524694, 'entry_volatility': 47.90023527071091, 'EntryVolatility': 47.90023527071091, 'ExitVolatility': 46.694623049524694, 'volume': 1472354.0, 'exit_volume': 2138023.0, 'entry_volume': 1472354.0, 'volume_entry': 1472354.0, 'volume_exit': 2138023.0, 'EntryVolume': 1472354.0, 'ExitVolume': 2138023.0, 'atr_entry': 69.46224829311399, 'atr_exit': 60.24547618296845, 'EntryATR': 69.46224829311399, 'ExitATR': 60.24547618296845, 'entry_sma_short': 3134.9230102539063, 'exit_sma_short': 3102.0625122070314, 'entry_sma_long': 3132.5360107421875, 'exit_sma_long': 3113.2832373046876, 'EntrySMA_Short': 3134.9230102539063, 'ExitSMA_Short': 3102.0625122070314, 'EntrySMA_Long': 3132.5360107421875, 'ExitSMA_Long': 3113.2832373046876, 'entry_rsi': 76.0068146945699, 'exit_rsi': 38.98615772509217, 'EntryRSI': 76.0068146945699, 'ExitRSI': 38.98615772509217, 'rationale': 'Sell: short SMA crossed below long SMA at index 2022-09-15 00:00:00+05:30', 'Rationale': 'Sell: short SMA crossed below long SMA at index 2022-09-15 00:00:00+05:30', 'ticker': 'TCS.NS', 'context': [3026.29638671875, 3025.0400390625, 3027.939208984375, 3021.80322265625, 3043.59375, 3062.96923828125, 3109.35302734375, 3133.80224609375, 3120.659423828125, 3015.376220703125, 2999.866943359375], 'indicators': {'sma_short': 3134.9230102539063, 'sma_long': 3132.5360107421875, 'rsi': 76.0068146945699, 'atr': 69.46224829311399, 'volatility': 47.90023527071091}, 'action': 'buy', 'qty': 1472354.0}, {'entry_index': Timestamp('2022-11-02 00:00:00+0530', tz='Asia/Kolkata'), 'exit_index': Timestamp('2023-01-02 00:00:00+0530', tz='Asia/Kolkata'), 'entry_price': 3140.701416015625, 'exit_price': 3159.836181640625, 'pnl': 6.5336904296875, 'commission_cost': 12.6010751953125, 'regime': 'ranging', 'entry_regime': 'ranging', 'exit_regime': 'ranging', 'EntryRegime': 'ranging', 'ExitRegime': 'ranging', 'volatility': 41.28437583879449, 'exit_volatility': 19.16248878088338, 'entry_volatility': 41.28437583879449, 'EntryVolatility': 41.28437583879449, 'ExitVolatility': 19.16248878088338, 'volume': 1405955.0, 'exit_volume': 709547.0, 'entry_volume': 1405955.0, 'volume_entry': 1405955.0, 'volume_exit': 709547.0, 'EntryVolume': 1405955.0, 'ExitVolume': 709547.0, 'atr_entry': 58.008347366658384, 'atr_exit': 51.64712527112506, 'EntryATR': 58.008347366658384, 'ExitATR': 51.64712527112506, 'entry_sma_short': 3037.2004638671874, 'exit_sma_short': 3182.5312255859376, 'entry_sma_long': 3022.67310546875, 'exit_sma_long': 3187.22431640625, 'EntrySMA_Short': 3037.2004638671874, 'ExitSMA_Short': 3182.5312255859376, 'EntrySMA_Long': 3022.67310546875, 'ExitSMA_Long': 3187.22431640625, 'entry_rsi': 75.84824473946581, 'exit_rsi': 40.328483897652, 'EntryRSI': 75.84824473946581, 'ExitRSI': 40.328483897652, 'rationale': 'Buy: short SMA crossed above long SMA at index 2022-11-02 00:00:00+05:30', 'Rationale': 'Buy: short SMA crossed above long SMA at index 2022-11-02 00:00:00+05:30', 'ticker': 'TCS.NS', 'context': [3102.28662109375, 3142.881103515625, 3166.71484375, 3158.140380859375, 3127.767578125, 3151.552490234375, 3157.94677734375, 3155.62158203125, 3166.908447265625, 3155.234130859375, 3159.836181640625], 'indicators': {'sma_short': 3037.2004638671874, 'sma_long': 3022.67310546875, 'rsi': 75.84824473946581, 'atr': 58.008347366658384, 'volatility': 41.28437583879449}, 'action': 'buy', 'qty': 1405955.0}, {'entry_index': Timestamp('2023-01-25 00:00:00+0530', tz='Asia/Kolkata'), 'exit_index': Timestamp('2023-03-15 00:00:00+0530', tz='Asia/Kolkata'), 'entry_price': 3330.788818359375, 'exit_price': 3106.599365234375, 'pnl': -237.0642294921875, 'commission_cost': 12.8747763671875, 'regime': 'ranging', 'entry_regime': 'ranging', 'exit_regime': 'ranging', 'EntryRegime': 'ranging', 'ExitRegime': 'ranging', 'volatility': 38.55979038609464, 'exit_volatility': 61.39422761490684, 'entry_volatility': 38.55979038609464, 'EntryVolatility': 38.55979038609464, 'ExitVolatility': 61.39422761490684, 'volume': 874110.0, 'exit_volume': 1780522.0, 'entry_volume': 874110.0, 'volume_entry': 874110.0, 'volume_exit': 1780522.0, 'EntryVolume': 874110.0, 'ExitVolume': 1780522.0, 'atr_entry': 55.24870187498369, 'atr_exit': 60.21204107209431, 'EntryATR': 55.24870187498369, 'ExitATR': 60.21204107209431, 'entry_sma_short': 3234.1728271484376, 'exit_sma_short': 3280.2333374023438, 'entry_sma_long': 3227.5533447265625, 'exit_sma_long': 3291.4743115234373, 'EntrySMA_Short': 3234.1728271484376, 'ExitSMA_Short': 3280.2333374023438, 'EntrySMA_Long': 3227.5533447265625, 'ExitSMA_Long': 3291.4743115234373, 'entry_rsi': 62.071291660569365, 'exit_rsi': 30.161492762111962, 'EntryRSI': 62.071291660569365, 'ExitRSI': 30.161492762111962, 'rationale': 'Sell: short SMA crossed below long SMA at index 2023-03-15 00:00:00+05:30', 'Rationale': 'Sell: short SMA crossed below long SMA at index 2023-03-15 00:00:00+05:30', 'ticker': 'TCS.NS', 'context': [3217.261962890625, 3288.009765625, 3225.613525390625, 3245.71630859375, 3274.559326171875, 3292.573974609375, 3240.5693359375, 3234.887939453125, 3187.253173828125, 3122.186767578125, 3106.599365234375], 'indicators': {'sma_short': 3234.1728271484376, 'sma_long': 3227.5533447265625, 'rsi': 62.071291660569365, 'atr': 55.24870187498369, 'volatility': 38.55979038609464}, 'action': 'buy', 'qty': 874110.0}, {'entry_index': Timestamp('2023-05-18 00:00:00+0530', tz='Asia/Kolkata'), 'exit_index': Timestamp('2023-07-03 00:00:00+0530', tz='Asia/Kolkata'), 'entry_price': 3107.522216796875, 'exit_price': 3201.515869140625, 'pnl': 81.375576171875, 'commission_cost': 12.618076171875, 'regime': 'ranging', 'entry_regime': 'ranging', 'exit_regime': 'ranging', 'EntryRegime': 'ranging', 'ExitRegime': 'ranging', 'volatility': 30.133503520741414, 'exit_volatility': 37.034165375510774, 'entry_volatility': 30.133503520741414, 'EntryVolatility': 30.133503520741414, 'ExitVolatility': 37.034165375510774, 'volume': 1369364.0, 'exit_volume': 1687264.0, 'entry_volume': 1369364.0, 'volume_entry': 1369364.0, 'volume_exit': 1687264.0, 'EntryVolume': 1369364.0, 'ExitVolume': 1687264.0, 'atr_entry': 52.75655551755595, 'atr_exit': 42.887854835139386, 'EntryATR': 52.75655551755595, 'ExitATR': 42.887854835139386, 'entry_sma_short': 3125.69970703125, 'exit_sma_short': 3155.7790771484374, 'entry_sma_long': 3120.51716796875, 'exit_sma_long': 3157.339384765625, 'EntrySMA_Short': 3125.69970703125, 'ExitSMA_Short': 3155.7790771484374, 'EntrySMA_Long': 3120.51716796875, 'ExitSMA_Long': 3157.339384765625, 'entry_rsi': 52.19557582380476, 'exit_rsi': 56.913993916417844, 'EntryRSI': 52.19557582380476, 'ExitRSI': 56.913993916417844, 'rationale': 'Buy: short SMA crossed above long SMA at index 2023-05-18 00:00:00+05:30', 'Rationale': 'Buy: short SMA crossed above long SMA at index 2023-05-18 00:00:00+05:30', 'ticker': 'TCS.NS', 'context': [3106.222900390625, 3140.955078125, 3157.881103515625, 3187.72119140625, 3168.447509765625, 3146.776611328125, 3120.65380859375, 3128.187744140625, 3145.89599609375, 3230.818603515625, 3201.515869140625], 'indicators': {'sma_short': 3125.69970703125, 'sma_long': 3120.51716796875, 'rsi': 52.19557582380476, 'atr': 52.75655551755595, 'volatility': 30.133503520741414}, 'action': 'buy', 'qty': 1369364.0}, {'entry_index': Timestamp('2023-07-07 00:00:00+0530', tz='Asia/Kolkata'), 'exit_index': Timestamp('2023-11-02 00:00:00+0530', tz='Asia/Kolkata'), 'entry_price': 3257.234130859375, 'exit_price': 3304.493896484375, 'pnl': 34.1363095703125, 'commission_cost': 13.1234560546875, 'regime': 'ranging', 'entry_regime': 'ranging', 'exit_regime': 'ranging', 'EntryRegime': 'ranging', 'ExitRegime': 'ranging', 'volatility': 53.266358183328926, 'exit_volatility': 55.993446625605145, 'entry_volatility': 53.266358183328926, 'EntryVolatility': 53.266358183328926, 'ExitVolatility': 55.993446625605145, 'volume': 1789326.0, 'exit_volume': 1245384.0, 'entry_volume': 1789326.0, 'volume_entry': 1789326.0, 'volume_exit': 1245384.0, 'EntryVolume': 1789326.0, 'ExitVolume': 1245384.0, 'atr_entry': 42.006077640903804, 'atr_exit': 50.81962916803139, 'EntryATR': 42.006077640903804, 'ExitATR': 50.81962916803139, 'entry_sma_short': 3172.6368041992187, 'exit_sma_short': 3417.672473144531, 'entry_sma_long': 3170.3512255859373, 'exit_sma_long': 3420.3335302734376, 'EntrySMA_Short': 3172.6368041992187, 'ExitSMA_Short': 3417.672473144531, 'EntrySMA_Long': 3170.3512255859373, 'ExitSMA_Long': 3420.3335302734376, 'entry_rsi': 71.96517628476015, 'exit_rsi': 30.746314430245974, 'EntryRSI': 71.96517628476015, 'ExitRSI': 30.746314430245974, 'rationale': 'Buy: short SMA crossed above long SMA at index 2023-07-07 00:00:00+05:30', 'Rationale': 'Buy: short SMA crossed above long SMA at index 2023-07-07 00:00:00+05:30', 'ticker': 'TCS.NS', 'context': [3420.688232421875, 3398.462646484375, 3436.718994140625, 3353.71533203125, 3333.997314453125, 3281.530029296875, 3295.4951171875, 3322.638671875, 3313.00048828125, 3275.531005859375, 3304.493896484375], 'indicators': {'sma_short': 3172.6368041992187, 'sma_long': 3170.3512255859373, 'rsi': 71.96517628476015, 'atr': 42.006077640903804, 'volatility': 53.266358183328926}, 'action': 'buy', 'qty': 1789326.0}, {'entry_index': Timestamp('2023-12-08 00:00:00+0530', tz='Asia/Kolkata'), 'exit_index': Timestamp('2024-04-05 00:00:00+0530', tz='Asia/Kolkata'), 'entry_price': 3566.681884765625, 'exit_price': 3922.443359375, 'pnl': 340.7832241210937, 'commission_cost': 14.978250488281251, 'regime': 'ranging', 'entry_regime': 'ranging', 'exit_regime': 'ranging', 'EntryRegime': 'ranging', 'ExitRegime': 'ranging', 'volatility': 57.44747338604715, 'exit_volatility': 51.82343194469709, 'entry_volatility': 57.44747338604715, 'EntryVolatility': 57.44747338604715, 'ExitVolatility': 51.82343194469709, 'volume': 1641155.0, 'exit_volume': 1636819.0, 'entry_volume': 1641155.0, 'volume_entry': 1641155.0, 'volume_exit': 1636819.0, 'EntryVolume': 1641155.0, 'ExitVolume': 1636819.0, 'atr_entry': 50.72764380146919, 'atr_exit': 84.18179831226074, 'EntryATR': 50.72764380146919, 'ExitATR': 84.18179831226074, 'entry_sma_short': 3432.9939453125, 'exit_sma_short': 3961.2807739257814, 'entry_sma_long': 3423.1778759765625, 'exit_sma_long': 3961.7322509765627, 'EntrySMA_Short': 3432.9939453125, 'ExitSMA_Short': 3961.2807739257814, 'EntrySMA_Long': 3423.1778759765625, 'ExitSMA_Long': 3961.7322509765627, 'entry_rsi': 68.19444888748004, 'exit_rsi': 32.338183796541074, 'EntryRSI': 68.19444888748004, 'ExitRSI': 32.338183796541074, 'rationale': 'Buy: short SMA crossed above long SMA at index 2023-12-08 00:00:00+05:30', 'Rationale': 'Buy: short SMA crossed above long SMA at index 2023-12-08 00:00:00+05:30', 'ticker': 'TCS.NS', 'context': [3914.21240234375, 3916.233154296875, 3855.069091796875, 3822.145751953125, 3786.068115234375, 3820.962890625, 3860.83544921875, 3828.35595703125, 3890.949462890625, 3946.14990234375, 3922.443359375], 'indicators': {'sma_short': 3432.9939453125, 'sma_long': 3423.1778759765625, 'rsi': 68.19444888748004, 'atr': 50.72764380146919, 'volatility': 57.44747338604715}, 'action': 'buy', 'qty': 1641155.0}, {'entry_index': Timestamp('2024-07-02 00:00:00+0530', tz='Asia/Kolkata'), 'exit_index': Timestamp('2024-10-04 00:00:00+0530', tz='Asia/Kolkata'), 'entry_price': 3988.830810546875, 'exit_price': 4231.81689453125, 'pnl': 226.54478857421876, 'commission_cost': 16.44129541015625, 'regime': 'trending', 'entry_regime': 'trending', 'exit_regime': 'ranging', 'EntryRegime': 'trending', 'ExitRegime': 'ranging', 'volatility': 77.39997163923952, 'exit_volatility': 21.201782227182264, 'entry_volatility': 77.39997163923952, 'EntryVolatility': 77.39997163923952, 'ExitVolatility': 21.201782227182264, 'volume': 2307449.0, 'exit_volume': 2965463.0, 'entry_volume': 2307449.0, 'volume_entry': 2307449.0, 'volume_exit': 2965463.0, 'EntryVolume': 2307449.0, 'ExitVolume': 2965463.0, 'atr_entry': 68.00283621938388, 'atr_exit': 79.29424334589821, 'EntryATR': 68.00283621938388, 'ExitATR': 79.29424334589821, 'entry_sma_short': 3822.534533691406, 'exit_sma_short': 4330.551202148437, 'entry_sma_long': 3815.7201806640624, 'exit_sma_long': 4338.532907421875, 'EntrySMA_Short': 3822.534533691406, 'ExitSMA_Short': 4330.551202148437, 'EntrySMA_Long': 3815.7201806640624, 'ExitSMA_Long': 4338.532907421875, 'entry_rsi': 68.44863139071735, 'exit_rsi': 21.825197198152495, 'EntryRSI': 68.44863139071735, 'ExitRSI': 21.825197198152495, 'rationale': 'Buy: short SMA crossed above long SMA at index 2024-07-02 00:00:00+05:30', 'Rationale': 'Buy: short SMA crossed above long SMA at index 2024-07-02 00:00:00+05:30', 'ticker': 'TCS.NS', 'context': [4275.50537109375, 4264.3095703125, 4247.98876953125, 4250.77490234375, 4254.208984375, 4271.873046875, 4287.99560546875, 4247.98876953125, 4267.29541015625, 4212.41064453125, 4231.81689453125], 'indicators': {'sma_short': 3822.534533691406, 'sma_long': 3815.7201806640624, 'rsi': 68.44863139071735, 'atr': 68.00283621938388, 'volatility': 77.39997163923952}, 'action': 'buy', 'qty': 2307449.0}, {'entry_index': Timestamp('2024-12-03 00:00:00+0530', tz='Asia/Kolkata'), 'exit_index': Timestamp('2025-01-09 00:00:00+0530', tz='Asia/Kolkata'), 'entry_price': 4292.5205078125, 'exit_price': 4029.248291015625, 'pnl': -279.91575439453123, 'commission_cost': 16.643537597656252, 'regime': 'ranging', 'entry_regime': 'ranging', 'exit_regime': 'ranging', 'EntryRegime': 'ranging', 'ExitRegime': 'ranging', 'volatility': 121.1025508120866, 'exit_volatility': 50.269203375669775, 'entry_volatility': 121.1025508120866, 'EntryVolatility': 121.1025508120866, 'ExitVolatility': 50.269203375669775, 'volume': 2010905.0, 'exit_volume': 2392472.0, 'entry_volume': 2010905.0, 'volume_entry': 2010905.0, 'volume_exit': 2392472.0, 'EntryVolume': 2010905.0, 'ExitVolume': 2392472.0, 'atr_entry': 79.03150472629727, 'atr_exit': 89.05119208920703, 'EntryATR': 79.03150472629727, 'ExitATR': 89.05119208920703, 'entry_sma_short': 4166.939904785157, 'exit_sma_short': 4190.464346679687, 'entry_sma_long': 4155.905068359375, 'exit_sma_long': 4194.207292773437, 'EntrySMA_Short': 4166.939904785157, 'ExitSMA_Short': 4190.464346679687, 'EntrySMA_Long': 4155.905068359375, 'ExitSMA_Long': 4194.207292773437, 'entry_rsi': 57.67270414755591, 'exit_rsi': 30.49954028778599, 'EntryRSI': 57.67270414755591, 'ExitRSI': 30.49954028778599, 'rationale': 'Sell: short SMA crossed below long SMA at index 2025-01-09 00:00:00+05:30', 'Rationale': 'Sell: short SMA crossed below long SMA at index 2025-01-09 00:00:00+05:30', 'ticker': 'TCS.NS', 'context': [4159.1884765625, 4154.94873046875, 4148.91259765625, 4085.065185546875, 4102.67333984375, 4165.82275390625, 4090.15283203125, 4085.2646484375, 4018.72314453125, 4098.6328125, 4029.248291015625], 'indicators': {'sma_short': 4166.939904785157, 'sma_long': 4155.905068359375, 'rsi': 57.67270414755591, 'atr': 79.03150472629727, 'volatility': 121.1025508120866}, 'action': 'buy', 'qty': 2010905.0}]
[DEBUG] Stats for report: {'strategy': {'total_return': 0.0, 'win_rate': 0.4666666666666667, 'sharpe_ratio': 0.0, 'max_drawdown': 0.0, 'average_win': 144.48506295340403, 'average_loss': -127.76514585876465, 'largest_win': 1012.43420703125, 'largest_loss': -299.7711279296875, 'profit_factor': 0.989506404383413, 'expectancy': -0.715048413085924}, '_trades':                  entry_index                exit_index  ...        qty          PnL
0  2015-05-28 00:00:00+05:30 2015-07-24 00:00:00+05:30  ...  2763608.0   -36.750795
1  2015-08-17 00:00:00+05:30 2015-09-18 00:00:00+05:30  ...   773644.0   -62.292168
2  2015-10-13 00:00:00+05:30 2015-10-14 00:00:00+05:30  ...  6179712.0   -54.090274
3  2016-03-21 00:00:00+05:30 2016-07-14 00:00:00+05:30  ...  2336982.0    39.912589
4  2016-08-08 00:00:00+05:30 2016-09-12 00:00:00+05:30  ...  2058244.0  -132.298691
5  2017-01-02 00:00:00+05:30 2017-04-18 00:00:00+05:30  ...   823132.0   -24.422204
6  2017-05-26 00:00:00+05:30 2017-07-05 00:00:00+05:30  ...  1362550.0   -91.131871
7  2017-08-03 00:00:00+05:30 2017-09-20 00:00:00+05:30  ...  1882548.0    -2.633052
8  2017-10-16 00:00:00+05:30 2017-12-20 00:00:00+05:30  ...  1218590.0     0.555545
9  2018-01-15 00:00:00+05:30 2018-03-22 00:00:00+05:30  ...  1457214.0    36.372581
10 2018-04-20 00:00:00+05:30 2018-10-24 00:00:00+05:30  ...  8558576.4   147.289719
11 2018-12-14 00:00:00+05:30 2019-01-10 00:00:00+05:30  ...  2473761.0   -99.561491
12 2019-02-07 00:00:00+05:30 2019-07-23 00:00:00+05:30  ...  1339945.0    39.544667
13 2019-08-23 00:00:00+05:30 2019-09-25 00:00:00+05:30  ...  2826425.0  -155.377084
14 2019-11-11 00:00:00+05:30 2019-12-09 00:00:00+05:30  ...  2983768.0   -45.286181
15 2019-12-31 00:00:00+05:30 2020-02-13 00:00:00+05:30  ...  1909289.0    24.590005
16 2020-05-12 00:00:00+05:30 2021-03-02 00:00:00+05:30  ...  3256595.0  1012.434207
17 2021-04-07 00:00:00+05:30 2021-05-17 00:00:00+05:30  ...  2491268.0  -203.000076
18 2021-06-11 00:00:00+05:30 2021-07-30 00:00:00+05:30  ...  3452954.0  -106.915366
19 2021-08-16 00:00:00+05:30 2021-10-25 00:00:00+05:30  ...  2083489.0    12.167980
20 2021-12-20 00:00:00+05:30 2022-02-22 00:00:00+05:30  ...  2312310.0    20.550000
21 2022-04-06 00:00:00+05:30 2022-04-29 00:00:00+05:30  ...  2051729.0  -213.731969
22 2022-08-12 00:00:00+05:30 2022-09-15 00:00:00+05:30  ...  1472354.0  -299.771128
23 2022-11-02 00:00:00+05:30 2023-01-02 00:00:00+05:30  ...  1405955.0     6.533690
24 2023-01-25 00:00:00+05:30 2023-03-15 00:00:00+05:30  ...   874110.0  -237.064229
25 2023-05-18 00:00:00+05:30 2023-07-03 00:00:00+05:30  ...  1369364.0    81.375576
26 2023-07-07 00:00:00+05:30 2023-11-02 00:00:00+05:30  ...  1789326.0    34.136310
27 2023-12-08 00:00:00+05:30 2024-04-05 00:00:00+05:30  ...  1641155.0   340.783224
28 2024-07-02 00:00:00+05:30 2024-10-04 00:00:00+05:30  ...  2307449.0   226.544789
29 2024-12-03 00:00:00+05:30 2025-01-09 00:00:00+05:30  ...  2010905.0  -279.915754

[30 rows x 47 columns], 'trades': [{'entry_index': Timestamp('2015-05-28 00:00:00+0530', tz='Asia/Kolkata'), 'exit_index': Timestamp('2015-07-24 00:00:00+0530', tz='Asia/Kolkata'), 'entry_price': 1116.2579345703125, 'exit_price': 1083.907470703125, 'pnl': -36.750794677734376, 'commission_cost': 4.400330810546875, 'regime': 'trending', 'entry_regime': 'trending', 'exit_regime': 'ranging', 'EntryRegime': 'trending', 'ExitRegime': 'ranging', 'volatility': 20.344639809204683, 'exit_volatility': 14.96908450344755, 'entry_volatility': 20.344639809204683, 'EntryVolatility': 20.344639809204683, 'ExitVolatility': 14.96908450344755, 'volume': 2763608.0, 'exit_volume': 1574972.0, 'entry_volume': 2763608.0, 'volume_entry': 2763608.0, 'volume_exit': 1574972.0, 'EntryVolume': 2763608.0, 'ExitVolume': 1574972.0, 'atr_entry': 21.90367707550908, 'atr_exit': 19.496815017312816, 'EntryATR': 21.90367707550908, 'ExitATR': 19.496815017312816, 'entry_sma_short': 1086.560125732422, 'exit_sma_short': 1103.3007751464843, 'entry_sma_long': 1085.4851016090029, 'exit_sma_long': 1104.4010961914062, 'EntrySMA_Short': 1086.560125732422, 'ExitSMA_Short': 1103.3007751464843, 'EntrySMA_Long': 1085.4851016090029, 'ExitSMA_Long': 1104.4010961914062, 'entry_rsi': 65.84502628853397, 'exit_rsi': 34.948929541277536, 'EntryRSI': 65.84502628853397, 'ExitRSI': 34.948929541277536, 'rationale': 'Sell: short SMA crossed below long SMA at index 2015-07-24 00:00:00+05:30', 'Rationale': 'Sell: short SMA crossed below long SMA at index 2015-07-24 00:00:00+05:30', 'ticker': 'TCS.NS', 'context': [1068.2847900390625, 1083.482421875, 1079.1436767578125, 1099.11181640625, 1096.7149658203125, 1107.1636962890625, 1115.9251708984375, 1108.2451171875, 1093.8155517578125, 1076.74658203125, 1083.907470703125], 'indicators': {'sma_short': 1086.560125732422, 'sma_long': 1085.4851016090029, 'rsi': 65.84502628853397, 'atr': 21.90367707550908, 'volatility': 20.344639809204683}, 'action': 'buy', 'qty': 2763608.0}, {'entry_index': Timestamp('2015-08-17 00:00:00+0530', tz='Asia/Kolkata'), 'exit_index': Timestamp('2015-09-18 00:00:00+0530', tz='Asia/Kolkata'), 'entry_price': 1161.614990234375, 'exit_price': 1103.853759765625, 'pnl': -62.29216796875, 'commission_cost': 4.5309375, 'regime': 'trending', 'entry_regime': 'trending', 'exit_regime': 'ranging', 'EntryRegime': 'trending', 'ExitRegime': 'ranging', 'volatility': 29.72120300591647, 'exit_volatility': 8.036496458440938, 'entry_volatility': 29.72120300591647, 'EntryVolatility': 29.72120300591647, 'ExitVolatility': 8.036496458440938, 'volume': 773644.0, 'exit_volume': 2455294.0, 'entry_volume': 773644.0, 'volume_entry': 773644.0, 'volume_exit': 2455294.0, 'EntryVolume': 773644.0, 'ExitVolume': 2455294.0, 'atr_entry': 20.505525954524714, 'atr_exit': 22.495340504134614, 'EntryATR': 20.505525954524714, 'ExitATR': 22.495340504134614, 'entry_sma_short': 1106.4062438964843, 'exit_sma_short': 1109.9801147460937, 'entry_sma_long': 1105.1430322265626, 'exit_sma_long': 1110.174765625, 'EntrySMA_Short': 1106.4062438964843, 'ExitSMA_Short': 1109.9801147460937, 'EntrySMA_Long': 1105.1430322265626, 'ExitSMA_Long': 1110.174765625, 'entry_rsi': 73.41095421919863, 'exit_rsi': 45.488129459490004, 'EntryRSI': 73.41095421919863, 'ExitRSI': 45.488129459490004, 'rationale': 'Sell: short SMA crossed below long SMA at index 2015-09-18 00:00:00+05:30', 'Rationale': 'Sell: short SMA crossed below long SMA at index 2015-09-18 00:00:00+05:30', 'ticker': 'TCS.NS', 'context': [1127.368896484375, 1102.209228515625, 1098.8778076171875, 1099.1158447265625, 1103.20458984375, 1101.3223876953125, 1104.1776123046875, 1104.026611328125, 1097.796142578125, 1103.4638671875, 1103.853759765625], 'indicators': {'sma_short': 1106.4062438964843, 'sma_long': 1105.1430322265626, 'rsi': 73.41095421919863, 'atr': 20.505525954524714, 'volatility': 29.72120300591647}, 'action': 'buy', 'qty': 773644.0}, {'entry_index': Timestamp('2015-10-13 00:00:00+0530', tz='Asia/Kolkata'), 'exit_index': Timestamp('2015-10-14 00:00:00+0530', tz='Asia/Kolkata'), 'entry_price': 1124.319091796875, 'exit_price': 1074.626708984375, 'pnl': -54.0902744140625, 'commission_cost': 4.3978916015625, 'regime': 'ranging', 'entry_regime': 'ranging', 'exit_regime': 'ranging', 'EntryRegime': 'ranging', 'ExitRegime': 'ranging', 'volatility': 19.142614334220383, 'exit_volatility': 26.900984774612777, 'entry_volatility': 19.142614334220383, 'EntryVolatility': 19.142614334220383, 'ExitVolatility': 26.900984774612777, 'volume': 6179712.0, 'exit_volume': 8337128.0, 'entry_volume': 6179712.0, 'volume_entry': 6179712.0, 'volume_exit': 8337128.0, 'EntryVolume': 6179712.0, 'ExitVolume': 8337128.0, 'atr_entry': 24.97378475822862, 'atr_exit': 25.6677852450535, 'EntryATR': 24.97378475822862, 'ExitATR': 25.6677852450535, 'entry_sma_short': 1122.0949645996093, 'exit_sma_short': 1120.6174194335938, 'entry_sma_long': 1122.078056640625, 'exit_sma_long': 1121.843984375, 'EntrySMA_Short': 1122.0949645996093, 'ExitSMA_Short': 1120.6174194335938, 'EntrySMA_Long': 1122.078056640625, 'ExitSMA_Long': 1121.843984375, 'entry_rsi': 56.876174699754706, 'exit_rsi': 45.057325780488654, 'EntryRSI': 56.876174699754706, 'ExitRSI': 45.057325780488654, 'rationale': 'Sell: short SMA crossed below long SMA at index 2015-10-14 00:00:00+05:30', 'Rationale': 'Sell: short SMA crossed below long SMA at index 2015-10-14 00:00:00+05:30', 'ticker': 'TCS.NS', 'context': [1119.8624267578125, 1119.775634765625, 1144.24365234375, 1173.2540283203125, 1168.21337890625, 1148.2889404296875, 1139.570556640625, 1137.7750244140625, 1121.744873046875, 1124.319091796875, 1074.626708984375], 'indicators': {'sma_short': 1122.0949645996093, 'sma_long': 1122.078056640625, 'rsi': 56.876174699754706, 'atr': 24.97378475822862, 'volatility': 19.142614334220383}, 'action': 'buy', 'qty': 6179712.0}, {'entry_index': Timestamp('2016-03-21 00:00:00+0530', tz='Asia/Kolkata'), 'exit_index': Timestamp('2016-07-14 00:00:00+0530', tz='Asia/Kolkata'), 'entry_price': 1063.2938232421875, 'exit_price': 1107.548095703125, 'pnl': 39.91258862304687, 'commission_cost': 4.341683837890625, 'regime': 'ranging', 'entry_regime': 'ranging', 'exit_regime': 'ranging', 'EntryRegime': 'ranging', 'ExitRegime': 'ranging', 'volatility': 16.118863379677137, 'exit_volatility': 16.44117529346046, 'entry_volatility': 16.118863379677137, 'EntryVolatility': 16.118863379677137, 'ExitVolatility': 16.44117529346046, 'volume': 2336982.0, 'exit_volume': 2699988.0, 'entry_volume': 2336982.0, 'volume_entry': 2336982.0, 'volume_exit': 2699988.0, 'EntryVolume': 2336982.0, 'ExitVolume': 2699988.0, 'atr_entry': 24.32335939262365, 'atr_exit': 22.074454143748536, 'EntryATR': 24.32335939262365, 'ExitATR': 22.074454143748536, 'entry_sma_short': 1007.9480926513672, 'exit_sma_short': 1112.3132080078126, 'entry_sma_long': 1006.7764245605468, 'exit_sma_long': 1113.5601440429687, 'EntrySMA_Short': 1007.9480926513672, 'ExitSMA_Short': 1112.3132080078126, 'EntrySMA_Long': 1006.7764245605468, 'ExitSMA_Long': 1113.5601440429687, 'entry_rsi': 83.55997636854161, 'exit_rsi': 37.46312101500903, 'EntryRSI': 83.55997636854161, 'ExitRSI': 37.46312101500903, 'rationale': 'Buy: short SMA crossed above long SMA at index 2016-03-21 00:00:00+05:30', 'Rationale': 'Buy: short SMA crossed above long SMA at index 2016-03-21 00:00:00+05:30', 'ticker': 'TCS.NS', 'context': [1099.203369140625, 1121.250244140625, 1098.3035888671875, 1095.383056640625, 1091.4744873046875, 1067.100341796875, 1065.695068359375, 1082.1861572265625, 1082.53759765625, 1094.900146484375, 1107.548095703125], 'indicators': {'sma_short': 1007.9480926513672, 'sma_long': 1006.7764245605468, 'rsi': 83.55997636854161, 'atr': 24.32335939262365, 'volatility': 16.118863379677137}, 'action': 'buy', 'qty': 2336982.0}, {'entry_index': Timestamp('2016-08-08 00:00:00+0530', tz='Asia/Kolkata'), 'exit_index': Timestamp('2016-09-12 00:00:00+0530', tz='Asia/Kolkata'), 'entry_price': 1166.6014404296875, 'exit_price': 1038.71337890625, 'pnl': -132.29869116210938, 'commission_cost': 4.4106296386718755, 'regime': 'ranging', 'entry_regime': 'ranging', 'exit_regime': 'ranging', 'EntryRegime': 'ranging', 'ExitRegime': 'ranging', 'volatility': 22.811093014092922, 'exit_volatility': 34.827970973933326, 'entry_volatility': 22.811093014092922, 'EntryVolatility': 22.811093014092922, 'ExitVolatility': 34.827970973933326, 'volume': 2058244.0, 'exit_volume': 2024454.0, 'entry_volume': 2058244.0, 'volume_entry': 2058244.0, 'volume_exit': 2024454.0, 'EntryVolume': 2058244.0, 'ExitVolume': 2024454.0, 'atr_entry': 22.882056499296397, 'atr_exit': 23.487764427607736, 'EntryATR': 22.882056499296397, 'ExitATR': 23.487764427607736, 'entry_sma_short': 1127.7510620117187, 'exit_sma_short': 1114.6680908203125, 'entry_sma_long': 1125.5620581054689, 'exit_sma_long': 1120.1577563476562, 'EntrySMA_Short': 1127.7510620117187, 'ExitSMA_Short': 1114.6680908203125, 'EntrySMA_Long': 1125.5620581054689, 'ExitSMA_Long': 1120.1577563476562, 'entry_rsi': 79.5742282194841, 'exit_rsi': 29.826526387311162, 'EntryRSI': 79.5742282194841, 'ExitRSI': 29.826526387311162, 'rationale': 'Sell: short SMA crossed below long SMA at index 2016-09-12 00:00:00+05:30', 'Rationale': 'Sell: short SMA crossed below long SMA at index 2016-09-12 00:00:00+05:30', 'ticker': 'TCS.NS', 'context': [1111.7606201171875, 1101.017822265625, 1120.21484375, 1105.750732421875, 1104.07763671875, 1107.2918701171875, 1093.751953125, 1074.598876953125, 1022.4437255859375, 1035.807373046875, 1038.71337890625], 'indicators': {'sma_short': 1127.7510620117187, 'sma_long': 1125.5620581054689, 'rsi': 79.5742282194841, 'atr': 22.882056499296397, 'volatility': 22.811093014092922}, 'action': 'buy', 'qty': 2058244.0}, {'entry_index': Timestamp('2017-01-02 00:00:00+0530', tz='Asia/Kolkata'), 'exit_index': Timestamp('2017-04-18 00:00:00+0530', tz='Asia/Kolkata'), 'entry_price': 1042.51611328125, 'exit_price': 1022.223388671875, 'pnl': -24.42220361328125, 'commission_cost': 4.12947900390625, 'regime': 'ranging', 'entry_regime': 'ranging', 'exit_regime': 'ranging', 'EntryRegime': 'ranging', 'ExitRegime': 'ranging', 'volatility': 12.530790767565804, 'exit_volatility': 20.675956984591572, 'entry_volatility': 12.530790767565804, 'EntryVolatility': 12.530790767565804, 'ExitVolatility': 20.675956984591572, 'volume': 823132.0, 'exit_volume': 1730620.0, 'entry_volume': 823132.0, 'volume_entry': 823132.0, 'volume_exit': 1730620.0, 'EntryVolume': 823132.0, 'ExitVolume': 1730620.0, 'atr_entry': 23.674647283152307, 'atr_exit': 20.22264083283411, 'EntryATR': 23.674647283152307, 'ExitATR': 20.22264083283411, 'entry_sma_short': 1002.8934997558594, 'exit_sma_short': 1069.725079345703, 'entry_sma_long': 999.1856970214844, 'exit_sma_long': 1073.886239013672, 'EntrySMA_Short': 1002.8934997558594, 'ExitSMA_Short': 1069.725079345703, 'EntrySMA_Long': 999.1856970214844, 'ExitSMA_Long': 1073.886239013672, 'entry_rsi': 77.59095441443617, 'exit_rsi': 27.19259032791257, 'EntryRSI': 77.59095441443617, 'ExitRSI': 27.19259032791257, 'rationale': 'Sell: short SMA crossed below long SMA at index 2017-04-18 00:00:00+05:30', 'Rationale': 'Sell: short SMA crossed below long SMA at index 2017-04-18 00:00:00+05:30', 'ticker': 'TCS.NS', 'context': [1076.6817626953125, 1067.7823486328125, 1063.1558837890625, 1062.6243896484375, 1075.464111328125, 1072.453857421875, 1071.147705078125, 1059.613525390625, 1031.0120849609375, 1024.902099609375, 1022.223388671875], 'indicators': {'sma_short': 1002.8934997558594, 'sma_long': 999.1856970214844, 'rsi': 77.59095441443617, 'atr': 23.674647283152307, 'volatility': 12.530790767565804}, 'action': 'buy', 'qty': 823132.0}, {'entry_index': Timestamp('2017-05-26 00:00:00+0530', tz='Asia/Kolkata'), 'exit_index': Timestamp('2017-07-05 00:00:00+0530', tz='Asia/Kolkata'), 'entry_price': 1141.5228271484375, 'exit_price': 1054.7835693359375, 'pnl': -91.13187060546875, 'commission_cost': 4.39261279296875, 'regime': 'trending', 'entry_regime': 'trending', 'exit_regime': 'ranging', 'EntryRegime': 'trending', 'ExitRegime': 'ranging', 'volatility': 37.69958038743053, 'exit_volatility': 14.399672945579374, 'entry_volatility': 37.69958038743053, 'EntryVolatility': 37.69958038743053, 'ExitVolatility': 14.399672945579374, 'volume': 1362550.0, 'exit_volume': 815856.0, 'entry_volume': 1362550.0, 'volume_entry': 1362550.0, 'volume_exit': 815856.0, 'EntryVolume': 1362550.0, 'ExitVolume': 815856.0, 'atr_entry': 19.972469347631815, 'atr_exit': 22.641982633423087, 'EntryATR': 19.972469347631815, 'ExitATR': 22.641982633423087, 'entry_sma_short': 1071.3797760009766, 'exit_sma_short': 1080.6648254394531, 'entry_sma_long': 1066.5980932617188, 'exit_sma_long': 1082.3128552246094, 'EntrySMA_Short': 1071.3797760009766, 'ExitSMA_Short': 1080.6648254394531, 'EntrySMA_Long': 1066.5980932617188, 'ExitSMA_Long': 1082.3128552246094, 'entry_rsi': 76.42924465622788, 'exit_rsi': 30.960269115374132, 'EntryRSI': 76.42924465622788, 'ExitRSI': 30.960269115374132, 'rationale': 'Sell: short SMA crossed below long SMA at index 2017-07-05 00:00:00+05:30', 'Rationale': 'Sell: short SMA crossed below long SMA at index 2017-07-05 00:00:00+05:30', 'ticker': 'TCS.NS', 'context': [1094.6290283203125, 1077.302978515625, 1072.177001953125, 1057.33544921875, 1048.8963623046875, 1052.119873046875, 1044.598388671875, 1057.6263427734375, 1062.6627197265625, 1059.641357421875, 1054.7835693359375], 'indicators': {'sma_short': 1071.3797760009766, 'sma_long': 1066.5980932617188, 'rsi': 76.42924465622788, 'atr': 19.972469347631815, 'volatility': 37.69958038743053}, 'action': 'buy', 'qty': 1362550.0}, {'entry_index': Timestamp('2017-08-03 00:00:00+0530', tz='Asia/Kolkata'), 'exit_index': Timestamp('2017-09-20 00:00:00+0530', tz='Asia/Kolkata'), 'entry_price': 1117.66943359375, 'exit_price': 1119.5107421875, 'pnl': -2.6330517578125, 'commission_cost': 4.4743603515625, 'regime': 'ranging', 'entry_regime': 'ranging', 'exit_regime': 'ranging', 'EntryRegime': 'ranging', 'ExitRegime': 'ranging', 'volatility': 17.24492547682601, 'exit_volatility': 8.497332082256023, 'entry_volatility': 17.24492547682601, 'EntryVolatility': 17.24492547682601, 'ExitVolatility': 8.497332082256023, 'volume': 1882548.0, 'exit_volume': 1334642.0, 'entry_volume': 1882548.0, 'volume_entry': 1882548.0, 'volume_exit': 1334642.0, 'EntryVolume': 1882548.0, 'ExitVolume': 1334642.0, 'atr_entry': 23.979718785750137, 'atr_exit': 20.243034224560553, 'EntryATR': 23.979718785750137, 'ExitATR': 20.243034224560553, 'entry_sma_short': 1104.9222290039063, 'exit_sma_short': 1113.9197692871094, 'entry_sma_long': 1101.5046118164062, 'exit_sma_long': 1114.5577807617187, 'EntrySMA_Short': 1104.9222290039063, 'ExitSMA_Short': 1113.9197692871094, 'EntrySMA_Long': 1101.5046118164062, 'ExitSMA_Long': 1114.5577807617187, 'entry_rsi': 64.19437100226554, 'exit_rsi': 49.30570353486992, 'EntryRSI': 64.19437100226554, 'ExitRSI': 49.30570353486992, 'rationale': 'Sell: short SMA crossed below long SMA at index 2017-09-20 00:00:00+05:30', 'Rationale': 'Sell: short SMA crossed below long SMA at index 2017-09-20 00:00:00+05:30', 'ticker': 'TCS.NS', 'context': [1101.3948974609375, 1104.492431640625, 1109.20654296875, 1101.955810546875, 1117.2205810546875, 1117.557373046875, 1116.5472412109375, 1125.122802734375, 1121.9796142578125, 1121.6202392578125, 1119.5107421875], 'indicators': {'sma_short': 1104.9222290039063, 'sma_long': 1101.5046118164062, 'rsi': 64.19437100226554, 'atr': 23.979718785750137, 'volatility': 17.24492547682601}, 'action': 'buy', 'qty': 1882548.0}, {'entry_index': Timestamp('2017-10-16 00:00:00+0530', tz='Asia/Kolkata'), 'exit_index': Timestamp('2017-12-20 00:00:00+0530', tz='Asia/Kolkata'), 'entry_price': 1160.298583984375, 'exit_price': 1165.5057373046875, 'pnl': 0.5555446777343747, 'commission_cost': 4.651608642578125, 'regime': 'ranging', 'entry_regime': 'ranging', 'exit_regime': 'ranging', 'EntryRegime': 'ranging', 'ExitRegime': 'ranging', 'volatility': 25.070780817490167, 'exit_volatility': 15.56132382083433, 'entry_volatility': 25.070780817490167, 'EntryVolatility': 25.070780817490167, 'ExitVolatility': 15.56132382083433, 'volume': 1218590.0, 'exit_volume': 1577570.0, 'entry_volume': 1218590.0, 'volume_entry': 1218590.0, 'volume_exit': 1577570.0, 'EntryVolume': 1218590.0, 'ExitVolume': 1577570.0, 'atr_entry': 18.487825911629443, 'atr_exit': 22.464162956941788, 'EntryATR': 18.487825911629443, 'ExitATR': 22.464162956941788, 'entry_sma_short': 1117.558575439453, 'exit_sma_short': 1182.5294555664063, 'entry_sma_long': 1117.386416015625, 'exit_sma_long': 1185.00658203125, 'EntrySMA_Short': 1117.558575439453, 'ExitSMA_Short': 1182.5294555664063, 'EntrySMA_Long': 1117.386416015625, 'ExitSMA_Long': 1185.00658203125, 'entry_rsi': 62.207836573259094, 'exit_rsi': 42.20111613823214, 'EntryRSI': 62.207836573259094, 'ExitRSI': 42.20111613823214, 'rationale': 'Buy: short SMA crossed above long SMA at index 2017-10-16 00:00:00+05:30', 'Rationale': 'Buy: short SMA crossed above long SMA at index 2017-10-16 00:00:00+05:30', 'ticker': 'TCS.NS', 'context': [1185.471435546875, 1178.2457275390625, 1171.1552734375, 1197.98681640625, 1175.9500732421875, 1183.265625, 1151.4822998046875, 1145.9906005859375, 1161.70166015625, 1159.360595703125, 1165.5057373046875], 'indicators': {'sma_short': 1117.558575439453, 'sma_long': 1117.386416015625, 'rsi': 62.207836573259094, 'atr': 18.487825911629443, 'volatility': 25.070780817490167}, 'action': 'buy', 'qty': 1218590.0}, {'entry_index': Timestamp('2018-01-15 00:00:00+0530', tz='Asia/Kolkata'), 'exit_index': Timestamp('2018-03-22 00:00:00+0530', tz='Asia/Kolkata'), 'entry_price': 1236.2523193359375, 'exit_price': 1277.6527099609375, 'pnl': 36.37258056640625, 'commission_cost': 5.02781005859375, 'regime': 'ranging', 'entry_regime': 'ranging', 'exit_regime': 'ranging', 'EntryRegime': 'ranging', 'ExitRegime': 'ranging', 'volatility': 28.54815844587923, 'exit_volatility': 38.05862519378415, 'entry_volatility': 28.54815844587923, 'EntryVolatility': 28.54815844587923, 'ExitVolatility': 38.05862519378415, 'volume': 1457214.0, 'exit_volume': 2326094.0, 'entry_volume': 1457214.0, 'volume_entry': 1457214.0, 'volume_exit': 2326094.0, 'EntryVolume': 1457214.0, 'ExitVolume': 2326094.0, 'atr_entry': 23.32632129116307, 'atr_exit': 35.3867411018588, 'EntryATR': 23.32632129116307, 'ExitATR': 35.3867411018588, 'entry_sma_short': 1201.75458984375, 'exit_sma_short': 1340.0416870117188, 'entry_sma_long': 1201.3228735351563, 'exit_sma_long': 1342.0076831054687, 'EntrySMA_Short': 1201.75458984375, 'ExitSMA_Short': 1340.0416870117188, 'EntrySMA_Long': 1201.3228735351563, 'ExitSMA_Long': 1342.0076831054687, 'entry_rsi': 61.30272645978805, 'exit_rsi': 30.06466119904684, 'EntryRSI': 61.30272645978805, 'ExitRSI': 30.06466119904684, 'rationale': 'Buy: short SMA crossed above long SMA at index 2018-01-15 00:00:00+05:30', 'Rationale': 'Buy: short SMA crossed above long SMA at index 2018-01-15 00:00:00+05:30', 'ticker': 'TCS.NS', 'context': [1355.538818359375, 1369.14404296875, 1377.289306640625, 1302.6744384765625, 1302.7193603515625, 1294.9581298828125, 1275.103271484375, 1277.4947509765625, 1292.769775390625, 1289.1142578125, 1277.6527099609375], 'indicators': {'sma_short': 1201.75458984375, 'sma_long': 1201.3228735351563, 'rsi': 61.30272645978805, 'atr': 23.32632129116307, 'volatility': 28.54815844587923}, 'action': 'buy', 'qty': 1457214.0}, {'entry_index': Timestamp('2018-04-20 00:00:00+0530', tz='Asia/Kolkata'), 'exit_index': Timestamp('2018-10-24 00:00:00+0530', tz='Asia/Kolkata'), 'entry_price': 1535.3626708984375, 'exit_price': 1689.101318359375, 'pnl': 147.28971948242187, 'commission_cost': 6.448927978515625, 'regime': 'trending', 'entry_regime': 'trending', 'exit_regime': 'trending', 'EntryRegime': 'trending', 'ExitRegime': 'trending', 'volatility': 64.68997203970447, 'exit_volatility': 67.38974352706316, 'entry_volatility': 64.68997203970447, 'EntryVolatility': 64.68997203970447, 'ExitVolatility': 67.38974352706316, 'volume': 8558576.400000006, 'exit_volume': 2735913.0, 'entry_volume': 8558576.400000006, 'volume_entry': 8558576.400000006, 'volume_exit': 2735913.0, 'EntryVolume': 8558576.400000006, 'ExitVolume': 2735913.0, 'atr_entry': 31.597591452476085, 'atr_exit': 41.47564671077476, 'EntryATR': 31.597591452476085, 'ExitATR': 41.47564671077476, 'entry_sma_short': 1355.5286499023437, 'exit_sma_short': 1857.9934997558594, 'entry_sma_long': 1346.411796875, 'exit_sma_long': 1866.0821826171875, 'EntrySMA_Short': 1355.5286499023437, 'ExitSMA_Short': 1857.9934997558594, 'EntrySMA_Long': 1346.411796875, 'ExitSMA_Long': 1866.0821826171875, 'entry_rsi': 89.82520911551711, 'exit_rsi': 19.70449875176196, 'EntryRSI': 89.82520911551711, 'ExitRSI': 19.70449875176196, 'rationale': 'Buy: short SMA crossed above long SMA at index 2018-04-20 00:00:00+05:30', 'Rationale': 'Buy: short SMA crossed above long SMA at index 2018-04-20 00:00:00+05:30', 'ticker': 'TCS.NS', 'context': [1907.403076171875, 1863.451904296875, 1805.41259765625, 1749.197021484375, 1777.6473388671875, 1789.3187255859375, 1759.3192138671875, 1744.5469970703125, 1735.2462158203125, 1684.6688232421875, 1689.101318359375], 'indicators': {'sma_short': 1355.5286499023437, 'sma_long': 1346.411796875, 'rsi': 89.82520911551711, 'atr': 31.597591452476085, 'volatility': 64.68997203970447}, 'action': 'buy', 'qty': 8558576.400000006}, {'entry_index': Timestamp('2018-12-14 00:00:00+0530', tz='Asia/Kolkata'), 'exit_index': Timestamp('2019-01-10 00:00:00+0530', tz='Asia/Kolkata'), 'entry_price': 1818.1710205078125, 'exit_price': 1725.697265625, 'pnl': -99.56149145507813, 'commission_cost': 7.087736572265626, 'regime': 'ranging', 'entry_regime': 'ranging', 'exit_regime': 'ranging', 'EntryRegime': 'ranging', 'ExitRegime': 'ranging', 'volatility': 13.758803755881244, 'exit_volatility': 11.133004690065835, 'entry_volatility': 13.758803755881244, 'EntryVolatility': 13.758803755881244, 'ExitVolatility': 11.133004690065835, 'volume': 2473761.0, 'exit_volume': 3053461.0, 'entry_volume': 2473761.0, 'volume_entry': 2473761.0, 'volume_exit': 3053461.0, 'EntryVolume': 2473761.0, 'ExitVolume': 3053461.0, 'atr_entry': 50.385429460266685, 'atr_exit': 40.192103562664414, 'EntryATR': 50.385429460266685, 'ExitATR': 40.192103562664414, 'entry_sma_short': 1776.9940063476563, 'exit_sma_short': 1756.6466064453125, 'entry_sma_long': 1774.782958984375, 'exit_sma_long': 1760.4689208984375, 'EntrySMA_Short': 1776.9940063476563, 'ExitSMA_Short': 1756.6466064453125, 'EntrySMA_Long': 1774.782958984375, 'ExitSMA_Long': 1760.4689208984375, 'entry_rsi': 71.51423795916783, 'exit_rsi': 37.217041268318376, 'EntryRSI': 71.51423795916783, 'ExitRSI': 37.217041268318376, 'rationale': 'Sell: short SMA crossed below long SMA at index 2019-01-10 00:00:00+05:30', 'Rationale': 'Sell: short SMA crossed below long SMA at index 2019-01-10 00:00:00+05:30', 'ticker': 'TCS.NS', 'context': [1744.337890625, 1732.5509033203125, 1729.809326171875, 1738.718505859375, 1757.45068359375, 1736.114013671875, 1715.006103515625, 1734.2412109375, 1730.2659912109375, 1724.2349853515625, 1725.697265625], 'indicators': {'sma_short': 1776.9940063476563, 'sma_long': 1774.782958984375, 'rsi': 71.51423795916783, 'atr': 50.385429460266685, 'volatility': 13.758803755881244}, 'action': 'buy', 'qty': 2473761.0}, {'entry_index': Timestamp('2019-02-07 00:00:00+0530', tz='Asia/Kolkata'), 'exit_index': Timestamp('2019-07-23 00:00:00+0530', tz='Asia/Kolkata'), 'entry_price': 1907.3680419921875, 'exit_price': 1954.63671875, 'pnl': 39.544667236328124, 'commission_cost': 7.724009521484375, 'regime': 'trending', 'entry_regime': 'trending', 'exit_regime': 'ranging', 'EntryRegime': 'trending', 'ExitRegime': 'ranging', 'volatility': 55.380696588194034, 'exit_volatility': 19.457800629609387, 'entry_volatility': 55.380696588194034, 'EntryVolatility': 55.380696588194034, 'ExitVolatility': 19.457800629609387, 'volume': 1339945.0, 'exit_volume': 3538588.0, 'entry_volume': 1339945.0, 'volume_entry': 1339945.0, 'volume_exit': 3538588.0, 'EntryVolume': 1339945.0, 'ExitVolume': 3538588.0, 'atr_entry': 35.061515957989656, 'atr_exit': 42.56218603898725, 'EntryATR': 35.061515957989656, 'ExitATR': 42.56218603898725, 'entry_sma_short': 1780.957861328125, 'exit_sma_short': 1996.7326782226562, 'entry_sma_long': 1778.8915698242188, 'exit_sma_long': 1999.0076220703124, 'EntrySMA_Short': 1780.957861328125, 'ExitSMA_Short': 1996.7326782226562, 'EntrySMA_Long': 1778.8915698242188, 'ExitSMA_Long': 1999.0076220703124, 'entry_rsi': 84.70768568379302, 'exit_rsi': 33.15290076443344, 'EntryRSI': 84.70768568379302, 'ExitRSI': 33.15290076443344, 'rationale': 'Buy: short SMA crossed above long SMA at index 2019-02-07 00:00:00+05:30', 'Rationale': 'Buy: short SMA crossed above long SMA at index 2019-02-07 00:00:00+05:30', 'ticker': 'TCS.NS', 'context': [1969.375244140625, 1946.1583251953125, 1940.94287109375, 1945.604736328125, 1980.7760009765625, 1948.6688232421875, 1959.0775146484375, 1911.6102294921875, 1921.788818359375, 1952.2763671875, 1954.63671875], 'indicators': {'sma_short': 1780.957861328125, 'sma_long': 1778.8915698242188, 'rsi': 84.70768568379302, 'atr': 35.061515957989656, 'volatility': 55.380696588194034}, 'action': 'buy', 'qty': 1339945.0}, {'entry_index': Timestamp('2019-08-23 00:00:00+0530', tz='Asia/Kolkata'), 'exit_index': Timestamp('2019-09-25 00:00:00+0530', tz='Asia/Kolkata'), 'entry_price': 2079.781982421875, 'exit_price': 1932.4293212890625, 'pnl': -155.37708374023438, 'commission_cost': 8.024422607421876, 'regime': 'ranging', 'entry_regime': 'ranging', 'exit_regime': 'ranging', 'EntryRegime': 'ranging', 'ExitRegime': 'ranging', 'volatility': 30.01268203463836, 'exit_volatility': 42.890237956883496, 'entry_volatility': 30.01268203463836, 'EntryVolatility': 30.01268203463836, 'ExitVolatility': 42.890237956883496, 'volume': 2826425.0, 'exit_volume': 4002232.0, 'entry_volume': 2826425.0, 'volume_entry': 2826425.0, 'volume_exit': 4002232.0, 'EntryVolume': 2826425.0, 'ExitVolume': 4002232.0, 'atr_entry': 41.128940479160136, 'atr_exit': 43.6184748197578, 'EntryATR': 41.128940479160136, 'ExitATR': 43.6184748197578, 'entry_sma_short': 2030.4203552246095, 'exit_sma_short': 1999.4924621582031, 'entry_sma_long': 2025.1902075195312, 'exit_sma_long': 2004.3819580078125, 'EntrySMA_Short': 2030.4203552246095, 'ExitSMA_Short': 1999.4924621582031, 'EntrySMA_Long': 2025.1902075195312, 'ExitSMA_Long': 2004.3819580078125, 'entry_rsi': 59.973385116048206, 'exit_rsi': 28.608345946941213, 'EntryRSI': 59.973385116048206, 'ExitRSI': 28.608345946941213, 'rationale': 'Sell: short SMA crossed below long SMA at index 2019-09-25 00:00:00+05:30', 'Rationale': 'Sell: short SMA crossed below long SMA at index 2019-09-25 00:00:00+05:30', 'ticker': 'TCS.NS', 'context': [1993.08251953125, 1974.206787109375, 1981.9322509765625, 1989.3812255859375, 1964.0743408203125, 1978.7869873046875, 1944.9207763671875, 1911.1478271484375, 1865.20703125, 1891.94775390625, 1932.4293212890625], 'indicators': {'sma_short': 2030.4203552246095, 'sma_long': 2025.1902075195312, 'rsi': 59.973385116048206, 'atr': 41.128940479160136, 'volatility': 30.01268203463836}, 'action': 'buy', 'qty': 2826425.0}, {'entry_index': Timestamp('2019-11-11 00:00:00+0530', tz='Asia/Kolkata'), 'exit_index': Timestamp('2019-12-09 00:00:00+0530', tz='Asia/Kolkata'), 'entry_price': 1948.75732421875, 'exit_price': 1911.1910400390625, 'pnl': -45.28618090820312, 'commission_cost': 7.719896728515625, 'regime': 'ranging', 'entry_regime': 'ranging', 'exit_regime': 'ranging', 'EntryRegime': 'ranging', 'ExitRegime': 'ranging', 'volatility': 48.54074398505094, 'exit_volatility': 28.864382925161543, 'entry_volatility': 48.54074398505094, 'EntryVolatility': 48.54074398505094, 'ExitVolatility': 28.864382925161543, 'volume': 2983768.0, 'exit_volume': 2244747.0, 'entry_volume': 2983768.0, 'volume_entry': 2983768.0, 'volume_exit': 2244747.0, 'EntryVolume': 2983768.0, 'ExitVolume': 2244747.0, 'atr_entry': 45.04804706016177, 'atr_exit': 44.45522714856272, 'EntryATR': 45.04804706016177, 'ExitATR': 44.45522714856272, 'entry_sma_short': 1972.9657348632813, 'exit_sma_short': 1946.925244140625, 'entry_sma_long': 1968.3851245117187, 'exit_sma_long': 1947.0316772460938, 'EntrySMA_Short': 1972.9657348632813, 'ExitSMA_Short': 1946.925244140625, 'EntrySMA_Long': 1968.3851245117187, 'ExitSMA_Long': 1947.0316772460938, 'entry_rsi': 55.88137343786221, 'exit_rsi': 43.16217506972928, 'EntryRSI': 55.88137343786221, 'ExitRSI': 43.16217506972928, 'rationale': 'Sell: short SMA crossed below long SMA at index 2019-12-09 00:00:00+05:30', 'Rationale': 'Sell: short SMA crossed below long SMA at index 2019-12-09 00:00:00+05:30', 'ticker': 'TCS.NS', 'context': [1930.7159423828125, 1898.3909912109375, 1905.486572265625, 1926.8665771484375, 1904.5123291015625, 1874.64501953125, 1902.4259033203125, 1927.933349609375, 1967.63330078125, 1969.7666015625, 1911.1910400390625], 'indicators': {'sma_short': 1972.9657348632813, 'sma_long': 1968.3851245117187, 'rsi': 55.88137343786221, 'atr': 45.04804706016177, 'volatility': 48.54074398505094}, 'action': 'buy', 'qty': 2983768.0}, {'entry_index': Timestamp('2019-12-31 00:00:00+0530', tz='Asia/Kolkata'), 'exit_index': Timestamp('2020-02-13 00:00:00+0530', tz='Asia/Kolkata'), 'entry_price': 2005.106201171875, 'exit_price': 2037.781982421875, 'pnl': 24.5900048828125, 'commission_cost': 8.085776367187501, 'regime': 'ranging', 'entry_regime': 'ranging', 'exit_regime': 'ranging', 'EntryRegime': 'ranging', 'ExitRegime': 'ranging', 'volatility': 30.998875047161544, 'exit_volatility': 30.28562958273886, 'entry_volatility': 30.998875047161544, 'EntryVolatility': 30.998875047161544, 'ExitVolatility': 30.28562958273886, 'volume': 1909289.0, 'exit_volume': 1645948.0, 'entry_volume': 1909289.0, 'volume_entry': 1909289.0, 'volume_exit': 1645948.0, 'EntryVolume': 1909289.0, 'ExitVolume': 1645948.0, 'atr_entry': 46.01159689321325, 'atr_exit': 42.962248236659576, 'EntryATR': 46.01159689321325, 'ExitATR': 42.962248236659576, 'entry_sma_short': 1979.6820007324218, 'exit_sma_short': 2005.5753479003906, 'entry_sma_long': 1976.6256787109376, 'exit_sma_long': 2008.6999560546874, 'EntrySMA_Short': 1979.6820007324218, 'ExitSMA_Short': 2005.5753479003906, 'EntrySMA_Long': 1976.6256787109376, 'ExitSMA_Long': 2008.6999560546874, 'entry_rsi': 71.688715625006, 'exit_rsi': 51.4262672881713, 'EntryRSI': 71.688715625006, 'ExitRSI': 51.4262672881713, 'rationale': 'Buy: short SMA crossed above long SMA at index 2019-12-31 00:00:00+05:30', 'Rationale': 'Buy: short SMA crossed above long SMA at index 2019-12-31 00:00:00+05:30', 'ticker': 'TCS.NS', 'context': [1987.487060546875, 1932.8223876953125, 1954.6231689453125, 1959.504150390625, 1995.5745849609375, 1978.6551513671875, 1986.2786865234375, 2009.8922119140625, 2001.943115234375, 2018.0726318359375, 2037.781982421875], 'indicators': {'sma_short': 1979.6820007324218, 'sma_long': 1976.6256787109376, 'rsi': 71.688715625006, 'atr': 46.01159689321325, 'volatility': 30.998875047161544}, 'action': 'buy', 'qty': 1909289.0}, {'entry_index': Timestamp('2020-05-12 00:00:00+0530', tz='Asia/Kolkata'), 'exit_index': Timestamp('2021-03-02 00:00:00+0530', tz='Asia/Kolkata'), 'entry_price': 1825.62646484375, 'exit_price': 2847.40673828125, 'pnl': 1012.43420703125, 'commission_cost': 9.34606640625, 'regime': 'ranging', 'entry_regime': 'ranging', 'exit_regime': 'ranging', 'EntryRegime': 'ranging', 'ExitRegime': 'ranging', 'volatility': 44.45770449619443, 'exit_volatility': 65.20471491332768, 'entry_volatility': 44.45770449619443, 'EntryVolatility': 44.45770449619443, 'ExitVolatility': 65.20471491332768, 'volume': 3256595.0, 'exit_volume': 3306469.0, 'entry_volume': 3256595.0, 'volume_entry': 3256595.0, 'volume_exit': 3306469.0, 'EntryVolume': 3256595.0, 'ExitVolume': 3306469.0, 'atr_entry': 92.27967128874559, 'atr_exit': 72.90029215243368, 'EntryATR': 92.27967128874559, 'ExitATR': 72.90029215243368, 'entry_sma_short': 1736.7400512695312, 'exit_sma_short': 2922.1538818359377, 'entry_sma_long': 1732.641044921875, 'exit_sma_long': 2928.202958984375, 'EntrySMA_Short': 1736.7400512695312, 'ExitSMA_Short': 2922.1538818359377, 'EntrySMA_Long': 1732.641044921875, 'ExitSMA_Long': 2928.202958984375, 'entry_rsi': 68.21741591610947, 'exit_rsi': 32.6949903953263, 'EntryRSI': 68.21741591610947, 'ExitRSI': 32.6949903953263, 'rationale': 'Buy: short SMA crossed above long SMA at index 2020-05-12 00:00:00+05:30', 'Rationale': 'Buy: short SMA crossed above long SMA at index 2020-05-12 00:00:00+05:30', 'ticker': 'TCS.NS', 'context': [2944.43994140625, 2910.626953125, 2895.710693359375, 2909.443115234375, 2802.038818359375, 2822.638916015625, 2792.236083984375, 2836.940185546875, 2741.280517578125, 2769.599365234375, 2847.40673828125], 'indicators': {'sma_short': 1736.7400512695312, 'sma_long': 1732.641044921875, 'rsi': 68.21741591610947, 'atr': 92.27967128874559, 'volatility': 44.45770449619443}, 'action': 'buy', 'qty': 3256595.0}, {'entry_index': Timestamp('2021-04-07 00:00:00+0530', tz='Asia/Kolkata'), 'exit_index': Timestamp('2021-05-17 00:00:00+0530', tz='Asia/Kolkata'), 'entry_price': 3098.44287109375, 'exit_price': 2907.45458984375, 'pnl': -203.000076171875, 'commission_cost': 12.011794921875, 'regime': 'ranging', 'entry_regime': 'ranging', 'exit_regime': 'ranging', 'EntryRegime': 'ranging', 'ExitRegime': 'ranging', 'volatility': 67.14859585359592, 'exit_volatility': 37.31778591246115, 'entry_volatility': 67.14859585359592, 'EntryVolatility': 67.14859585359592, 'ExitVolatility': 37.31778591246115, 'volume': 2491268.0, 'exit_volume': 2890462.0, 'entry_volume': 2491268.0, 'volume_entry': 2491268.0, 'volume_exit': 2890462.0, 'EntryVolume': 2491268.0, 'ExitVolume': 2890462.0, 'atr_entry': 74.45298367857532, 'atr_exit': 67.52475255904574, 'EntryATR': 74.45298367857532, 'ExitATR': 67.52475255904574, 'entry_sma_short': 2953.34521484375, 'exit_sma_short': 2942.798962402344, 'entry_sma_long': 2949.221904296875, 'exit_sma_long': 2950.5383984375, 'EntrySMA_Short': 2953.34521484375, 'ExitSMA_Short': 2942.798962402344, 'EntrySMA_Long': 2949.221904296875, 'ExitSMA_Long': 2950.5383984375, 'entry_rsi': 66.28307101280075, 'exit_rsi': 45.55992725144182, 'EntryRSI': 66.28307101280075, 'ExitRSI': 45.55992725144182, 'rationale': 'Sell: short SMA crossed below long SMA at index 2021-05-17 00:00:00+05:30', 'Rationale': 'Sell: short SMA crossed below long SMA at index 2021-05-17 00:00:00+05:30', 'ticker': 'TCS.NS', 'context': [2875.1572265625, 2876.436279296875, 2888.51171875, 2932.032470703125, 2946.949462890625, 2967.265380859375, 2979.199951171875, 2957.510498046875, 2924.360595703125, 2890.169189453125, 2907.45458984375], 'indicators': {'sma_short': 2953.34521484375, 'sma_long': 2949.221904296875, 'rsi': 66.28307101280075, 'atr': 74.45298367857532, 'volatility': 67.14859585359592}, 'action': 'buy', 'qty': 2491268.0}, {'entry_index': Timestamp('2021-06-11 00:00:00+0530', tz='Asia/Kolkata'), 'exit_index': Timestamp('2021-07-30 00:00:00+0530', tz='Asia/Kolkata'), 'entry_price': 3115.8837890625, 'exit_price': 3021.24267578125, 'pnl': -106.9153662109375, 'commission_cost': 12.274252929687501, 'regime': 'ranging', 'entry_regime': 'ranging', 'exit_regime': 'ranging', 'EntryRegime': 'ranging', 'ExitRegime': 'ranging', 'volatility': 41.18331996931355, 'exit_volatility': 13.367823766267437, 'entry_volatility': 41.18331996931355, 'EntryVolatility': 41.18331996931355, 'ExitVolatility': 13.367823766267437, 'volume': 3452954.0, 'exit_volume': 2999943.0, 'entry_volume': 3452954.0, 'volume_entry': 3452954.0, 'volume_exit': 2999943.0, 'EntryVolume': 3452954.0, 'ExitVolume': 2999943.0, 'atr_entry': 57.76879797213847, 'atr_exit': 48.310584024513794, 'EntryATR': 57.76879797213847, 'ExitATR': 48.310584024513794, 'entry_sma_short': 2987.0900146484373, 'exit_sma_short': 3068.5420166015624, 'entry_sma_long': 2985.9955224609375, 'exit_sma_long': 3072.1698193359375, 'EntrySMA_Short': 2987.0900146484373, 'ExitSMA_Short': 3068.5420166015624, 'EntrySMA_Long': 2985.9955224609375, 'ExitSMA_Long': 3072.1698193359375, 'entry_rsi': 80.5303636474911, 'exit_rsi': 40.676363245116555, 'EntryRSI': 80.5303636474911, 'ExitRSI': 40.676363245116555, 'rationale': 'Sell: short SMA crossed below long SMA at index 2021-07-30 00:00:00+05:30', 'Rationale': 'Sell: short SMA crossed below long SMA at index 2021-07-30 00:00:00+05:30', 'ticker': 'TCS.NS', 'context': [3055.10400390625, 3047.330810546875, 3037.600830078125, 3057.822265625, 3067.8857421875, 3064.547119140625, 3049.953857421875, 3036.027099609375, 3050.19189453125, 3048.284423828125, 3021.24267578125], 'indicators': {'sma_short': 2987.0900146484373, 'sma_long': 2985.9955224609375, 'rsi': 80.5303636474911, 'atr': 57.76879797213847, 'volatility': 41.18331996931355}, 'action': 'buy', 'qty': 3452954.0}, {'entry_index': Timestamp('2021-08-16 00:00:00+0530', tz='Asia/Kolkata'), 'exit_index': Timestamp('2021-10-25 00:00:00+0530', tz='Asia/Kolkata'), 'entry_price': 3312.640869140625, 'exit_price': 3338.1103515625, 'pnl': 12.16797998046875, 'commission_cost': 13.30150244140625, 'regime': 'trending', 'entry_regime': 'trending', 'exit_regime': 'ranging', 'EntryRegime': 'trending', 'ExitRegime': 'ranging', 'volatility': 73.15600951783601, 'exit_volatility': 112.42891950059735, 'entry_volatility': 73.15600951783601, 'EntryVolatility': 73.15600951783601, 'ExitVolatility': 112.42891950059735, 'volume': 2083489.0, 'exit_volume': 2595594.0, 'entry_volume': 2083489.0, 'volume_entry': 2083489.0, 'volume_exit': 2595594.0, 'EntryVolume': 2083489.0, 'ExitVolume': 2595594.0, 'atr_entry': 50.40535237468853, 'atr_exit': 77.03893444146293, 'EntryATR': 50.40535237468853, 'ExitATR': 77.03893444146293, 'entry_sma_short': 3120.1106567382812, 'exit_sma_short': 3540.054235839844, 'entry_sma_long': 3115.688271484375, 'exit_sma_long': 3554.2244677734375, 'EntrySMA_Short': 3120.1106567382812, 'ExitSMA_Short': 3540.054235839844, 'EntrySMA_Long': 3115.688271484375, 'ExitSMA_Long': 3554.2244677734375, 'entry_rsi': 88.91574078017644, 'exit_rsi': 30.980367041678235, 'EntryRSI': 88.91574078017644, 'ExitRSI': 30.980367041678235, 'rationale': 'Buy: short SMA crossed above long SMA at index 2021-08-16 00:00:00+05:30', 'Rationale': 'Buy: short SMA crossed above long SMA at index 2021-08-16 00:00:00+05:30', 'ticker': 'TCS.NS', 'context': [3753.98291015625, 3515.4755859375, 3484.237060546875, 3486.47802734375, 3451.35791015625, 3485.47509765625, 3473.051025390625, 3448.873046875, 3375.907958984375, 3343.7490234375, 3338.1103515625], 'indicators': {'sma_short': 3120.1106567382812, 'sma_long': 3115.688271484375, 'rsi': 88.91574078017644, 'atr': 50.40535237468853, 'volatility': 73.15600951783601}, 'action': 'buy', 'qty': 2083489.0}, {'entry_index': Timestamp('2021-12-20 00:00:00+0530', tz='Asia/Kolkata'), 'exit_index': Timestamp('2022-02-22 00:00:00+0530', tz='Asia/Kolkata'), 'entry_price': 3399.225341796875, 'exit_price': 3433.440673828125, 'pnl': 20.549999999999997, 'commission_cost': 13.665332031250001, 'regime': 'ranging', 'entry_regime': 'ranging', 'exit_regime': 'ranging', 'EntryRegime': 'ranging', 'ExitRegime': 'ranging', 'volatility': 29.699406136453703, 'exit_volatility': 62.88385506011072, 'entry_volatility': 29.699406136453703, 'EntryVolatility': 29.699406136453703, 'ExitVolatility': 62.88385506011072, 'volume': 2312310.0, 'exit_volume': 5408531.0, 'entry_volume': 2312310.0, 'volume_entry': 2312310.0, 'volume_exit': 5408531.0, 'EntryVolume': 2312310.0, 'ExitVolume': 5408531.0, 'atr_entry': 66.38589311772309, 'atr_exit': 71.5409834641629, 'EntryATR': 66.38589311772309, 'ExitATR': 71.5409834641629, 'entry_sma_short': 3402.4559692382813, 'exit_sma_short': 3596.7, 'entry_sma_long': 3399.1990625, 'exit_sma_long': 3602.088857421875, 'EntrySMA_Short': 3402.4559692382813, 'ExitSMA_Short': 3596.7, 'EntrySMA_Long': 3399.1990625, 'ExitSMA_Long': 3602.088857421875, 'entry_rsi': 52.73584801113037, 'exit_rsi': 27.085050741422123, 'EntryRSI': 52.73584801113037, 'ExitRSI': 27.085050741422123, 'rationale': 'Buy: short SMA crossed above long SMA at index 2021-12-20 00:00:00+05:30', 'Rationale': 'Buy: short SMA crossed above long SMA at index 2021-12-20 00:00:00+05:30', 'ticker': 'TCS.NS', 'context': [3583.792724609375, 3600.163330078125, 3609.545166015625, 3537.361083984375, 3574.506103515625, 3654.971923828125, 3650.471923828125, 3622.804931640625, 3632.090576171875, 3560.76806640625, 3433.440673828125], 'indicators': {'sma_short': 3402.4559692382813, 'sma_long': 3399.1990625, 'rsi': 52.73584801113037, 'atr': 66.38589311772309, 'volatility': 29.699406136453703}, 'action': 'buy', 'qty': 2312310.0}, {'entry_index': Timestamp('2022-04-06 00:00:00+0530', tz='Asia/Kolkata'), 'exit_index': Timestamp('2022-04-29 00:00:00+0530', tz='Asia/Kolkata'), 'entry_price': 3595.1845703125, 'exit_price': 3395.433837890625, 'pnl': -213.73196923828124, 'commission_cost': 13.98123681640625, 'regime': 'ranging', 'entry_regime': 'ranging', 'exit_regime': 'ranging', 'EntryRegime': 'ranging', 'ExitRegime': 'ranging', 'volatility': 32.210665100125425, 'exit_volatility': 49.81421720666413, 'entry_volatility': 32.210665100125425, 'EntryVolatility': 32.210665100125425, 'ExitVolatility': 49.81421720666413, 'volume': 2051729.0, 'exit_volume': 2051115.0, 'entry_volume': 2051729.0, 'volume_entry': 2051729.0, 'volume_exit': 2051115.0, 'EntryVolume': 2051729.0, 'ExitVolume': 2051115.0, 'atr_entry': 73.34448232406695, 'atr_exit': 74.4885086285055, 'EntryATR': 73.34448232406695, 'ExitATR': 74.4885086285055, 'entry_sma_short': 3537.3801147460936, 'exit_sma_short': 3486.817626953125, 'entry_sma_long': 3533.570859375, 'exit_sma_long': 3487.7846044921876, 'EntrySMA_Short': 3537.3801147460936, 'ExitSMA_Short': 3486.817626953125, 'EntrySMA_Long': 3533.570859375, 'ExitSMA_Long': 3487.7846044921876, 'entry_rsi': 62.43280242654096, 'exit_rsi': 37.53740630215552, 'EntryRSI': 62.43280242654096, 'ExitRSI': 37.53740630215552, 'rationale': 'Sell: short SMA crossed below long SMA at index 2022-04-29 00:00:00+05:30', 'Rationale': 'Sell: short SMA crossed below long SMA at index 2022-04-29 00:00:00+05:30', 'ticker': 'TCS.NS', 'context': [3505.768310546875, 3377.579345703125, 3323.82373046875, 3405.102783203125, 3473.888671875, 3458.4755859375, 3396.8701171875, 3395.051025390625, 3409.3154296875, 3431.429931640625, 3395.433837890625], 'indicators': {'sma_short': 3537.3801147460936, 'sma_long': 3533.570859375, 'rsi': 62.43280242654096, 'atr': 73.34448232406695, 'volatility': 32.210665100125425}, 'action': 'buy', 'qty': 2051729.0}, {'entry_index': Timestamp('2022-08-12 00:00:00+0530', tz='Asia/Kolkata'), 'exit_index': Timestamp('2022-09-15 00:00:00+0530', tz='Asia/Kolkata'), 'entry_price': 3287.064208984375, 'exit_price': 2999.866943359375, 'pnl': -299.7711279296875, 'commission_cost': 12.5738623046875, 'regime': 'trending', 'entry_regime': 'trending', 'exit_regime': 'ranging', 'EntryRegime': 'trending', 'ExitRegime': 'ranging', 'volatility': 47.90023527071091, 'exit_volatility': 46.694623049524694, 'entry_volatility': 47.90023527071091, 'EntryVolatility': 47.90023527071091, 'ExitVolatility': 46.694623049524694, 'volume': 1472354.0, 'exit_volume': 2138023.0, 'entry_volume': 1472354.0, 'volume_entry': 1472354.0, 'volume_exit': 2138023.0, 'EntryVolume': 1472354.0, 'ExitVolume': 2138023.0, 'atr_entry': 69.46224829311399, 'atr_exit': 60.24547618296845, 'EntryATR': 69.46224829311399, 'ExitATR': 60.24547618296845, 'entry_sma_short': 3134.9230102539063, 'exit_sma_short': 3102.0625122070314, 'entry_sma_long': 3132.5360107421875, 'exit_sma_long': 3113.2832373046876, 'EntrySMA_Short': 3134.9230102539063, 'ExitSMA_Short': 3102.0625122070314, 'EntrySMA_Long': 3132.5360107421875, 'ExitSMA_Long': 3113.2832373046876, 'entry_rsi': 76.0068146945699, 'exit_rsi': 38.98615772509217, 'EntryRSI': 76.0068146945699, 'ExitRSI': 38.98615772509217, 'rationale': 'Sell: short SMA crossed below long SMA at index 2022-09-15 00:00:00+05:30', 'Rationale': 'Sell: short SMA crossed below long SMA at index 2022-09-15 00:00:00+05:30', 'ticker': 'TCS.NS', 'context': [3026.29638671875, 3025.0400390625, 3027.939208984375, 3021.80322265625, 3043.59375, 3062.96923828125, 3109.35302734375, 3133.80224609375, 3120.659423828125, 3015.376220703125, 2999.866943359375], 'indicators': {'sma_short': 3134.9230102539063, 'sma_long': 3132.5360107421875, 'rsi': 76.0068146945699, 'atr': 69.46224829311399, 'volatility': 47.90023527071091}, 'action': 'buy', 'qty': 1472354.0}, {'entry_index': Timestamp('2022-11-02 00:00:00+0530', tz='Asia/Kolkata'), 'exit_index': Timestamp('2023-01-02 00:00:00+0530', tz='Asia/Kolkata'), 'entry_price': 3140.701416015625, 'exit_price': 3159.836181640625, 'pnl': 6.5336904296875, 'commission_cost': 12.6010751953125, 'regime': 'ranging', 'entry_regime': 'ranging', 'exit_regime': 'ranging', 'EntryRegime': 'ranging', 'ExitRegime': 'ranging', 'volatility': 41.28437583879449, 'exit_volatility': 19.16248878088338, 'entry_volatility': 41.28437583879449, 'EntryVolatility': 41.28437583879449, 'ExitVolatility': 19.16248878088338, 'volume': 1405955.0, 'exit_volume': 709547.0, 'entry_volume': 1405955.0, 'volume_entry': 1405955.0, 'volume_exit': 709547.0, 'EntryVolume': 1405955.0, 'ExitVolume': 709547.0, 'atr_entry': 58.008347366658384, 'atr_exit': 51.64712527112506, 'EntryATR': 58.008347366658384, 'ExitATR': 51.64712527112506, 'entry_sma_short': 3037.2004638671874, 'exit_sma_short': 3182.5312255859376, 'entry_sma_long': 3022.67310546875, 'exit_sma_long': 3187.22431640625, 'EntrySMA_Short': 3037.2004638671874, 'ExitSMA_Short': 3182.5312255859376, 'EntrySMA_Long': 3022.67310546875, 'ExitSMA_Long': 3187.22431640625, 'entry_rsi': 75.84824473946581, 'exit_rsi': 40.328483897652, 'EntryRSI': 75.84824473946581, 'ExitRSI': 40.328483897652, 'rationale': 'Buy: short SMA crossed above long SMA at index 2022-11-02 00:00:00+05:30', 'Rationale': 'Buy: short SMA crossed above long SMA at index 2022-11-02 00:00:00+05:30', 'ticker': 'TCS.NS', 'context': [3102.28662109375, 3142.881103515625, 3166.71484375, 3158.140380859375, 3127.767578125, 3151.552490234375, 3157.94677734375, 3155.62158203125, 3166.908447265625, 3155.234130859375, 3159.836181640625], 'indicators': {'sma_short': 3037.2004638671874, 'sma_long': 3022.67310546875, 'rsi': 75.84824473946581, 'atr': 58.008347366658384, 'volatility': 41.28437583879449}, 'action': 'buy', 'qty': 1405955.0}, {'entry_index': Timestamp('2023-01-25 00:00:00+0530', tz='Asia/Kolkata'), 'exit_index': Timestamp('2023-03-15 00:00:00+0530', tz='Asia/Kolkata'), 'entry_price': 3330.788818359375, 'exit_price': 3106.599365234375, 'pnl': -237.0642294921875, 'commission_cost': 12.8747763671875, 'regime': 'ranging', 'entry_regime': 'ranging', 'exit_regime': 'ranging', 'EntryRegime': 'ranging', 'ExitRegime': 'ranging', 'volatility': 38.55979038609464, 'exit_volatility': 61.39422761490684, 'entry_volatility': 38.55979038609464, 'EntryVolatility': 38.55979038609464, 'ExitVolatility': 61.39422761490684, 'volume': 874110.0, 'exit_volume': 1780522.0, 'entry_volume': 874110.0, 'volume_entry': 874110.0, 'volume_exit': 1780522.0, 'EntryVolume': 874110.0, 'ExitVolume': 1780522.0, 'atr_entry': 55.24870187498369, 'atr_exit': 60.21204107209431, 'EntryATR': 55.24870187498369, 'ExitATR': 60.21204107209431, 'entry_sma_short': 3234.1728271484376, 'exit_sma_short': 3280.2333374023438, 'entry_sma_long': 3227.5533447265625, 'exit_sma_long': 3291.4743115234373, 'EntrySMA_Short': 3234.1728271484376, 'ExitSMA_Short': 3280.2333374023438, 'EntrySMA_Long': 3227.5533447265625, 'ExitSMA_Long': 3291.4743115234373, 'entry_rsi': 62.071291660569365, 'exit_rsi': 30.161492762111962, 'EntryRSI': 62.071291660569365, 'ExitRSI': 30.161492762111962, 'rationale': 'Sell: short SMA crossed below long SMA at index 2023-03-15 00:00:00+05:30', 'Rationale': 'Sell: short SMA crossed below long SMA at index 2023-03-15 00:00:00+05:30', 'ticker': 'TCS.NS', 'context': [3217.261962890625, 3288.009765625, 3225.613525390625, 3245.71630859375, 3274.559326171875, 3292.573974609375, 3240.5693359375, 3234.887939453125, 3187.253173828125, 3122.186767578125, 3106.599365234375], 'indicators': {'sma_short': 3234.1728271484376, 'sma_long': 3227.5533447265625, 'rsi': 62.071291660569365, 'atr': 55.24870187498369, 'volatility': 38.55979038609464}, 'action': 'buy', 'qty': 874110.0}, {'entry_index': Timestamp('2023-05-18 00:00:00+0530', tz='Asia/Kolkata'), 'exit_index': Timestamp('2023-07-03 00:00:00+0530', tz='Asia/Kolkata'), 'entry_price': 3107.522216796875, 'exit_price': 3201.515869140625, 'pnl': 81.375576171875, 'commission_cost': 12.618076171875, 'regime': 'ranging', 'entry_regime': 'ranging', 'exit_regime': 'ranging', 'EntryRegime': 'ranging', 'ExitRegime': 'ranging', 'volatility': 30.133503520741414, 'exit_volatility': 37.034165375510774, 'entry_volatility': 30.133503520741414, 'EntryVolatility': 30.133503520741414, 'ExitVolatility': 37.034165375510774, 'volume': 1369364.0, 'exit_volume': 1687264.0, 'entry_volume': 1369364.0, 'volume_entry': 1369364.0, 'volume_exit': 1687264.0, 'EntryVolume': 1369364.0, 'ExitVolume': 1687264.0, 'atr_entry': 52.75655551755595, 'atr_exit': 42.887854835139386, 'EntryATR': 52.75655551755595, 'ExitATR': 42.887854835139386, 'entry_sma_short': 3125.69970703125, 'exit_sma_short': 3155.7790771484374, 'entry_sma_long': 3120.51716796875, 'exit_sma_long': 3157.339384765625, 'EntrySMA_Short': 3125.69970703125, 'ExitSMA_Short': 3155.7790771484374, 'EntrySMA_Long': 3120.51716796875, 'ExitSMA_Long': 3157.339384765625, 'entry_rsi': 52.19557582380476, 'exit_rsi': 56.913993916417844, 'EntryRSI': 52.19557582380476, 'ExitRSI': 56.913993916417844, 'rationale': 'Buy: short SMA crossed above long SMA at index 2023-05-18 00:00:00+05:30', 'Rationale': 'Buy: short SMA crossed above long SMA at index 2023-05-18 00:00:00+05:30', 'ticker': 'TCS.NS', 'context': [3106.222900390625, 3140.955078125, 3157.881103515625, 3187.72119140625, 3168.447509765625, 3146.776611328125, 3120.65380859375, 3128.187744140625, 3145.89599609375, 3230.818603515625, 3201.515869140625], 'indicators': {'sma_short': 3125.69970703125, 'sma_long': 3120.51716796875, 'rsi': 52.19557582380476, 'atr': 52.75655551755595, 'volatility': 30.133503520741414}, 'action': 'buy', 'qty': 1369364.0}, {'entry_index': Timestamp('2023-07-07 00:00:00+0530', tz='Asia/Kolkata'), 'exit_index': Timestamp('2023-11-02 00:00:00+0530', tz='Asia/Kolkata'), 'entry_price': 3257.234130859375, 'exit_price': 3304.493896484375, 'pnl': 34.1363095703125, 'commission_cost': 13.1234560546875, 'regime': 'ranging', 'entry_regime': 'ranging', 'exit_regime': 'ranging', 'EntryRegime': 'ranging', 'ExitRegime': 'ranging', 'volatility': 53.266358183328926, 'exit_volatility': 55.993446625605145, 'entry_volatility': 53.266358183328926, 'EntryVolatility': 53.266358183328926, 'ExitVolatility': 55.993446625605145, 'volume': 1789326.0, 'exit_volume': 1245384.0, 'entry_volume': 1789326.0, 'volume_entry': 1789326.0, 'volume_exit': 1245384.0, 'EntryVolume': 1789326.0, 'ExitVolume': 1245384.0, 'atr_entry': 42.006077640903804, 'atr_exit': 50.81962916803139, 'EntryATR': 42.006077640903804, 'ExitATR': 50.81962916803139, 'entry_sma_short': 3172.6368041992187, 'exit_sma_short': 3417.672473144531, 'entry_sma_long': 3170.3512255859373, 'exit_sma_long': 3420.3335302734376, 'EntrySMA_Short': 3172.6368041992187, 'ExitSMA_Short': 3417.672473144531, 'EntrySMA_Long': 3170.3512255859373, 'ExitSMA_Long': 3420.3335302734376, 'entry_rsi': 71.96517628476015, 'exit_rsi': 30.746314430245974, 'EntryRSI': 71.96517628476015, 'ExitRSI': 30.746314430245974, 'rationale': 'Buy: short SMA crossed above long SMA at index 2023-07-07 00:00:00+05:30', 'Rationale': 'Buy: short SMA crossed above long SMA at index 2023-07-07 00:00:00+05:30', 'ticker': 'TCS.NS', 'context': [3420.688232421875, 3398.462646484375, 3436.718994140625, 3353.71533203125, 3333.997314453125, 3281.530029296875, 3295.4951171875, 3322.638671875, 3313.00048828125, 3275.531005859375, 3304.493896484375], 'indicators': {'sma_short': 3172.6368041992187, 'sma_long': 3170.3512255859373, 'rsi': 71.96517628476015, 'atr': 42.006077640903804, 'volatility': 53.266358183328926}, 'action': 'buy', 'qty': 1789326.0}, {'entry_index': Timestamp('2023-12-08 00:00:00+0530', tz='Asia/Kolkata'), 'exit_index': Timestamp('2024-04-05 00:00:00+0530', tz='Asia/Kolkata'), 'entry_price': 3566.681884765625, 'exit_price': 3922.443359375, 'pnl': 340.7832241210937, 'commission_cost': 14.978250488281251, 'regime': 'ranging', 'entry_regime': 'ranging', 'exit_regime': 'ranging', 'EntryRegime': 'ranging', 'ExitRegime': 'ranging', 'volatility': 57.44747338604715, 'exit_volatility': 51.82343194469709, 'entry_volatility': 57.44747338604715, 'EntryVolatility': 57.44747338604715, 'ExitVolatility': 51.82343194469709, 'volume': 1641155.0, 'exit_volume': 1636819.0, 'entry_volume': 1641155.0, 'volume_entry': 1641155.0, 'volume_exit': 1636819.0, 'EntryVolume': 1641155.0, 'ExitVolume': 1636819.0, 'atr_entry': 50.72764380146919, 'atr_exit': 84.18179831226074, 'EntryATR': 50.72764380146919, 'ExitATR': 84.18179831226074, 'entry_sma_short': 3432.9939453125, 'exit_sma_short': 3961.2807739257814, 'entry_sma_long': 3423.1778759765625, 'exit_sma_long': 3961.7322509765627, 'EntrySMA_Short': 3432.9939453125, 'ExitSMA_Short': 3961.2807739257814, 'EntrySMA_Long': 3423.1778759765625, 'ExitSMA_Long': 3961.7322509765627, 'entry_rsi': 68.19444888748004, 'exit_rsi': 32.338183796541074, 'EntryRSI': 68.19444888748004, 'ExitRSI': 32.338183796541074, 'rationale': 'Buy: short SMA crossed above long SMA at index 2023-12-08 00:00:00+05:30', 'Rationale': 'Buy: short SMA crossed above long SMA at index 2023-12-08 00:00:00+05:30', 'ticker': 'TCS.NS', 'context': [3914.21240234375, 3916.233154296875, 3855.069091796875, 3822.145751953125, 3786.068115234375, 3820.962890625, 3860.83544921875, 3828.35595703125, 3890.949462890625, 3946.14990234375, 3922.443359375], 'indicators': {'sma_short': 3432.9939453125, 'sma_long': 3423.1778759765625, 'rsi': 68.19444888748004, 'atr': 50.72764380146919, 'volatility': 57.44747338604715}, 'action': 'buy', 'qty': 1641155.0}, {'entry_index': Timestamp('2024-07-02 00:00:00+0530', tz='Asia/Kolkata'), 'exit_index': Timestamp('2024-10-04 00:00:00+0530', tz='Asia/Kolkata'), 'entry_price': 3988.830810546875, 'exit_price': 4231.81689453125, 'pnl': 226.54478857421876, 'commission_cost': 16.44129541015625, 'regime': 'trending', 'entry_regime': 'trending', 'exit_regime': 'ranging', 'EntryRegime': 'trending', 'ExitRegime': 'ranging', 'volatility': 77.39997163923952, 'exit_volatility': 21.201782227182264, 'entry_volatility': 77.39997163923952, 'EntryVolatility': 77.39997163923952, 'ExitVolatility': 21.201782227182264, 'volume': 2307449.0, 'exit_volume': 2965463.0, 'entry_volume': 2307449.0, 'volume_entry': 2307449.0, 'volume_exit': 2965463.0, 'EntryVolume': 2307449.0, 'ExitVolume': 2965463.0, 'atr_entry': 68.00283621938388, 'atr_exit': 79.29424334589821, 'EntryATR': 68.00283621938388, 'ExitATR': 79.29424334589821, 'entry_sma_short': 3822.534533691406, 'exit_sma_short': 4330.551202148437, 'entry_sma_long': 3815.7201806640624, 'exit_sma_long': 4338.532907421875, 'EntrySMA_Short': 3822.534533691406, 'ExitSMA_Short': 4330.551202148437, 'EntrySMA_Long': 3815.7201806640624, 'ExitSMA_Long': 4338.532907421875, 'entry_rsi': 68.44863139071735, 'exit_rsi': 21.825197198152495, 'EntryRSI': 68.44863139071735, 'ExitRSI': 21.825197198152495, 'rationale': 'Buy: short SMA crossed above long SMA at index 2024-07-02 00:00:00+05:30', 'Rationale': 'Buy: short SMA crossed above long SMA at index 2024-07-02 00:00:00+05:30', 'ticker': 'TCS.NS', 'context': [4275.50537109375, 4264.3095703125, 4247.98876953125, 4250.77490234375, 4254.208984375, 4271.873046875, 4287.99560546875, 4247.98876953125, 4267.29541015625, 4212.41064453125, 4231.81689453125], 'indicators': {'sma_short': 3822.534533691406, 'sma_long': 3815.7201806640624, 'rsi': 68.44863139071735, 'atr': 68.00283621938388, 'volatility': 77.39997163923952}, 'action': 'buy', 'qty': 2307449.0}, {'entry_index': Timestamp('2024-12-03 00:00:00+0530', tz='Asia/Kolkata'), 'exit_index': Timestamp('2025-01-09 00:00:00+0530', tz='Asia/Kolkata'), 'entry_price': 4292.5205078125, 'exit_price': 4029.248291015625, 'pnl': -279.91575439453123, 'commission_cost': 16.643537597656252, 'regime': 'ranging', 'entry_regime': 'ranging', 'exit_regime': 'ranging', 'EntryRegime': 'ranging', 'ExitRegime': 'ranging', 'volatility': 121.1025508120866, 'exit_volatility': 50.269203375669775, 'entry_volatility': 121.1025508120866, 'EntryVolatility': 121.1025508120866, 'ExitVolatility': 50.269203375669775, 'volume': 2010905.0, 'exit_volume': 2392472.0, 'entry_volume': 2010905.0, 'volume_entry': 2010905.0, 'volume_exit': 2392472.0, 'EntryVolume': 2010905.0, 'ExitVolume': 2392472.0, 'atr_entry': 79.03150472629727, 'atr_exit': 89.05119208920703, 'EntryATR': 79.03150472629727, 'ExitATR': 89.05119208920703, 'entry_sma_short': 4166.939904785157, 'exit_sma_short': 4190.464346679687, 'entry_sma_long': 4155.905068359375, 'exit_sma_long': 4194.207292773437, 'EntrySMA_Short': 4166.939904785157, 'ExitSMA_Short': 4190.464346679687, 'EntrySMA_Long': 4155.905068359375, 'ExitSMA_Long': 4194.207292773437, 'entry_rsi': 57.67270414755591, 'exit_rsi': 30.49954028778599, 'EntryRSI': 57.67270414755591, 'ExitRSI': 30.49954028778599, 'rationale': 'Sell: short SMA crossed below long SMA at index 2025-01-09 00:00:00+05:30', 'Rationale': 'Sell: short SMA crossed below long SMA at index 2025-01-09 00:00:00+05:30', 'ticker': 'TCS.NS', 'context': [4159.1884765625, 4154.94873046875, 4148.91259765625, 4085.065185546875, 4102.67333984375, 4165.82275390625, 4090.15283203125, 4085.2646484375, 4018.72314453125, 4098.6328125, 4029.248291015625], 'indicators': {'sma_short': 4166.939904785157, 'sma_long': 4155.905068359375, 'rsi': 57.67270414755591, 'atr': 79.03150472629727, 'volatility': 121.1025508120866}, 'action': 'buy', 'qty': 2010905.0}], 'equity_curve': [10000, 10000, 10000, 10000, 10000, 10000, 10000, 10000, 10000, 10000, 10000, 10000, 10000, 10000, 10000, 10000, 10000, 10000, 10000, 10000, 10000, 10000, 10000, 10000, 10000, 10000, 10000, 10000, 10000, 10000, 10000, 10000, 10000, 10000, 10000, 10000, 10000, 10000, 10000, 10000, 10000, 10000, 10000, 10000, 10000, 10000, 10000, 10000, 10000, 10000, 10000, 10000, 10000, 10000, 10000, 10000, 10000, 10000, 10000, 10000, 10000, 10000, 10000, 10000, 10000, 10000, 10000, 10000, 10000, 10000, 10000, 10000, 10000, 10000, 10000, 10000, 10000, 10000, 10000, 10000, 10000, 10000, 10000, 10000, 10000, 10000, 10000, 10000, 10000, 10000, 10000, 10000, 10000, 10000, 10000, 10000, 10000, 10000, 10000, 10000, 10000, 10000, 10000, 10000, 10000, 10000, 10000, 10000, 10000, 10000, 10000, 10000, 10000, 10000, 10000, 10000, 10000, 10000, 10000, 10000, 10000, 10000, 10000, 10000, 10000, 10000, 10000, 10000, 10000, 10000, 10000, 10000, 10000, 10000, 10000, 10000, 10000, 10000, 10000, 10000, 10000, 10000, 10000, 10000, 10000, 10000, 10000, 10000, 10000, 10000, 10000, 10000, 10000, 10000, 10000, 10000, 10000, 10000, 10000, 10000, 10000, 10000, 10000, 10000, 10000, 10000, 10000, 10000, 10000, 10000, 10000, 10000, 10000, 10000, 10000, 10000, 10000, 10000, 10000, 10000, 10000, 10000, 10000, 10000, 10000, 10000, 10000, 10000, 10000, 10000, 10000, 10000, 10000, 10000, 10000, 10000, 10000, 10000, 10000, 10000, 10000, 10000, 10000, 10000, 10000, 10000, 10000, 10000, 10000, 10000, 10000, 10000, 10000, 10000, 10000, 10000, 10000, 10000, 10000, 10000, 10000, 10000, 10000, 10000, 10000, 10000, 10000, 10000, 10000, 10000, 10000, 10000, 10000, 10000, 10000, 10000, 10000, 10000, 10000, 10000, 10000, 10000, 10000, 10000, 10000, 10000, 10000, 10000, 10000, 10000, 10000, 10000, 10000, 10000, 10000, 10000, 10000, 10000, 10000, 10000, 10000, 10000, 10000, 10000, 10000, 10000, 10000, 10000, 10000, 10000, 10000, 10000, 10000, 10000, 10000, 10000, 10000, 10000, 10000, 10000, 10000, 10000, 10000, 10000, 10000, 10000, 10000, 10000, 10000, 10000, 10000, 10000, 10000, 10000, 10000, 10000, 10000, 10000, 10000, 10000, 10000, 10000, 10000, 10000, 10000, 10000, 10000, 10000, 10000, 10000, 10000, 10000, 10000, 10000, 10000, 10000, 10000, 10000, 10000, 10000, 10000, 10000, 10000, 10000, 10000, 10000, 10000, 10000, 10000, 10000, 10000, 10000, 10000, 10000, 10000, 10000, 10000, 10000, 10000, 10000, 10000, 10000, 10000, 10000, 10000, 10000, 10000, 10000, 10000, 10000, 10000, 10000, 10000, 10000, 10000, 10000, 10000, 10000, 10000, 10000, 10000, 10000, 10000, 10000, 10000, 10000, 10000, 10000, 10000, 10000, 10000, 10000, 10000, 10000, 10000, 10000, 10000, 10000, 10000, 10000, 10000, 10000, 10000, 10000, 10000, 10000, 10000, 10000, 10000, 10000, 10000, 10000, 10000, 10000, 10000, 10000, 10000, 10000, 10000, 10000, 10000, 10000, 10000, 10000, 10000, 10000, 10000, 10000, 10000, 10000, 10000, 10000, 10000, 10000, 10000, 10000, 10000, 10000, 10000, 10000, 10000, 10000, 10000, 10000, 10000, 10000, 10000, 10000, 10000, 10000, 10000, 10000, 10000, 10000, 10000, 10000, 10000, 10000, 10000, 10000, 10000, 10000, 10000, 10000, 10000, 10000, 10000, 10000, 10000, 10000, 10000, 10000, 10000, 10000, 10000, 10000, 10000, 10000, 10000, 10000, 10000, 10000, 10000, 10000, 10000, 10000, 10000, 10000, 10000, 10000, 10000, 10000, 10000, 10000, 10000, 10000, 10000, 10000, 10000, 10000, 10000, 10000, 10000, 10000, 10000, 10000, 10000, 10000, 10000, 10000, 10000, 10000, 10000, 10000, 10000, 10000, 10000, 10000, 10000, 10000, 10000, 10000, 10000, 10000, 10000, 10000, 10000, 10000, 10000, 10000, 10000, 10000, 10000, 10000, 10000, 10000, 10000, 10000, 10000, 10000, 10000, 10000, 10000, 10000, 10000, 10000, 10000, 10000, 10000, 10000, 10000, 10000, 10000, 10000, 10000, 10000, 10000, 10000, 10000, 10000, 10000, 10000, 10000, 10000, 10000, 10000, 10000, 10000, 10000, 10000, 10000, 10000, 10000, 10000, 10000, 10000, 10000, 10000, 10000, 10000, 10000, 10000, 10000, 10000, 10000, 10000, 10000, 10000, 10000, 10000, 10000, 10000, 10000, 10000, 10000, 10000, 10000, 10000, 10000, 10000, 10000, 10000, 10000, 10000, 10000, 10000, 10000, 10000, 10000, 10000, 10000, 10000, 10000, 10000, 10000, 10000, 10000, 10000, 10000, 10000, 10000, 10000, 10000, 10000, 10000, 10000, 10000, 10000, 10000, 10000, 10000, 10000, 10000, 10000, 10000, 10000, 10000, 10000, 10000, 10000, 10000, 10000, 10000, 10000, 10000, 10000, 10000, 10000, 10000, 10000, 10000, 10000, 10000, 10000, 10000, 10000, 10000, 10000, 10000, 10000, 10000, 10000, 10000, 10000, 10000, 10000, 10000, 10000, 10000, 10000, 10000, 10000, 10000, 10000, 10000, 10000, 10000, 10000, 10000, 10000, 10000, 10000, 10000, 10000, 10000, 10000, 10000, 10000, 10000, 10000, 10000, 10000, 10000, 10000, 10000, 10000, 10000, 10000, 10000, 10000, 10000, 10000, 10000, 10000, 10000, 10000, 10000, 10000, 10000, 10000, 10000, 10000, 10000, 10000, 10000, 10000, 10000, 10000, 10000, 10000, 10000, 10000, 10000, 10000, 10000, 10000, 10000, 10000, 10000, 10000, 10000, 10000, 10000, 10000, 10000, 10000, 10000, 10000, 10000, 10000, 10000, 10000, 10000, 10000, 10000, 10000, 10000, 10000, 10000, 10000, 10000, 10000, 10000, 10000, 10000, 10000, 10000, 10000, 10000, 10000, 10000, 10000, 10000, 10000, 10000, 10000, 10000, 10000, 10000, 10000, 10000, 10000, 10000, 10000, 10000, 10000, 10000, 10000, 10000, 10000, 10000, 10000, 10000, 10000, 10000, 10000, 10000, 10000, 10000, 10000, 10000, 10000, 10000, 10000, 10000, 10000, 10000, 10000, 10000, 10000, 10000, 10000, 10000, 10000, 10000, 10000, 10000, 10000, 10000, 10000, 10000, 10000, 10000, 10000, 10000, 10000, 10000, 10000, 10000, 10000, 10000, 10000, 10000, 10000, 10000, 10000, 10000, 10000, 10000, 10000, 10000, 10000, 10000, 10000, 10000, 10000, 10000, 10000, 10000, 10000, 10000, 10000, 10000, 10000, 10000, 10000, 10000, 10000, 10000, 10000, 10000, 10000, 10000, 10000, 10000, 10000, 10000, 10000, 10000, 10000, 10000, 10000, 10000, 10000, 10000, 10000, 10000, 10000, 10000, 10000, 10000, 10000, 10000, 10000, 10000, 10000, 10000, 10000, 10000, 10000, 10000, 10000, 10000, 10000, 10000, 10000, 10000, 10000, 10000, 10000, 10000, 10000, 10000, 10000, 10000, 10000, 10000, 10000, 10000, 10000, 10000, 10000, 10000, 10000, 10000, 10000, 10000, 10000, 10000, 10000, 10000, 10000, 10000, 10000, 10000, 10000, 10000, 10000, 10000, 10000, 10000, 10000, 10000, 10000, 10000, 10000, 10000, 10000, 10000, 10000, 10000, 10000, 10000, 10000, 10000, 10000, 10000, 10000, 10000, 10000, 10000, 10000, 10000, 10000, 10000, 10000, 10000, 10000, 10000, 10000, 10000, 10000, 10000, 10000, 10000, 10000, 10000, 10000, 10000, 10000, 10000, 10000, 10000, 10000, 10000, 10000, 10000, 10000, 10000, 10000, 10000, 10000, 10000, 10000, 10000, 10000, 10000, 10000, 10000, 10000, 10000, 10000, 10000, 10000, 10000, 10000, 10000, 10000, 10000, 10000, 10000, 10000, 10000, 10000, 10000, 10000, 10000, 10000, 10000, 10000, 10000, 10000, 10000, 10000, 10000, 10000, 10000, 10000, 10000, 10000, 10000, 10000, 10000, 10000, 10000, 10000, 10000, 10000, 10000, 10000, 10000, 10000, 10000, 10000, 10000, 10000, 10000, 10000, 10000, 10000, 10000, 10000, 10000, 10000, 10000, 10000, 10000, 10000, 10000, 10000, 10000, 10000, 10000, 10000, 10000, 10000, 10000, 10000, 10000, 10000, 10000, 10000, 10000, 10000, 10000, 10000, 10000, 10000, 10000, 10000, 10000, 10000, 10000, 10000, 10000, 10000, 10000, 10000, 10000, 10000, 10000, 10000, 10000, 10000, 10000, 10000, 10000, 10000, 10000, 10000, 10000, 10000, 10000, 10000, 10000, 10000, 10000, 10000, 10000, 10000, 10000, 10000, 10000, 10000, 10000, 10000, 10000, 10000, 10000, 10000, 10000, 10000, 10000, 10000, 10000, 10000, 10000, 10000, 10000, 10000, 10000, 10000, 10000, 10000, 10000, 10000, 10000, 10000, 10000, 10000, 10000, 10000, 10000, 10000, 10000, 10000, 10000, 10000, 10000, 10000, 10000, 10000, 10000, 10000, 10000, 10000, 10000, 10000, 10000, 10000, 10000, 10000, 10000, 10000, 10000, 10000, 10000, 10000, 10000, 10000, 10000, 10000, 10000, 10000, 10000, 10000, 10000, 10000, 10000, 10000, 10000, 10000, 10000, 10000, 10000, 10000, 10000, 10000, 10000, 10000, 10000, 10000, 10000, 10000, 10000, 10000, 10000, 10000, 10000, 10000, 10000, 10000, 10000, 10000, 10000, 10000, 10000, 10000, 10000, 10000, 10000, 10000, 10000, 10000, 10000, 10000, 10000, 10000, 10000, 10000, 10000, 10000, 10000, 10000, 10000, 10000, 10000, 10000, 10000, 10000, 10000, 10000, 10000, 10000, 10000, 10000, 10000, 10000, 10000, 10000, 10000, 10000, 10000, 10000, 10000, 10000, 10000, 10000, 10000, 10000, 10000, 10000, 10000, 10000, 10000, 10000, 10000, 10000, 10000, 10000, 10000, 10000, 10000, 10000, 10000, 10000, 10000, 10000, 10000, 10000, 10000, 10000, 10000, 10000, 10000, 10000, 10000, 10000, 10000, 10000, 10000, 10000, 10000, 10000, 10000, 10000, 10000, 10000, 10000, 10000, 10000, 10000, 10000, 10000, 10000, 10000, 10000, 10000, 10000, 10000, 10000, 10000, 10000, 10000, 10000, 10000, 10000, 10000, 10000, 10000, 10000, 10000, 10000, 10000, 10000, 10000, 10000, 10000, 10000, 10000, 10000, 10000, 10000, 10000, 10000, 10000, 10000, 10000, 10000, 10000, 10000, 10000, 10000, 10000, 10000, 10000, 10000, 10000, 10000, 10000, 10000, 10000, 10000, 10000, 10000, 10000, 10000, 10000, 10000, 10000, 10000, 10000, 10000, 10000, 10000, 10000, 10000, 10000, 10000, 10000, 10000, 10000, 10000, 10000, 10000, 10000, 10000, 10000, 10000, 10000, 10000, 10000, 10000, 10000, 10000, 10000, 10000, 10000, 10000, 10000, 10000, 10000, 10000, 10000, 10000, 10000, 10000, 10000, 10000, 10000, 10000, 10000, 10000, 10000, 10000, 10000, 10000, 10000, 10000, 10000, 10000, 10000, 10000, 10000, 10000, 10000, 10000, 10000, 10000, 10000, 10000, 10000, 10000, 10000, 10000, 10000, 10000, 10000, 10000, 10000, 10000, 10000, 10000, 10000, 10000, 10000, 10000, 10000, 10000, 10000, 10000, 10000, 10000, 10000, 10000, 10000, 10000, 10000, 10000, 10000, 10000, 10000, 10000, 10000, 10000, 10000, 10000, 10000, 10000, 10000, 10000, 10000, 10000, 10000, 10000, 10000, 10000, 10000, 10000, 10000, 10000, 10000, 10000, 10000, 10000, 10000, 10000, 10000, 10000, 10000, 10000, 10000, 10000, 10000, 10000, 10000, 10000, 10000, 10000, 10000, 10000, 10000, 10000, 10000, 10000, 10000, 10000, 10000, 10000, 10000, 10000, 10000, 10000, 10000, 10000, 10000, 10000, 10000, 10000, 10000, 10000, 10000, 10000, 10000, 10000, 10000, 10000, 10000, 10000, 10000, 10000, 10000, 10000, 10000, 10000, 10000, 10000, 10000, 10000, 10000, 10000, 10000, 10000, 10000, 10000, 10000, 10000, 10000, 10000, 10000, 10000, 10000, 10000, 10000, 10000, 10000, 10000, 10000, 10000, 10000, 10000, 10000, 10000, 10000, 10000, 10000, 10000, 10000, 10000, 10000, 10000, 10000, 10000, 10000, 10000, 10000, 10000, 10000, 10000, 10000, 10000, 10000, 10000, 10000, 10000, 10000, 10000, 10000, 10000, 10000, 10000, 10000, 10000, 10000, 10000, 10000, 10000, 10000, 10000, 10000, 10000, 10000, 10000, 10000, 10000, 10000, 10000, 10000, 10000, 10000, 10000, 10000, 10000, 10000, 10000, 10000, 10000, 10000, 10000, 10000, 10000, 10000, 10000, 10000, 10000, 10000, 10000, 10000, 10000, 10000, 10000, 10000, 10000, 10000, 10000, 10000, 10000, 10000, 10000, 10000, 10000, 10000, 10000, 10000, 10000, 10000, 10000, 10000, 10000, 10000, 10000, 10000, 10000, 10000, 10000, 10000, 10000, 10000, 10000, 10000, 10000, 10000, 10000, 10000, 10000, 10000, 10000, 10000, 10000, 10000, 10000, 10000, 10000, 10000, 10000, 10000, 10000, 10000, 10000, 10000, 10000, 10000, 10000, 10000, 10000, 10000, 10000, 10000, 10000, 10000, 10000, 10000, 10000, 10000, 10000, 10000, 10000, 10000, 10000, 10000, 10000, 10000, 10000, 10000, 10000, 10000, 10000, 10000, 10000, 10000, 10000, 10000, 10000, 10000, 10000, 10000, 10000, 10000, 10000, 10000, 10000, 10000, 10000, 10000, 10000, 10000, 10000, 10000, 10000, 10000, 10000, 10000, 10000, 10000, 10000, 10000, 10000, 10000, 10000, 10000, 10000, 10000, 10000, 10000, 10000, 10000, 10000, 10000, 10000, 10000, 10000, 10000, 10000, 10000, 10000, 10000, 10000, 10000, 10000, 10000, 10000, 10000, 10000, 10000, 10000, 10000, 10000, 10000, 10000, 10000, 10000, 10000, 10000, 10000, 10000, 10000, 10000, 10000, 10000, 10000, 10000, 10000, 10000, 10000, 10000, 10000, 10000, 10000, 10000, 10000, 10000, 10000, 10000, 10000, 10000, 10000, 10000, 10000, 10000, 10000, 10000, 10000, 10000, 10000, 10000, 10000, 10000, 10000, 10000, 10000, 10000, 10000, 10000, 10000, 10000, 10000, 10000, 10000, 10000, 10000, 10000, 10000, 10000, 10000, 10000, 10000, 10000, 10000, 10000, 10000, 10000, 10000, 10000, 10000, 10000, 10000, 10000, 10000, 10000, 10000, 10000, 10000, 10000, 10000, 10000, 10000, 10000, 10000, 10000, 10000, 10000, 10000, 10000, 10000, 10000, 10000, 10000, 10000, 10000, 10000, 10000, 10000, 10000, 10000, 10000, 10000, 10000, 10000, 10000, 10000, 10000, 10000, 10000, 10000, 10000, 10000, 10000, 10000, 10000, 10000, 10000, 10000, 10000, 10000, 10000, 10000, 10000, 10000, 10000, 10000, 10000, 10000, 10000, 10000, 10000, 10000, 10000, 10000, 10000, 10000, 10000, 10000, 10000, 10000, 10000, 10000, 10000, 10000, 10000, 10000, 10000, 10000, 10000, 10000, 10000, 10000, 10000, 10000, 10000, 10000, 10000, 10000, 10000, 10000, 10000, 10000, 10000, 10000, 10000, 10000, 10000, 10000, 10000, 10000, 10000, 10000, 10000, 10000, 10000, 10000, 10000, 10000, 10000, 10000, 10000, 10000, 10000, 10000, 10000, 10000, 10000, 10000, 10000, 10000, 10000, 10000, 10000, 10000, 10000, 10000, 10000, 10000, 10000, 10000, 10000, 10000, 10000, 10000, 10000, 10000, 10000, 10000, 10000, 10000, 10000, 10000, 10000, 10000, 10000, 10000, 10000, 10000, 10000, 10000, 10000, 10000, 10000, 10000, 10000, 10000, 10000, 10000, 10000, 10000, 10000, 10000, 10000, 10000, 10000, 10000, 10000, 10000, 10000, 10000, 10000, 10000, 10000, 10000, 10000, 10000, 10000, 10000, 10000, 10000, 10000, 10000, 10000, 10000, 10000, 10000, 10000, 10000, 10000, 10000, 10000, 10000, 10000, 10000, 10000, 10000, 10000, 10000, 10000, 10000, 10000, 10000, 10000, 10000, 10000, 10000, 10000, 10000, 10000, 10000, 10000, 10000, 10000, 10000, 10000, 10000, 10000, 10000, 10000, 10000, 10000, 10000, 10000, 10000, 10000, 10000, 10000, 10000, 10000, 10000, 10000, 10000, 10000, 10000, 10000, 10000, 10000, 10000, 10000, 10000, 10000, 10000, 10000, 10000, 10000, 10000, 10000, 10000, 10000, 10000, 10000, 10000, 10000, 10000, 10000, 10000, 10000, 10000, 10000, 10000, 10000, 10000, 10000, 10000, 10000, 10000, 10000, 10000, 10000, 10000, 10000, 10000, 10000, 10000, 10000, 10000, 10000, 10000, 10000, 10000, 10000, 10000, 10000, 10000, 10000, 10000, 10000, 10000, 10000, 10000, 10000, 10000, 10000, 10000, 10000, 10000, 10000, 10000, 10000, 10000, 10000, 10000, 10000, 10000, 10000, 10000, 10000, 10000, 10000, 10000, 10000, 10000, 10000, 10000, 10000, 10000, 10000, 10000, 10000, 10000, 10000, 10000, 10000, 10000, 10000, 10000, 10000, 10000, 10000, 10000, 10000, 10000, 10000, 10000, 10000, 10000, 10000, 10000, 10000, 10000, 10000, 10000, 10000, 10000, 10000, 10000, 10000, 10000, 10000, 10000, 10000, 10000, 10000, 10000, 10000, 10000, 10000, 10000, 10000, 10000, 10000, 10000, 10000, 10000, 10000, 10000, 10000, 10000, 10000, 10000, 10000, 10000, 10000, 10000, 10000, 10000, 10000, 10000, 10000, 10000, 10000, 10000, 10000, 10000, 10000, 10000, 10000, 10000, 10000, 10000, 10000, 10000, 10000, 10000, 10000, 10000, 10000, 10000, 10000, 10000, 10000, 10000, 10000, 10000, 10000, 10000, 10000, 10000, 10000, 10000, 10000, 10000, 10000, 10000, 10000, 10000, 10000, 10000, 10000, 10000, 10000, 10000, 10000, 10000, 10000, 10000, 10000, 10000, 10000, 10000, 10000, 10000, 10000, 10000, 10000, 10000, 10000, 10000, 10000, 10000, 10000, 10000, 10000, 10000, 10000, 10000, 10000, 10000, 10000, 10000, 10000, 10000, 10000, 10000, 10000, 10000, 10000, 10000, 10000, 10000, 10000, 10000, 10000, 10000, 10000, 10000, 10000, 10000, 10000, 10000, 10000, 10000, 10000, 10000, 10000, 10000, 10000, 10000, 10000, 10000, 10000, 10000, 10000, 10000, 10000, 10000, 10000, 10000, 10000, 10000, 10000, 10000, 10000, 10000, 10000, 10000, 10000, 10000, 10000, 10000, 10000, 10000, 10000, 10000, 10000, 10000, 10000, 10000, 10000, 10000, 10000, 10000, 10000, 10000, 10000, 10000, 10000, 10000, 10000, 10000, 10000, 10000, 10000, 10000, 10000, 10000, 10000, 10000, 10000, 10000, 10000, 10000, 10000, 10000, 10000, 10000, 10000, 10000, 10000, 10000, 10000, 10000, 10000, 10000, 10000, 10000, 10000, 10000, 10000, 10000, 10000, 10000, 10000, 10000, 10000, 10000, 10000, 10000, 10000, 10000, 10000, 10000, 10000, 10000, 10000, 10000, 10000, 10000, 10000, 10000, 10000, 10000, 10000, 10000, 10000, 10000, 10000, 10000, 10000, 10000, 10000, 10000, 10000, 10000, 10000, 10000, 10000, 10000, 10000, 10000, 10000, 10000, 10000, 10000, 10000, 10000, 10000, 10000, 10000, 10000, 10000, 10000, 10000, 10000, 10000, 10000, 10000, 10000, 10000, 10000, 10000, 10000, 10000, 10000, 10000, 10000, 10000, 10000, 10000, 10000, 10000, 10000, 10000, 10000, 10000, 10000, 10000, 10000, 10000, 10000, 10000, 10000, 10000, 10000, 10000, 10000, 10000, 10000, 10000, 10000, 10000, 10000, 10000, 10000, 10000, 10000, 10000, 10000, 10000, 10000, 10000, 10000, 10000, 10000, 10000, 10000, 10000, 10000, 10000, 10000, 10000, 10000, 10000, 10000, 10000, 10000, 10000, 10000, 10000, 10000, 10000, 10000, 10000, 10000, 10000, 10000, 10000, 10000, 10000, 10000, 10000, 10000, 10000, 10000, 10000, 10000, 10000, 10000, 10000, 10000, 10000, 10000, 10000, 10000], 'regime_series': Date
2015-04-29 00:00:00+05:30        calm
2015-04-30 00:00:00+05:30    trending
2015-05-04 00:00:00+05:30     ranging
2015-05-05 00:00:00+05:30     ranging
2015-05-06 00:00:00+05:30     ranging
                               ...   
2025-04-23 00:00:00+05:30     ranging
2025-04-24 00:00:00+05:30     ranging
2025-04-25 00:00:00+05:30     ranging
2025-04-28 00:00:00+05:30     ranging
2025-04-29 00:00:00+05:30     ranging
Name: regime, Length: 2469, dtype: object, 'regime_summary': 'Trending: 27%, Ranging: 73%', 'drawdown_curve': array([0, 0, 0, ..., 0, 0, 0]), 'returns_distribution': array([0., 0., 0., ..., 0., 0., 0.]), 'strategy_params': {'position_size': 100, 'initial_cash': 10000}}
DEBUG: Trade log keys (first entry): ['entry_index', 'exit_index', 'entry_price', 'exit_price', 'pnl', 'commission_cost', 'regime', 'entry_regime', 'exit_regime', 'EntryRegime', 'ExitRegime', 'volatility', 'exit_volatility', 'entry_volatility', 'EntryVolatility', 'ExitVolatility', 'volume', 'exit_volume', 'entry_volume', 'volume_entry', 'volume_exit', 'EntryVolume', 'ExitVolume', 'atr_entry', 'atr_exit', 'EntryATR', 'ExitATR', 'entry_sma_short', 'exit_sma_short', 'entry_sma_long', 'exit_sma_long', 'EntrySMA_Short', 'ExitSMA_Short', 'EntrySMA_Long', 'ExitSMA_Long', 'entry_rsi', 'exit_rsi', 'EntryRSI', 'ExitRSI', 'rationale', 'Rationale', 'ticker', 'context', 'indicators', 'action', 'qty']
[DEBUG] Exception in generate_markdown_report: 'numpy.ndarray' object is not callable
---------------------------- Captured stderr call -----------------------------
Traceback (most recent call last):
  File "D:\Code\projects\tapp\code\2025\simpler_st\pipeline.py", line 144, in run_pipeline
    generate_markdown_report(stats, pf)
  File "D:\Code\projects\tapp\code\2025\simpler_st\report_generator.py", line 686, in generate_markdown_report
    regime_counts = pd.Series(list(regime_series.values())).value_counts()
TypeError: 'numpy.ndarray' object is not callable
______________________ test_pipeline_uses_config_params _______________________

tmp_path = WindowsPath('C:/Users/user/AppData/Local/Temp/pytest-of-user/pytest-262/test_pipeline_uses_config_para0')
monkeypatch = <_pytest.monkeypatch.MonkeyPatch object at 0x000001BD3D0AAA10>

    def test_pipeline_uses_config_params(tmp_path, monkeypatch):
        """
        Ensure pipeline loads initial_cash and position_size from config.json and passes them to backtest/report.
        """
        import sys, json, shutil
        os.chdir(tmp_path)
        reports_dir = tmp_path / "reports"
        if reports_dir.exists():
            shutil.rmtree(reports_dir)
        config = {
            "period": "1y",
            "initial_cash": 5555,
            "position_size": 123,
            "strategy": "naive_momentum",
            "strategy_params": {"short_window": 5, "long_window": 10}
        }
        config_path = tmp_path / "config.json"
        with open(config_path, "w") as f:
            json.dump(config, f)
        ticker = "TCS.NS"
        sys.path.insert(0, str(Path(__file__).parent.parent))
        from pipeline import run_pipeline
        monkeypatch.chdir(tmp_path)
>       run_pipeline([ticker], output_dir=tmp_path, config_path=config_path)

D:\Code\projects\tapp\code\2025\simpler_st\tests\test_pipeline.py:50: 
_ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _
D:\Code\projects\tapp\code\2025\simpler_st\pipeline.py:144: in run_pipeline
    generate_markdown_report(stats, pf)
_ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _

stats = {'_trades':                  entry_index                exit_index  ...         qty         PnL
0  2024-05-07 00:00:00...5-04-28 00:00:00+05:30    trending
2025-04-29 00:00:00+05:30    trending
Name: regime, Length: 248, dtype: object, ...}
bt = <tech_analysis.portfolio.PortfolioState object at 0x000001BD3D0ABA30>
parameter_sensitivity_results = None

    def generate_markdown_report(stats, bt, parameter_sensitivity_results=None):
        """
        Generates a portfolio report in Markdown format, including all key sections.
        Output file: reports/portfolio_report.md
        """
        os.makedirs("plots", exist_ok=True)
        os.makedirs("reports", exist_ok=True)
        # --- Pre-initialize chart path variables to None to avoid UnboundLocalError ---
        abs_legacy_equity_chart_path = None
        abs_chart_path = None
        abs_drawdown_chart_path = None
        abs_return_dist_chart_path = None
        md_lines = []
        # Cover Page
        md_lines.append("# Technical Analysis Report\n")
        md_lines.append("## Portfolio-Level Report\n")
        md_lines.append("---\n")
        # Table of Contents
        md_lines.append("## Table of Contents\n")
        md_lines.append("1. [Cover Page](#technical-analysis-report)")
        md_lines.append("2. [Table of Contents](#table-of-contents)")
        md_lines.append("3. [Assumptions: Slippage and Commission](#assumptions-slippage-and-commission)")
        md_lines.append("4. [Performance Metrics](#performance-metrics)")
        md_lines.append("5. [Benchmark Comparison](#benchmark-comparison)")
        md_lines.append("6. [Trade Log](#trade-log)")
        md_lines.append("7. [Regime Summary](#regime-summary)")
        md_lines.append("8. [Strategy Parameters](#strategy-parameters)")
        md_lines.append("9. [Risk and Position Sizing Logic](#risk-and-position-sizing-logic)")
        md_lines.append("10. [Analyst Notes and Suggestions](#analyst-notes-and-suggestions)")
        md_lines.append("11. [Rationale Summary](#rationale-summary)")
        md_lines.append("12. [Trade Statistics Breakdown](#trade-statistics-breakdown)")
        md_lines.append("13. [Regime Breakdown](#regime-breakdown)\n")
        # --- Out-of-Sample/Walk-Forward Validation Section ---
        out_of_sample = stats.get('out_of_sample')
        if out_of_sample:
            md_lines.append("## Out-of-Sample Walk-Forward Results\n")
            period = out_of_sample.get('period', '')
            ret = out_of_sample.get('return', None)
            sharpe = out_of_sample.get('sharpe', None)
            max_dd = out_of_sample.get('max_drawdown', None)
            note = out_of_sample.get('note', '')
            line = f"> The strategy was tested on {period} data not used in optimization. "
            if ret is not None:
                line += f"Out-of-sample return: {ret:.1f}%, "
            if sharpe is not None:
                line += f"Sharpe: {sharpe:.2f}, "
            if max_dd is not None:
                line += f"Max Drawdown: {max_dd:.1f}%. "
            if note:
                line += note
            md_lines.append(line + "\n")
        # --- Equity Curve Chart (legacy, always present) ---
        legacy_equity_chart_path = f"plots/portfolio_equity.png"
        equity_curve = stats.get('equity_curve')
        # If dict (multi-ticker), pick first ticker for legacy chart
        if isinstance(equity_curve, dict):
            first_ticker = next(iter(equity_curve)) if equity_curve else None
            equity_curve_legacy = equity_curve.get(first_ticker) if first_ticker else None
        else:
            equity_curve_legacy = equity_curve
        if equity_curve_legacy is not None:
            plt.figure(facecolor='white')
            plt.rcParams.update({
                'font.size': 12,
                'axes.labelsize': 12,
                'axes.titlesize': 14,
                'legend.fontsize': 12,
                'axes.edgecolor': 'gray',
                'axes.linewidth': 1,
                'axes.grid': True,
                'grid.color': '#e0e0e0',
                'axes.prop_cycle': plt.cycler(color=["#1f77b4"])
            })
            plt.plot(equity_curve_legacy, label='Equity Curve', color='#1f77b4')
            plt.legend(loc='best', frameon=True)
            plt.tight_layout()
            abs_legacy_equity_chart_path = os.path.abspath(legacy_equity_chart_path)
            os.makedirs(os.path.dirname(abs_legacy_equity_chart_path), exist_ok=True)
            plt.savefig(abs_legacy_equity_chart_path)
            plt.close()
    
        # --- Benchmark Comparison Plot (new, if both present) ---
        benchmark_curve = stats.get('benchmark_curve') or stats.get('benchmark_equity_curve')
        chart_path = f"plots/benchmark_comparison.png"
        benchmark_name = stats.get('benchmark_name', 'Benchmark')
        # Handle dicts for benchmark too
        if isinstance(benchmark_curve, dict):
            benchmark_curve_legacy = benchmark_curve.get(first_ticker) if first_ticker else None
        else:
            benchmark_curve_legacy = benchmark_curve
        if equity_curve_legacy is not None and benchmark_curve_legacy is not None:
            plt.figure(facecolor='white')
            plt.rcParams.update({
                'font.size': 12,
                'axes.labelsize': 12,
                'axes.titlesize': 14,
                'legend.fontsize': 12,
                'axes.edgecolor': 'gray',
                'axes.linewidth': 1,
                'axes.grid': True,
                'grid.color': '#e0e0e0',
                'axes.prop_cycle': plt.cycler(color=["#1f77b4", "#ff7f0e"])
            })
            plt.plot(equity_curve_legacy, label='Portfolio', color='#1f77b4')
            plt.plot(benchmark_curve_legacy, label=benchmark_name, color='#ff7f0e', linestyle='--')
            plt.legend(loc='best', frameon=True)
            plt.title(f"Portfolio vs {benchmark_name}")
            plt.tight_layout()
            abs_chart_path = os.path.abspath(chart_path)
            os.makedirs(os.path.dirname(abs_chart_path), exist_ok=True)
            plt.savefig(abs_chart_path)
            plt.close()
    
        # --- Drawdown Curve Visualization ---
        drawdown_curve = stats.get('drawdown_curve')
        drawdown_chart_path = f"plots/drawdown_curve.png"
        if drawdown_curve is not None:
            plt.figure(facecolor='white')
            plt.plot(drawdown_curve, label='Drawdown', color='red')
            plt.title('Drawdown Curve')
            plt.xlabel('Time')
            plt.ylabel('Drawdown')
            plt.legend()
            plt.tight_layout()
            abs_drawdown_chart_path = os.path.abspath(drawdown_chart_path)
            os.makedirs(os.path.dirname(abs_drawdown_chart_path), exist_ok=True)
            plt.savefig(abs_drawdown_chart_path)
            plt.close()
    
        # --- Return Distribution Visualization ---
        returns_dist = stats.get('returns_distribution')
        return_dist_chart_path = f"plots/return_distribution.png"
        if returns_dist is not None:
            plt.figure(facecolor='white')
            mean = np.mean(returns_dist)
            std = np.std(returns_dist)
            outliers = (np.abs(returns_dist - mean) > 2 * std)
            plt.hist(returns_dist[~outliers], bins=20, color='#1f77b4', alpha=0.7, label='Normal')
            if np.any(outliers):
                plt.hist(returns_dist[outliers], bins=5, color='red', alpha=0.8, label='Outlier')
            plt.title('Return Distribution')
            plt.xlabel('Return')
            plt.ylabel('Frequency')
            plt.legend()
            plt.tight_layout()
            abs_return_dist_chart_path = os.path.abspath(return_dist_chart_path)
            os.makedirs(os.path.dirname(abs_return_dist_chart_path), exist_ok=True)
            plt.savefig(abs_return_dist_chart_path)
            plt.close()
    
        # --- Drawdown Table Section ---
        equity_curve = stats.get('equity_curve')
        # Defensive: handle dict (multi-ticker) vs. list/array (single-ticker)
        equity_curve_for_drawdown = equity_curve
        if isinstance(equity_curve, dict):
            first_ticker = next(iter(equity_curve)) if equity_curve else None
            equity_curve_for_drawdown = equity_curve.get(first_ticker) if first_ticker else None
        if equity_curve_for_drawdown is not None:
            from tech_analysis.backtest import extract_drawdown_periods
            periods = extract_drawdown_periods(equity_curve_for_drawdown)
            if periods:
                df = pd.DataFrame(periods)
                df2 = df.copy()
                df2['depth'] = (df2['depth'] * 100).round(2)
                df2 = df2.rename(columns={'start': 'Start', 'trough': 'Trough', 'end': 'End', 'depth': 'Depth (%)', 'recovery': 'Recovery (bars)'})
                plots_dir = os.path.join(os.getcwd(), 'plots')
                os.makedirs(plots_dir, exist_ok=True)
                table_path = os.path.join(plots_dir, 'drawdown_table.png')
                fig, ax = plt.subplots(figsize=(min(10, 2+len(df2)*0.5), 1+0.5*len(df2)))
                ax.axis('off')
                tbl = ax.table(cellText=df2.values, colLabels=df2.columns, loc='center', cellLoc='center')
                tbl.auto_set_font_size(False)
                tbl.set_fontsize(10)
                tbl.scale(1, 1.5)
                plt.tight_layout()
                plt.savefig(table_path, bbox_inches='tight', dpi=150)
                plt.close(fig)
                md_lines.append('## Drawdown Table\n')
                md_lines.append('![](plots/drawdown_table.png)\n')
    
        # --- Holding Duration Histogram ---
        holding_duration_chart_path = f"plots/holding_duration.png"
        trade_log = stats.get('trades') or stats.get('_trades')
        holding_durations = []
        if isinstance(trade_log, pd.DataFrame) and not trade_log.empty:
            for idx, trade in trade_log.iterrows():
                entry = trade.get('entry_time')
                exit = trade.get('exit_time')
                if entry and exit:
                    try:
                        entry_dt = pd.to_datetime(entry)
                        exit_dt = pd.to_datetime(exit)
                        duration = (exit_dt - entry_dt).days
                        if duration >= 0:
                            holding_durations.append(duration)
                    except Exception:
                        continue
        elif isinstance(trade_log, list):
            for trade in trade_log:
                entry = trade.get('entry_time')
                exit = trade.get('exit_time')
                if entry and exit:
                    try:
                        entry_dt = pd.to_datetime(entry)
                        exit_dt = pd.to_datetime(exit)
                        duration = (exit_dt - entry_dt).days
                        if duration >= 0:
                            holding_durations.append(duration)
                    except Exception:
                        continue
        if holding_durations:
            plt.figure(facecolor='white')
            plt.hist(holding_durations, bins=range(1, max(holding_durations)+2), color='#1f77b4', alpha=0.7, rwidth=0.85)
            plt.title('Trade Holding Duration Distribution')
            plt.xlabel('Holding Duration (days)')
            plt.ylabel('Number of Trades')
            plt.tight_layout()
            abs_holding_duration_chart_path = os.path.abspath(holding_duration_chart_path)
            os.makedirs(os.path.dirname(abs_holding_duration_chart_path), exist_ok=True)
            plt.savefig(abs_holding_duration_chart_path)
            plt.close()
            md_lines.append("\n## Trade Holding Duration Distribution\n")
            md_lines.append(f"![Trade Holding Duration]({holding_duration_chart_path})\n")
    
        # --- Markdown Content ---
        # Section: Assumptions
        md_lines.append("## Assumptions: Slippage and Commission\n")
        commission = getattr(bt, '_commission', stats.get('strategy_params', {}).get('commission', 0.002))
        slippage = getattr(bt, '_slippage', stats.get('strategy_params', {}).get('slippage', 0.0))
        md_lines.append(f"- **Slippage:** A slippage of {slippage} per trade is applied to all executions (entry and exit prices adjusted by ±slippage). (slippage={slippage})\n")
        md_lines.append(f"- **Commission:** A fixed commission rate of {commission * 100:.2f}% per trade is applied, as set in the backtesting engine (commission={commission}).\n")
        md_lines.append("\nThese assumptions may affect real-world applicability and should be reviewed for live trading scenarios.\n")
        # Section: Performance Metrics
        md_lines.append("## Performance Metrics\n")
        strat_metrics = stats.get('strategy', {})
        bench_metrics = stats.get('benchmark', {})
        metrics = [
            f"- **Strategy Return:** {100 * strat_metrics.get('total_return', 0.0):.2f}%",
            f"- **Strategy Sharpe Ratio:** {strat_metrics.get('sharpe_ratio', 0.0):.2f}",
            f"- **Strategy Max Drawdown:** {100 * strat_metrics.get('max_drawdown', 0.0):.2f}%",
            f"- **Strategy Win Rate:** {100 * strat_metrics.get('win_rate', 0.0):.2f}%"
        ]
        if bench_metrics:
            metrics.extend([
                f"- **Benchmark Return:** {100 * bench_metrics.get('total_return', 0.0):.2f}%",
                f"- **Benchmark Sharpe Ratio:** {bench_metrics.get('sharpe_ratio', 0.0):.2f}",
                f"- **Benchmark Max Drawdown:** {100 * bench_metrics.get('max_drawdown', 0.0):.2f}%",
                f"- **Benchmark Win Rate:** {100 * bench_metrics.get('win_rate', 0.0):.2f}%"
            ])
        md_lines.extend(metrics)
        # Embed equity curve chart (legacy)
        if abs_legacy_equity_chart_path is not None and os.path.exists(abs_legacy_equity_chart_path):
            md_lines.append(f"\n![Equity Curve]({legacy_equity_chart_path})\n")
        # Benchmark Comparison Section (new)
        if abs_chart_path is not None and os.path.exists(abs_chart_path):
            md_lines.append(f"\n## Benchmark Comparison\n")
            md_lines.append(f"![]({chart_path})\n")
            # Minimal table comparing returns if both present
            strat_return = stats.get('Return [%]', None)
            bench_curve = stats.get('benchmark_curve') or stats.get('benchmark_equity_curve')
            if strat_return is not None and bench_curve is not None:
                # Calculate benchmark return as percent change from first to last
                bench_return = 100 * (bench_curve[-1] - bench_curve[0]) / bench_curve[0]
                md_lines.append("\n| Metric | Portfolio | " + benchmark_name + " |\n|---|---|---|")
                md_lines.append(f"| Total Return (%) | {strat_return:.2f} | {bench_return:.2f} |\n")
        # Drawdown Curve Section
        if abs_drawdown_chart_path is not None and os.path.exists(abs_drawdown_chart_path):
            md_lines.append(f"\n## Drawdown Curve\n")
            md_lines.append(f"![Drawdown Curve]({drawdown_chart_path})\n")
        # Return Distribution Section
        if abs_return_dist_chart_path is not None and os.path.exists(abs_return_dist_chart_path):
            md_lines.append(f"\n## Return Distribution\n")
            md_lines.append(f"![Return Distribution]({return_dist_chart_path})\n")
            if returns_dist is not None:
                mean = np.mean(returns_dist)
                std = np.std(returns_dist)
                outliers = (np.abs(returns_dist - mean) > 2 * std)
                if np.any(outliers):
                    md_lines.append("Note: Outlier(s) highlighted in red.\n")
        # Section: Trade Log
        md_lines.append("## Trade Log\n")
        trade_log = stats.get('trades') or stats.get('_trades')
        # Debug: Print trade log columns/keys for first entry
        if isinstance(trade_log, pd.DataFrame) and not trade_log.empty:
            print("DEBUG: Trade log columns:", list(trade_log.columns))
        elif isinstance(trade_log, list) and len(trade_log) > 0:
            print("DEBUG: Trade log keys (first entry):", list(trade_log[0].keys()))
        elif trade_log is not None:
            print("DEBUG: Trade log type:", type(trade_log))
        if isinstance(trade_log, pd.DataFrame):
            trade_log = trade_log.to_dict(orient='records')
        if isinstance(trade_log, list) and len(trade_log) > 0:
            # Helper for formatting numbers
            def fmt(val):
                if isinstance(val, float) or isinstance(val, int):
                    return f"{val:.2f}"
                return str(val)
            for trade in trade_log:
                def get_any(trade, *keys):
                    for k in keys:
                        v = trade.get(k)
                        if v not in (None, ""):
                            return v
                    return ''
                ticker = get_any(trade, 'ticker')
                entry_index = get_any(trade, 'entry_index', 'EntryIndex')
                exit_index = get_any(trade, 'exit_index', 'ExitIndex')
                entry_price = get_any(trade, 'entry_price', 'EntryPrice')
                exit_price = get_any(trade, 'exit_price', 'ExitPrice')
                pnl = get_any(trade, 'pnl', 'PnL')
                commission_cost = get_any(trade, 'commission_cost', 'CommissionCost')
                regime = get_any(trade, 'regime', 'Regime')
                exit_regime = get_any(trade, 'exit_regime', 'ExitRegime')
                volatility = get_any(trade, 'volatility', 'Volatility')
                exit_volatility = get_any(trade, 'exit_volatility', 'ExitVolatility')
                volume = get_any(trade, 'volume', 'Volume')
                exit_volume = get_any(trade, 'exit_volume', 'ExitVolume')
                atr_entry = get_any(trade, 'atr_entry', 'EntryATR')
                atr_exit = get_any(trade, 'atr_exit', 'ExitATR')
                entry_sma_short = get_any(trade, 'entry_sma_short', 'EntrySMA_Short', 'EntrySMA')
                exit_sma_short = get_any(trade, 'exit_sma_short', 'ExitSMA_Short', 'ExitSMA')
                entry_sma_long = get_any(trade, 'entry_sma_long', 'EntrySMA_Long')
                exit_sma_long = get_any(trade, 'exit_sma_long', 'ExitSMA_Long')
                entry_rsi = get_any(trade, 'entry_rsi', 'EntryRSI')
                exit_rsi = get_any(trade, 'exit_rsi', 'ExitRSI')
                rationale = get_any(trade, 'rationale', 'Rationale')
                context = trade.get('context', '')
                indicators = trade.get('indicators', '')
                # --- Output both bolded and plain versions for all critical trade log fields ---
                md_lines.append(f"**Ticker:** {ticker}")
                md_lines.append(f"Ticker: {ticker}")
                md_lines.append(f"**Entry:** {fmt(get_any(trade, 'entry_time', 'EntryTime', 'entry_index', 'EntryIndex'))}")
                md_lines.append(f"Entry: {fmt(get_any(trade, 'entry_time', 'EntryTime', 'entry_index', 'EntryIndex'))}")
                md_lines.append(f"**Entry Price:** {fmt(get_any(trade, 'entry_price', 'EntryPrice'))}")
                md_lines.append(f"Entry Price: {fmt(get_any(trade, 'entry_price', 'EntryPrice'))}")
                md_lines.append(f"**Exit:** {fmt(get_any(trade, 'exit_time', 'ExitTime', 'exit_index', 'ExitIndex'))}")
                md_lines.append(f"Exit: {fmt(get_any(trade, 'exit_time', 'ExitTime', 'exit_index', 'ExitIndex'))}")
                md_lines.append(f"**Exit Price:** {fmt(get_any(trade, 'exit_price', 'ExitPrice'))}")
                md_lines.append(f"Exit Price: {fmt(get_any(trade, 'exit_price', 'ExitPrice'))}")
                md_lines.append(f"**PnL:** {fmt(get_any(trade, 'pnl', 'PnL'))}")
                md_lines.append(f"PnL: {fmt(get_any(trade, 'pnl', 'PnL'))}")
                md_lines.append(f"**Commission Cost:** {fmt(get_any(trade, 'commission_cost', 'CommissionCost'))}")
                md_lines.append(f"Commission Cost: {fmt(get_any(trade, 'commission_cost', 'CommissionCost'))}")
                md_lines.append(f"**Position Size:** {fmt(get_any(trade, 'position_size', 'PositionSize'))}")
                md_lines.append(f"Position Size: {fmt(get_any(trade, 'position_size', 'PositionSize'))}")
                md_lines.append(f"**Entry Regime:** {get_any(trade, 'entry_regime', 'EntryRegime')}")
                md_lines.append(f"Entry Regime: {get_any(trade, 'entry_regime', 'EntryRegime')}")
                md_lines.append(f"**Exit Regime:** {get_any(trade, 'exit_regime', 'ExitRegime')}")
                md_lines.append(f"Exit Regime: {get_any(trade, 'exit_regime', 'ExitRegime')}")
                md_lines.append(f"**Entry Volatility:** {fmt(get_any(trade, 'entry_volatility', 'EntryVolatility'))}")
                md_lines.append(f"Entry Volatility: {fmt(get_any(trade, 'entry_volatility', 'EntryVolatility'))}")
                md_lines.append(f"**Exit Volatility:** {fmt(get_any(trade, 'exit_volatility', 'ExitVolatility'))}")
                md_lines.append(f"Exit Volatility: {fmt(get_any(trade, 'exit_volatility', 'ExitVolatility'))}")
                md_lines.append(f"**Entry Volume:** {fmt(get_any(trade, 'entry_volume', 'EntryVolume'))}")
                md_lines.append(f"Entry Volume: {fmt(get_any(trade, 'entry_volume', 'EntryVolume'))}")
                md_lines.append(f"**Exit Volume:** {fmt(get_any(trade, 'exit_volume', 'ExitVolume'))}")
                md_lines.append(f"Exit Volume: {fmt(get_any(trade, 'exit_volume', 'ExitVolume'))}")
                md_lines.append(f"**Entry SMA:** {fmt(get_any(trade, 'entry_sma_short', 'EntrySMA_Short', 'EntrySMA'))}")
                md_lines.append(f"Entry SMA: {fmt(get_any(trade, 'entry_sma_short', 'EntrySMA_Short', 'EntrySMA'))}")
                md_lines.append(f"**Exit SMA:** {fmt(get_any(trade, 'exit_sma_short', 'ExitSMA_Short', 'ExitSMA'))}")
                md_lines.append(f"Exit SMA: {fmt(get_any(trade, 'exit_sma_short', 'ExitSMA_Short', 'ExitSMA'))}")
                md_lines.append(f"**Entry RSI:** {fmt(get_any(trade, 'entry_rsi', 'EntryRSI'))}")
                md_lines.append(f"Entry RSI: {fmt(get_any(trade, 'entry_rsi', 'EntryRSI'))}")
                md_lines.append(f"**Exit RSI:** {fmt(get_any(trade, 'exit_rsi', 'ExitRSI'))}")
                md_lines.append(f"Exit RSI: {fmt(get_any(trade, 'exit_rsi', 'ExitRSI'))}")
                md_lines.append(f"**Rationale:** {get_any(trade, 'rationale', 'Rationale')}")
                md_lines.append(f"Rationale: {get_any(trade, 'rationale', 'Rationale')}")
                md_lines.append(f"**Context:** {trade.get('context', '')}")
                md_lines.append(f"Context: {trade.get('context', '')}")
                md_lines.append(f"**Indicators:** {trade.get('indicators', '')}\n")
                md_lines.append(f"Indicators: {trade.get('indicators', '')}\n")
        else:
            md_lines.append("No trade log available.\n")
        # Section: Regime Summary
        md_lines.append("## Regime Summary\n")
        params = stats.get('strategy_params', {})
        short_sma = params.get('short_window', 20)
        long_sma = params.get('long_window', 50)
        min_days = params.get('min_regime_days', 4)
        rsi_period = params.get('rsi_period', 14)
        overbought = params.get('overbought', 70)
        oversold = params.get('oversold', 30)
        md_lines.append("**Regime Definitions and Classification Criteria:**\n")
        md_lines.append(f"- **Trending:** A period where price exhibits a clear upward or downward movement, typically identified by the short-term SMA (window: {short_sma}) being consistently above (uptrend) or below (downtrend) the long-term SMA (window: {long_sma}) for more than {min_days - 1} days.\n")
        md_lines.append(f"- **Ranging:** A period where price oscillates within a horizontal channel, identified when the short-term SMA crosses above and below the long-term SMA frequently, with no sustained trend for more than {min_days - 1} days.\n")
        md_lines.append("- **Quantitative Parameters:**\n" +
            f"**Short SMA window:** {short_sma} days\n" +
            f"**Long SMA window:** {long_sma} days\n" +
            f"**Minimum regime duration:** {min_days} days (regimes shorter than this are filtered out)\n" +
            f"**RSI period:** {rsi_period}\n" +
            f"**RSI thresholds:** Overbought ({overbought}), Oversold ({oversold})\n"
        )
        regime_summary = stats.get('regime_summary')
        if regime_summary:
            md_lines.append(f"{regime_summary}\n")
        # Render filtered regime series table
        regime_series = stats.get('regime_series')
        if regime_series is not None and len(regime_series) > 0:
            # Pass min_days to the filter function
            def filter_regime_series(series, min_duration):
                filtered = []
                prev_regime = None
                start_date = None
                count = 0
                threshold = min_duration - 1 # Check against min_duration - 1
                for date, regime in series.items():
                    if regime != prev_regime:
                        # Use the threshold derived from min_duration
                        if prev_regime is not None and count > threshold:
                            filtered.append((start_date, date, prev_regime, count))
                        start_date = date
                        count = 1
                        prev_regime = regime
                    else:
                        count += 1
                # Handle last segment, using the threshold
                if prev_regime is not None and count > threshold:
                    filtered.append((start_date, date, prev_regime, count))
                return filtered
            # Call the function with the min_days parameter
            filtered_regimes = filter_regime_series(regime_series, min_days)
            if filtered_regimes:
                md_lines.append("\n| Start Date | End Date | Regime | Days |\n|---|---|---|---|")
                for start, end, regime, days in filtered_regimes:
                    md_lines.append(f"| {start} | {end} | {regime} | {days} |")
            else:
                # Update the message to use min_days
                md_lines.append(f"\n_No regime persisted more than {min_days - 1} days in a row._\n")
        # Trade-level chart with entry/exit markers and indicator overlays
        trade_chart_path = f"plots/trade_chart.png"
        price = stats.get('equity_curve')
        sma = stats.get('sma_curve')
        rsi = stats.get('rsi_curve')
        trades = stats.get('_trades')
        if trades is None or not hasattr(trades, 'iterrows'):
            trades = stats.get('trades')
        # Only plot summary chart if price and sma are 1D (not dict)
        if price is not None and sma is not None and trades is not None and not isinstance(price, dict) and not isinstance(sma, dict):
            plt.figure(facecolor='white')
            plt.plot(price, label='Price', color='#1f77b4')
            plt.plot(sma, label='SMA', color='orange')
            if rsi is not None and not isinstance(rsi, dict):
                ax1 = plt.gca()
                ax2 = ax1.twinx()
                ax2.plot(rsi, label='RSI', color='purple', alpha=0.4)
                ax2.set_ylabel('RSI', color='purple')
            # Plot trade entry/exit markers
            if hasattr(trades, 'iterrows'):
                for idx, trade in trades.iterrows():
                    entry = trade.get('entry_time')
                    entry_price = trade.get('entry_price')
                    exit = trade.get('exit_time')
                    exit_price = trade.get('exit_price')
                    if entry is not None and entry_price is not None:
                        plt.scatter(entry, entry_price, marker='^', color='green', label='Entry' if idx == 0 else "")
                    if exit is not None and exit_price is not None:
                        plt.scatter(exit, exit_price, marker='v', color='red', label='Exit' if idx == 0 else "")
            elif isinstance(trades, list):
                for i, trade in enumerate(trades):
                    entry = trade.get('entry_time')
                    entry_price = trade.get('entry_price')
                    exit = trade.get('exit_time')
                    exit_price = trade.get('exit_price')
                    if entry is not None and entry_price is not None:
                        plt.scatter(entry, entry_price, marker='^', color='green', label='Entry' if i == 0 else "")
                    if exit is not None and exit_price is not None:
                        plt.scatter(exit, exit_price, marker='v', color='red', label='Exit' if i == 0 else "")
            plt.legend(loc='best', frameon=True)
            plt.title('Trade Chart with Entry/Exit, SMA, Regime')
            plt.tight_layout()
            abs_trade_chart_path = os.path.abspath(trade_chart_path)
            os.makedirs(os.path.dirname(abs_trade_chart_path), exist_ok=True)
            plt.savefig(abs_trade_chart_path)
            plt.close()
            if os.path.exists(abs_trade_chart_path):
                md_lines.append(f"\n![Trade Chart]({trade_chart_path})\n")
        # If price is a dict (multi-ticker), skip this summary chart (per-ticker charts are generated below)
        # Trade Outcome Heatmap Visualization
        heatmap_chart_path = f"plots/trade_heatmap.png"
        trades_df = None
        if isinstance(trade_log, pd.DataFrame):
            trades_df = trade_log
        elif isinstance(trade_log, list) and len(trade_log) > 0:
            trades_df = pd.DataFrame(trade_log)
        if trades_df is not None and all(col in trades_df.columns for col in ['ticker', 'regime', 'pnl']):
            pivot = trades_df.pivot_table(index='ticker', columns='regime', values='pnl', aggfunc='mean', fill_value=0)
            plt.figure(figsize=(6,4), facecolor='white')
            sns.heatmap(pivot, annot=True, fmt=".2f", cmap="RdYlGn", cbar=True)
            plt.title('Trade Outcome Heatmap (Mean PnL by Ticker & Regime)')
            plt.tight_layout()
            abs_heatmap_chart_path = os.path.abspath(heatmap_chart_path)
            os.makedirs(os.path.dirname(abs_heatmap_chart_path), exist_ok=True)
            plt.savefig(abs_heatmap_chart_path)
            plt.close()
            md_lines.append(f"\n## Trade Outcome Heatmap\n")
            md_lines.append(f"![Trade Outcome Heatmap]({heatmap_chart_path})\n")
        # Section: Strategy Parameters
        md_lines.append("## Strategy Parameters\n")
        params = stats.get('strategy_params', {})
        if params:
            for k, v in params.items():
                md_lines.append(f"- **{k}:** {v}")
        else:
            md_lines.append("No strategy parameters available.\n")
        # Section: Risk and Position Sizing Logic
        if 'position_size' not in params or 'initial_cash' not in params:
            raise KeyError("Both 'position_size' and 'initial_cash' must be present in strategy parameters (from config.json).")
        position_size = params['position_size']
        initial_cash = params['initial_cash']
        percent_risked = (position_size / initial_cash) * 100 if initial_cash else 0
        max_positions = params.get('max_simultaneous_positions', None)
        md_lines.append("\n## Risk and Position Sizing Logic\n")
        md_lines.append(f"- **% Risked Per Trade:** {percent_risked:.2f}% of initial capital allocated to each trade (position_size={position_size}, initial_cash={initial_cash}).")
        md_lines.append("- **Allocation Rule:** Fixed allocation per trade; no leverage or short selling. Trades only executed if sufficient cash is available.")
        if max_positions is not None:
            md_lines.append(f"- **Max Simultaneous Positions:** {max_positions} (as set in configuration).")
        else:
            md_lines.append("- **Max Simultaneous Positions:** No explicit maximum; limited by available cash.")
        md_lines.append("\nEach trade allocates capital using a fixed position size. The number of shares bought is calculated as:\n")
        md_lines.append("\n    qty = int(position_size // price)\n")
        md_lines.append("\nThis ensures that:\n- No trade exceeds the specified position size or available cash.\n- No leverage or short selling is used.\n- Trades are only executed if sufficient cash is available.\n\nThis simple approach provides basic risk control by capping exposure per trade and preventing over-allocation. More advanced risk management (e.g., stop-loss, volatility targeting) is not implemented in this version.\n")
        # Section: Analyst Notes and Suggestions (substantive note)
        md_lines.append("## Analyst Notes and Suggestions\n")
        analyst_note = stats.get('analyst_notes', None)
        if analyst_note:
            md_lines.append(f"{analyst_note}\n")
        else:
            md_lines.append("The strategy underperformed in ranging markets; consider parameter tuning or regime filtering.\n")
        # Section: Rationale Summary
        md_lines.append("## Rationale Summary\n")
        trades = trade_log
        if isinstance(trades, pd.DataFrame):
            has_trades = not trades.empty
        else:
            has_trades = bool(trades)
        rationales = []
        if has_trades:
            if isinstance(trades, pd.DataFrame):
                for idx, trade in trades.iterrows():
                    if hasattr(trade, 'get'):
                        rationale = trade.get('rationale')
                        if rationale:
                            rationales.append(rationale)
                    elif isinstance(trade, str):
                        rationales.append(trade)
            elif isinstance(trades, list):
                for trade in trades:
                    if hasattr(trade, 'get'):
                        rationale = trade.get('rationale')
                        if rationale:
                            rationales.append(rationale)
                    elif isinstance(trade, str):
                        rationales.append(trade)
        if rationales:
            md_lines.append("\n".join([f"- {r}" for r in rationales]))
        else:
            md_lines.append("No rationale provided.\n")
        # Parameter Sensitivity Analysis
        param_sens_path = "plots/parameter_sensitivity.png"
        # Section header always present if results or plot exist
        if (parameter_sensitivity_results and len(parameter_sensitivity_results) > 0) or os.path.exists(param_sens_path):
            md_lines.append("\n## Parameter Sensitivity Analysis\n")
            if parameter_sensitivity_results and len(parameter_sensitivity_results) > 0:
                # Generate Markdown table
                keys = list(parameter_sensitivity_results[0].keys())
                md_lines.append("| " + " | ".join(keys) + " |")
                md_lines.append("|" + "---|" * len(keys))
                for row in parameter_sensitivity_results:
                    md_lines.append("| " + " | ".join(str(row[k]) for k in keys) + " |")
                md_lines.append("")
            if os.path.exists(param_sens_path):
                md_lines.append("The plot below compares equity curves for different parameter values, illustrating the impact of parameter changes on strategy performance.\n")
                md_lines.append(f"![Parameter Sensitivity]({param_sens_path})\n")
        # Strategy Logic Summary Section
        strategy_rule_summary = stats.get('strategy_rule_summary')
        if strategy_rule_summary:
            md_lines.append('## Strategy Logic Summary\n')
            md_lines.append(strategy_rule_summary + '\n')
        # Trade Duration and Exposure Statistics Section
        trade_duration_stats = stats.get('trade_duration_stats')
        if trade_duration_stats:
            md_lines.append('## Trade Duration and Exposure Statistics\n')
            md_lines.append(f"Average Duration: {trade_duration_stats['avg_duration']} days\n")
            md_lines.append(f"Median Duration: {trade_duration_stats['median_duration']} days\n")
            md_lines.append(f"Max Duration: {trade_duration_stats['max_duration']} days\n")
            md_lines.append(f"Average Portfolio Exposure: {trade_duration_stats['avg_exposure']*100:.1f}%\n")
        # Slippage/Commission Sensitivity Analysis Section
        slippage_commission_sensitivity = stats.get('slippage_commission_sensitivity')
        if slippage_commission_sensitivity:
            md_lines.append('## Slippage/Commission Sensitivity Analysis\n')
            md_lines.append('| Slippage | Commission | Sharpe | Return | Drawdown |\n')
            md_lines.append('|---|---|---|---|---|\n')
            for row in slippage_commission_sensitivity:
                md_lines.append(f"| {row['slippage']} | {row['commission']} | {row['sharpe']} | {row['return']} | {row['drawdown']} |\n")
        # Per-Period Benchmark Comparison Section
        per_period_benchmark = stats.get('per_period_benchmark')
        if per_period_benchmark:
            md_lines.append('## Per-Period Benchmark Comparison\n')
            md_lines.append('| Period | Strategy Return | Benchmark Return |\n')
            md_lines.append('|---|---|---|\n')
            for row in per_period_benchmark:
                md_lines.append(f"| {row['period']} | {row['strategy_return']} | {row['benchmark_return']} |\n")
        # Trade Statistics Breakdown
        md_lines.append("## Trade Statistics Breakdown\n")
        metrics = stats.get('strategy', {})
        if isinstance(trade_log, pd.DataFrame):
            has_trades = not trade_log.empty
        else:
            has_trades = bool(trade_log)
        if has_trades and metrics:
            md_lines.append("| Metric | Value |")
            md_lines.append("|---|---|")
            md_lines.append(f"| Average Win | {metrics.get('average_win', 0.0):.2f} |")
            md_lines.append(f"| Average Loss | {metrics.get('average_loss', 0.0):.2f} |")
            md_lines.append(f"| Largest Win | {metrics.get('largest_win', 0.0):.2f} |")
            md_lines.append(f"| Largest Loss | {metrics.get('largest_loss', 0.0):.2f} |")
            md_lines.append(f"| Profit Factor | {metrics.get('profit_factor', 0.0):.2f} |")
            md_lines.append(f"| Expectancy | {metrics.get('expectancy', 0.0):.2f} |")
        else:
            md_lines.append("No trade statistics available.\n")
        # Regime Breakdown
        md_lines.append("\n### Regime Breakdown\n")
        from tech_analysis.backtest import correlate_performance_with_regimes
        if isinstance(trade_log, pd.DataFrame):
            has_trades = not trade_log.empty
        else:
            has_trades = bool(trade_log)
        if has_trades:
            # Ensure trade_log is a list of dicts, not a DataFrame, before passing to correlate_performance_with_regimes
            if hasattr(trade_log, 'to_dict'):
                trade_log_records = trade_log.to_dict('records')
            else:
                trade_log_records = trade_log
            regime_stats = correlate_performance_with_regimes(trade_log_records)
            if regime_stats:
                md_lines.append("| Regime | Trades | Win Rate | Avg Win | Avg Loss | Largest Win | Largest Loss | Profit Factor | Expectancy | Mean PnL |")
                md_lines.append("|---|---|---|---|---|---|---|---|---|---|")
                for regime, regime_stat in regime_stats.items():
                    md_lines.append(
                        f"| {regime} | {regime_stat['count']} | {regime_stat['win_rate']:.2f} | {regime_stat['average_win']:.2f} | {regime_stat['average_loss']:.2f} | {regime_stat['largest_win']:.2f} | {regime_stat['largest_loss']:.2f} | {regime_stat['profit_factor']:.2f} | {regime_stat['expectancy']:.2f} | {regime_stat['mean_pnl']:.2f} |"
                    )
                # --- Regime-wise Barplot and Boxplot ---
                # Convert to DataFrame for plotting
                trades_df = pd.DataFrame(trade_log_records)
                if 'regime' in trades_df.columns and 'pnl' in trades_df.columns:
                    plots_dir = os.path.join(os.getcwd(), 'plots')
                    os.makedirs(plots_dir, exist_ok=True)
                    # Barplot: Mean PnL per regime
                    barplot_path = os.path.join(plots_dir, 'regime_barplot.png')
                    plt.figure(figsize=(5,3), facecolor='white')
                    sns.barplot(data=trades_df, x='regime', y='pnl', estimator='mean', errorbar=None, hue='regime', palette='Set2', legend=False)
                    plt.title('Mean PnL by Regime')
                    plt.xlabel('Regime')
                    plt.ylabel('Mean PnL')
                    plt.tight_layout()
                    plt.savefig(barplot_path)
                    plt.close()
                    md_lines.append(f"\n![Mean PnL by Regime](plots/regime_barplot.png)\n")
                    # Boxplot: PnL distribution per regime
                    boxplot_path = os.path.join(plots_dir, 'regime_boxplot.png')
                    plt.figure(figsize=(5,3), facecolor='white')
                    sns.boxplot(data=trades_df, x='regime', y='pnl', hue='regime', palette='Set2', legend=False)
                    plt.title('PnL Distribution by Regime')
                    plt.xlabel('Regime')
                    plt.ylabel('PnL')
                    plt.tight_layout()
                    plt.savefig(boxplot_path)
                    plt.close()
                    md_lines.append(f"\n![PnL Distribution by Regime](plots/regime_boxplot.png)\n")
            else:
                md_lines.append("No regime breakdown available.\n")
        else:
            md_lines.append("No trades for regime breakdown.\n")
        # --- Regime Barplot (always generate if regime_series present) ---
        regime_barplot_path = f"plots/regime_barplot.png"
        regime_series = stats.get('regime_series')
        if regime_series is not None and len(regime_series) > 0:
>           regime_counts = pd.Series(list(regime_series.values())).value_counts()
E           TypeError: 'numpy.ndarray' object is not callable

D:\Code\projects\tapp\code\2025\simpler_st\report_generator.py:686: TypeError
---------------------------- Captured stdout call -----------------------------
[DEBUG] portfolio_backtest result: {'portfolio_state': <tech_analysis.portfolio.PortfolioState object at 0x000001BD3D0ABA30>, 'trade_log': [{'entry_index': Timestamp('2024-05-07 00:00:00+0530', tz='Asia/Kolkata'), 'exit_index': Timestamp('2024-05-15 00:00:00+0530', tz='Asia/Kolkata'), 'entry_price': 3922.1474609375, 'exit_price': 3825.004150390625, 'pnl': -97.143310546875, 'commission_cost': 0, 'regime': 'ranging', 'entry_regime': 'ranging', 'exit_regime': 'ranging', 'EntryRegime': 'ranging', 'ExitRegime': 'ranging', 'volatility': 56.90241322592916, 'exit_volatility': 53.15168265247338, 'entry_volatility': 56.90241322592916, 'EntryVolatility': 56.90241322592916, 'ExitVolatility': 53.15168265247338, 'volume': 2062112.0, 'exit_volume': 1115021.0, 'entry_volume': 2062112.0, 'volume_entry': 2062112.0, 'volume_exit': 1115021.0, 'EntryVolume': 2062112.0, 'ExitVolume': 1115021.0, 'atr_entry': 80.57475746387483, 'atr_exit': 72.52878284862204, 'EntryATR': 80.57475746387483, 'ExitATR': 72.52878284862204, 'entry_sma_short': 3830.0021484375, 'exit_sma_short': 3860.786181640625, 'entry_sma_long': 3827.4934895833335, 'exit_sma_long': 3860.801025390625, 'EntrySMA_Short': 3830.0021484375, 'ExitSMA_Short': 3860.786181640625, 'EntrySMA_Long': 3827.4934895833335, 'ExitSMA_Long': 3860.801025390625, 'entry_rsi': nan, 'exit_rsi': nan, 'EntryRSI': nan, 'ExitRSI': nan, 'rationale': 'Sell: short SMA crossed below long SMA at index 2024-05-15 00:00:00+05:30', 'Rationale': 'Sell: short SMA crossed below long SMA at index 2024-05-15 00:00:00+05:30', 'ticker': 'TCS.NS', 'context': [3766.107421875, 3808.14892578125, 3788.53271484375, 3865.07421875, 3922.1474609375, 3920.176025390625, 3903.665283203125, 3838.311767578125, 3891.4423828125, 3845.50732421875, 3825.004150390625], 'indicators': {'sma_short': 3830.0021484375, 'sma_long': 3827.4934895833335, 'rsi': nan, 'atr': 80.57475746387483, 'volatility': 56.90241322592916}, 'action': 'buy', 'qty': 2062112.0}, {'entry_index': Timestamp('2024-06-10 00:00:00+0530', tz='Asia/Kolkata'), 'exit_index': Timestamp('2024-06-19 00:00:00+0530', tz='Asia/Kolkata'), 'entry_price': 3831.25927734375, 'exit_price': 3774.6650390625, 'pnl': -56.59423828125, 'commission_cost': 0, 'regime': 'ranging', 'entry_regime': 'ranging', 'exit_regime': 'ranging', 'EntryRegime': 'ranging', 'ExitRegime': 'ranging', 'volatility': 73.70093435753122, 'exit_volatility': 52.95708470234185, 'entry_volatility': 73.70093435753122, 'EntryVolatility': 73.70093435753122, 'ExitVolatility': 52.95708470234185, 'volume': 1734661.0, 'exit_volume': 1509050.0, 'entry_volume': 1734661.0, 'volume_entry': 1734661.0, 'volume_exit': 1509050.0, 'EntryVolume': 1734661.0, 'ExitVolume': 1509050.0, 'atr_entry': 74.99142294418286, 'atr_exit': 75.27159552378791, 'EntryATR': 74.99142294418286, 'ExitATR': 75.27159552378791, 'entry_sma_short': 3781.813671875, 'exit_sma_short': 3804.481396484375, 'entry_sma_long': 3752.9156494140625, 'exit_sma_long': 3806.7600341796874, 'EntrySMA_Short': 3781.813671875, 'ExitSMA_Short': 3804.481396484375, 'EntrySMA_Long': 3752.9156494140625, 'ExitSMA_Long': 3806.7600341796874, 'entry_rsi': 53.47471514144394, 'exit_rsi': 49.81979324291707, 'EntryRSI': 53.47471514144394, 'ExitRSI': 49.81979324291707, 'rationale': 'Sell: short SMA crossed below long SMA at index 2024-06-19 00:00:00+05:30', 'Rationale': 'Sell: short SMA crossed below long SMA at index 2024-06-19 00:00:00+05:30', 'ticker': 'TCS.NS', 'context': [3688.58154296875, 3719.807861328125, 3803.160888671875, 3866.2587890625, 3831.25927734375, 3824.70654296875, 3804.40185546875, 3850.5712890625, 3804.799072265625, 3787.9697265625, 3774.6650390625], 'indicators': {'sma_short': 3781.813671875, 'sma_long': 3752.9156494140625, 'rsi': 53.47471514144394, 'atr': 74.99142294418286, 'volatility': 73.70093435753122}, 'action': 'buy', 'qty': 1734661.0}, {'entry_index': Timestamp('2024-06-27 00:00:00+0530', tz='Asia/Kolkata'), 'exit_index': Timestamp('2024-07-11 00:00:00+0530', tz='Asia/Kolkata'), 'entry_price': 3906.1728515625, 'exit_price': 3895.79736328125, 'pnl': -10.37548828125, 'commission_cost': 0, 'regime': 'ranging', 'entry_regime': 'ranging', 'exit_regime': 'ranging', 'EntryRegime': 'ranging', 'ExitRegime': 'ranging', 'volatility': 40.741686812511006, 'exit_volatility': 43.121540784374076, 'entry_volatility': 40.741686812511006, 'EntryVolatility': 40.741686812511006, 'ExitVolatility': 43.121540784374076, 'volume': 4526556.0, 'exit_volume': 4872189.0, 'entry_volume': 4526556.0, 'volume_entry': 4526556.0, 'volume_exit': 4872189.0, 'EntryVolume': 4526556.0, 'ExitVolume': 4872189.0, 'atr_entry': 60.573288337544646, 'atr_exit': 68.12633870847655, 'EntryATR': 60.573288337544646, 'ExitATR': 68.12633870847655, 'entry_sma_short': 3823.812841796875, 'exit_sma_short': 3936.4759765625, 'entry_sma_long': 3809.7386962890623, 'exit_sma_long': 3942.6914306640624, 'EntrySMA_Short': 3823.812841796875, 'ExitSMA_Short': 3936.4759765625, 'EntrySMA_Long': 3809.7386962890623, 'ExitSMA_Long': 3942.6914306640624, 'entry_rsi': 62.647786876351525, 'exit_rsi': 61.27584449657174, 'EntryRSI': 62.647786876351525, 'ExitRSI': 61.27584449657174, 'rationale': 'Sell: short SMA crossed below long SMA at index 2024-07-11 00:00:00+05:30', 'Rationale': 'Sell: short SMA crossed below long SMA at index 2024-07-11 00:00:00+05:30', 'ticker': 'TCS.NS', 'context': [3906.1728515625, 3876.38623046875, 3949.90966796875, 3988.8310546875, 3937.0517578125, 3992.355712890625, 3983.270751953125, 3964.80322265625, 3957.15771484375, 3881.350830078125, 3895.79736328125], 'indicators': {'sma_short': 3823.812841796875, 'sma_long': 3809.7386962890623, 'rsi': 62.647786876351525, 'atr': 60.573288337544646, 'volatility': 40.741686812511006}, 'action': 'buy', 'qty': 4526556.0}, {'entry_index': Timestamp('2024-07-12 00:00:00+0530', tz='Asia/Kolkata'), 'exit_index': Timestamp('2024-08-05 00:00:00+0530', tz='Asia/Kolkata'), 'entry_price': 4154.19677734375, 'exit_price': 4135.083984375, 'pnl': -19.11279296875, 'commission_cost': 0, 'regime': 'ranging', 'entry_regime': 'ranging', 'exit_regime': 'ranging', 'EntryRegime': 'ranging', 'ExitRegime': 'ranging', 'volatility': 76.19057751949774, 'exit_volatility': 70.71970117528711, 'entry_volatility': 76.19057751949774, 'EntryVolatility': 76.19057751949774, 'ExitVolatility': 70.71970117528711, 'volume': 7525190.670000001, 'exit_volume': 2787771.0, 'entry_volume': 7525190.670000001, 'volume_entry': 7525190.670000001, 'volume_exit': 2787771.0, 'EntryVolume': 7525190.670000001, 'ExitVolume': 2787771.0, 'atr_entry': 83.0586884719575, 'atr_exit': 87.59512199688733, 'EntryATR': 83.0586884719575, 'ExitATR': 87.59512199688733, 'entry_sma_short': 3970.661181640625, 'exit_sma_short': 4296.43486328125, 'entry_sma_long': 3970.4724853515627, 'exit_sma_long': 4307.794970703125, 'EntrySMA_Short': 3970.661181640625, 'ExitSMA_Short': 4296.43486328125, 'EntrySMA_Long': 3970.4724853515627, 'ExitSMA_Long': 4307.794970703125, 'entry_rsi': 74.31296453276182, 'exit_rsi': 49.59988735626555, 'EntryRSI': 74.31296453276182, 'ExitRSI': 49.59988735626555, 'rationale': 'Sell: short SMA crossed below long SMA at index 2024-08-05 00:00:00+05:30', 'Rationale': 'Sell: short SMA crossed below long SMA at index 2024-08-05 00:00:00+05:30', 'ticker': 'TCS.NS', 'context': [4266.748046875, 4281.67626953125, 4285.55712890625, 4301.72900390625, 4366.76513671875, 4360.0478515625, 4344.37353515625, 4364.27734375, 4375.970703125, 4262.46875, 4135.083984375], 'indicators': {'sma_short': 3970.661181640625, 'sma_long': 3970.4724853515627, 'rsi': 74.31296453276182, 'atr': 83.0586884719575, 'volatility': 76.19057751949774}, 'action': 'buy', 'qty': 7525190.670000001}, {'entry_index': Timestamp('2024-08-16 00:00:00+0530', tz='Asia/Kolkata'), 'exit_index': Timestamp('2024-09-06 00:00:00+0530', tz='Asia/Kolkata'), 'entry_price': 4394.82958984375, 'exit_price': 4435.333984375, 'pnl': 40.50439453125, 'commission_cost': 0, 'regime': 'ranging', 'entry_regime': 'ranging', 'exit_regime': 'ranging', 'EntryRegime': 'ranging', 'ExitRegime': 'ranging', 'volatility': 90.18373170491661, 'exit_volatility': 22.83686693167127, 'entry_volatility': 90.18373170491661, 'EntryVolatility': 90.18373170491661, 'ExitVolatility': 22.83686693167127, 'volume': 3457058.0, 'exit_volume': 1649179.0, 'entry_volume': 3457058.0, 'volume_entry': 3457058.0, 'volume_exit': 1649179.0, 'EntryVolume': 3457058.0, 'ExitVolume': 1649179.0, 'atr_entry': 88.00362633133464, 'atr_exit': 68.90238267528086, 'EntryATR': 88.00362633133464, 'ExitATR': 68.90238267528086, 'entry_sma_short': 4246.02822265625, 'exit_sma_short': 4467.49873046875, 'entry_sma_long': 4211.1615234375, 'exit_sma_long': 4476.960168457032, 'EntrySMA_Short': 4246.02822265625, 'ExitSMA_Short': 4467.49873046875, 'EntrySMA_Long': 4211.1615234375, 'ExitSMA_Long': 4476.960168457032, 'entry_rsi': 52.07566521249242, 'exit_rsi': 42.706203209016586, 'EntryRSI': 52.07566521249242, 'ExitRSI': 42.706203209016586, 'rationale': 'Buy: short SMA crossed above long SMA at index 2024-08-16 00:00:00+05:30', 'Rationale': 'Buy: short SMA crossed above long SMA at index 2024-08-16 00:00:00+05:30', 'ticker': 'TCS.NS', 'context': [4442.44970703125, 4480.814453125, 4475.5400390625, 4484.39697265625, 4490.11962890625, 4501.2369384765625, 4499.32470703125, 4490.6669921875, 4457.72607421875, 4454.44189453125, 4435.333984375], 'indicators': {'sma_short': 4246.02822265625, 'sma_long': 4211.1615234375, 'rsi': 52.07566521249242, 'atr': 88.00362633133464, 'volatility': 90.18373170491661}, 'action': 'buy', 'qty': 3457058.0}, {'entry_index': Timestamp('2024-09-13 00:00:00+0530', tz='Asia/Kolkata'), 'exit_index': Timestamp('2024-09-19 00:00:00+0530', tz='Asia/Kolkata'), 'entry_price': 4500.8681640625, 'exit_price': 4275.50537109375, 'pnl': -225.36279296875, 'commission_cost': 0, 'regime': 'ranging', 'entry_regime': 'ranging', 'exit_regime': 'ranging', 'EntryRegime': 'ranging', 'ExitRegime': 'ranging', 'volatility': 27.41547925522337, 'exit_volatility': 73.80808359558365, 'entry_volatility': 27.41547925522337, 'EntryVolatility': 27.41547925522337, 'ExitVolatility': 73.80808359558365, 'volume': 1458786.0, 'exit_volume': 2927551.0, 'entry_volume': 1458786.0, 'volume_entry': 1458786.0, 'volume_exit': 2927551.0, 'EntryVolume': 1458786.0, 'ExitVolume': 2927551.0, 'atr_entry': 71.93715416122015, 'atr_exit': 82.31733460326164, 'EntryATR': 71.93715416122015, 'ExitATR': 82.31733460326164, 'entry_sma_short': 4473.8083984375, 'exit_sma_short': 4415.44013671875, 'entry_sma_long': 4470.653564453125, 'exit_sma_long': 4438.070849609375, 'EntrySMA_Short': 4473.8083984375, 'ExitSMA_Short': 4415.44013671875, 'EntrySMA_Long': 4470.653564453125, 'ExitSMA_Long': 4438.070849609375, 'entry_rsi': 54.294798661051814, 'exit_rsi': 23.620649466291155, 'EntryRSI': 54.294798661051814, 'ExitRSI': 23.620649466291155, 'rationale': 'Sell: short SMA crossed below long SMA at index 2024-09-19 00:00:00+05:30', 'Rationale': 'Sell: short SMA crossed below long SMA at index 2024-09-19 00:00:00+05:30', 'ticker': 'TCS.NS', 'context': [4454.44189453125, 4435.333984375, 4428.16845703125, 4486.1884765625, 4457.82568359375, 4495.9912109375, 4500.8681640625, 4491.5625, 4483.9990234375, 4325.265625, 4275.50537109375], 'indicators': {'sma_short': 4473.8083984375, 'sma_long': 4470.653564453125, 'rsi': 54.294798661051814, 'atr': 71.93715416122015, 'volatility': 27.41547925522337}, 'action': 'buy', 'qty': 1458786.0}, {'entry_index': Timestamp('2024-11-08 00:00:00+0530', tz='Asia/Kolkata'), 'exit_index': Timestamp('2024-11-19 00:00:00+0530', tz='Asia/Kolkata'), 'entry_price': 4137.14111328125, 'exit_price': 4029.946533203125, 'pnl': -107.194580078125, 'commission_cost': 0, 'regime': 'ranging', 'entry_regime': 'ranging', 'exit_regime': 'ranging', 'EntryRegime': 'ranging', 'ExitRegime': 'ranging', 'volatility': 74.04313080270711, 'exit_volatility': 86.5855992275758, 'entry_volatility': 74.04313080270711, 'EntryVolatility': 74.04313080270711, 'ExitVolatility': 86.5855992275758, 'volume': 1648039.0, 'exit_volume': 1776233.0, 'entry_volume': 1648039.0, 'volume_entry': 1648039.0, 'volume_exit': 1776233.0, 'EntryVolume': 1648039.0, 'ExitVolume': 1776233.0, 'atr_entry': 81.19928138178213, 'atr_exit': 92.4937800499738, 'EntryATR': 81.19928138178213, 'ExitATR': 92.4937800499738, 'entry_sma_short': 4064.923046875, 'exit_sma_short': 4100.767578125, 'entry_sma_long': 4047.998388671875, 'exit_sma_long': 4106.244580078125, 'EntrySMA_Short': 4064.923046875, 'ExitSMA_Short': 4100.767578125, 'EntrySMA_Long': 4047.998388671875, 'ExitSMA_Long': 4106.244580078125, 'entry_rsi': 56.171307635388764, 'exit_rsi': 47.039815845575866, 'EntryRSI': 56.171307635388764, 'ExitRSI': 47.039815845575866, 'rationale': 'Sell: short SMA crossed below long SMA at index 2024-11-19 00:00:00+05:30', 'Rationale': 'Sell: short SMA crossed below long SMA at index 2024-11-19 00:00:00+05:30', 'ticker': 'TCS.NS', 'context': [3954.7255859375, 3961.90869140625, 4129.80810546875, 4141.03173828125, 4137.14111328125, 4188.71826171875, 4187.4208984375, 4140.48291015625, 4136.04345703125, 4009.944091796875, 4029.946533203125], 'indicators': {'sma_short': 4064.923046875, 'sma_long': 4047.998388671875, 'rsi': 56.171307635388764, 'atr': 81.19928138178213, 'volatility': 74.04313080270711}, 'action': 'buy', 'qty': 1648039.0}, {'entry_index': Timestamp('2024-11-26 00:00:00+0530', tz='Asia/Kolkata'), 'exit_index': Timestamp('2024-12-17 00:00:00+0530', tz='Asia/Kolkata'), 'entry_price': 4342.35205078125, 'exit_price': 4318.20947265625, 'pnl': -24.142578125, 'commission_cost': 0, 'regime': 'ranging', 'entry_regime': 'ranging', 'exit_regime': 'ranging', 'EntryRegime': 'ranging', 'ExitRegime': 'ranging', 'volatility': 105.65264530579341, 'exit_volatility': 58.15581541489277, 'entry_volatility': 105.65264530579341, 'EntryVolatility': 105.65264530579341, 'ExitVolatility': 58.15581541489277, 'volume': 2060669.0, 'exit_volume': 3225027.0, 'entry_volume': 2060669.0, 'volume_entry': 2060669.0, 'volume_exit': 3225027.0, 'EntryVolume': 2060669.0, 'ExitVolume': 3225027.0, 'atr_entry': 101.66837201153193, 'atr_exit': 81.38469892513929, 'EntryATR': 101.66837201153193, 'ExitATR': 81.38469892513929, 'entry_sma_short': 4194.96318359375, 'exit_sma_short': 4409.4919921875, 'entry_sma_long': 4163.7425537109375, 'exit_sma_long': 4414.3453125, 'EntrySMA_Short': 4194.96318359375, 'ExitSMA_Short': 4409.4919921875, 'EntrySMA_Long': 4163.7425537109375, 'ExitSMA_Long': 4414.3453125, 'entry_rsi': 75.7403112990855, 'exit_rsi': 49.630874818649524, 'EntryRSI': 75.7403112990855, 'ExitRSI': 49.630874818649524, 'rationale': 'Sell: short SMA crossed below long SMA at index 2024-12-17 00:00:00+05:30', 'Rationale': 'Sell: short SMA crossed below long SMA at index 2024-12-17 00:00:00+05:30', 'ticker': 'TCS.NS', 'context': [4292.5205078125, 4344.0478515625, 4453.43701171875, 4434.93115234375, 4441.5654296875, 4422.01171875, 4416.92431640625, 4444.35888671875, 4463.263671875, 4404.70361328125, 4318.20947265625], 'indicators': {'sma_short': 4194.96318359375, 'sma_long': 4163.7425537109375, 'rsi': 75.7403112990855, 'atr': 101.66837201153193, 'volatility': 105.65264530579341}, 'action': 'buy', 'qty': 2060669.0}, {'entry_index': Timestamp('2025-01-13 00:00:00+0530', tz='Asia/Kolkata'), 'exit_index': Timestamp('2025-01-21 00:00:00+0530', tz='Asia/Kolkata'), 'entry_price': 4280.8984375, 'exit_price': 4035.85009765625, 'pnl': -245.04833984375, 'commission_cost': 0, 'regime': 'ranging', 'entry_regime': 'ranging', 'exit_regime': 'ranging', 'EntryRegime': 'ranging', 'ExitRegime': 'ranging', 'volatility': 83.42780760673094, 'exit_volatility': 98.31322678513557, 'entry_volatility': 83.42780760673094, 'EntryVolatility': 83.42780760673094, 'ExitVolatility': 98.31322678513557, 'volume': 4003771.0, 'exit_volume': 1971591.0, 'entry_volume': 4003771.0, 'volume_entry': 4003771.0, 'volume_exit': 1971591.0, 'EntryVolume': 4003771.0, 'ExitVolume': 1971591.0, 'atr_entry': 97.83472139194328, 'atr_exit': 104.15944718454502, 'EntryATR': 97.83472139194328, 'ExitATR': 104.15944718454502, 'entry_sma_short': 4136.602294921875, 'exit_sma_short': 4134.749365234375, 'entry_sma_long': 4121.1990234375, 'exit_sma_long': 4156.1021484375, 'EntrySMA_Short': 4136.602294921875, 'ExitSMA_Short': 4134.749365234375, 'EntrySMA_Long': 4121.1990234375, 'ExitSMA_Long': 4156.1021484375, 'entry_rsi': 59.01930124083204, 'exit_rsi': 46.242774725169134, 'EntryRSI': 59.01930124083204, 'ExitRSI': 46.242774725169134, 'rationale': 'Sell: short SMA crossed below long SMA at index 2025-01-21 00:00:00+05:30', 'Rationale': 'Sell: short SMA crossed below long SMA at index 2025-01-21 00:00:00+05:30', 'ticker': 'TCS.NS', 'context': [4018.72314453125, 4098.6328125, 4029.248291015625, 4255.5087890625, 4280.8984375, 4222.986328125, 4239.4970703125, 4196.2998046875, 4124.2998046875, 4077.800048828125, 4035.85009765625], 'indicators': {'sma_short': 4136.602294921875, 'sma_long': 4121.1990234375, 'rsi': 59.01930124083204, 'atr': 97.83472139194328, 'volatility': 83.42780760673094}, 'action': 'buy', 'qty': 4003771.0}, {'entry_index': Timestamp('2025-02-06 00:00:00+0530', tz='Asia/Kolkata'), 'exit_index': Timestamp('2025-02-07 00:00:00+0530', tz='Asia/Kolkata'), 'entry_price': 4082.75, 'exit_price': 4029.39990234375, 'pnl': -53.35009765625, 'commission_cost': 0, 'regime': 'ranging', 'entry_regime': 'ranging', 'exit_regime': 'ranging', 'EntryRegime': 'ranging', 'ExitRegime': 'ranging', 'volatility': 29.593025243778882, 'exit_volatility': 26.887761650462465, 'entry_volatility': 29.593025243778882, 'EntryVolatility': 29.593025243778882, 'ExitVolatility': 26.887761650462465, 'volume': 2284536.0, 'exit_volume': 1548940.0, 'entry_volume': 2284536.0, 'volume_entry': 2284536.0, 'volume_exit': 1548940.0, 'EntryVolume': 2284536.0, 'ExitVolume': 1548940.0, 'atr_entry': 76.97858537946429, 'atr_exit': 77.05001395089286, 'EntryATR': 76.97858537946429, 'ExitATR': 77.05001395089286, 'entry_sma_short': 4084.53994140625, 'exit_sma_short': 4075.78994140625, 'entry_sma_long': 4084.0399169921875, 'exit_sma_long': 4080.4649169921877, 'EntrySMA_Short': 4084.53994140625, 'ExitSMA_Short': 4075.78994140625, 'EntrySMA_Long': 4084.0399169921875, 'ExitSMA_Long': 4080.4649169921877, 'entry_rsi': 50.52508304210972, 'exit_rsi': 49.33193145141306, 'EntryRSI': 50.52508304210972, 'ExitRSI': 49.33193145141306, 'rationale': 'Sell: short SMA crossed below long SMA at index 2025-02-07 00:00:00+05:30', 'Rationale': 'Sell: short SMA crossed below long SMA at index 2025-02-07 00:00:00+05:30', 'ticker': 'TCS.NS', 'context': [4065.14990234375, 4040.300048828125, 4099.7998046875, 4100.0498046875, 4112.39990234375, 4073.14990234375, 4068.64990234375, 4107.0498046875, 4091.10009765625, 4082.75, 4029.39990234375], 'indicators': {'sma_short': 4084.53994140625, 'sma_long': 4084.0399169921875, 'rsi': 50.52508304210972, 'atr': 76.97858537946429, 'volatility': 29.593025243778882}, 'action': 'buy', 'qty': 2284536.0}, {'entry_index': Timestamp('2025-03-11 00:00:00+0530', tz='Asia/Kolkata'), 'exit_index': Timestamp('2025-03-17 00:00:00+0530', tz='Asia/Kolkata'), 'entry_price': 3575.300048828125, 'exit_price': 3497.699951171875, 'pnl': -77.60009765625, 'commission_cost': 0, 'regime': 'ranging', 'entry_regime': 'ranging', 'exit_regime': 'ranging', 'EntryRegime': 'ranging', 'ExitRegime': 'ranging', 'volatility': 58.68373789861608, 'exit_volatility': 46.772694032445195, 'entry_volatility': 58.68373789861608, 'EntryVolatility': 58.68373789861608, 'ExitVolatility': 46.772694032445195, 'volume': 1995450.0, 'exit_volume': 2690906.0, 'entry_volume': 1995450.0, 'volume_entry': 1995450.0, 'volume_exit': 2690906.0, 'EntryVolume': 1995450.0, 'ExitVolume': 2690906.0, 'atr_entry': 69.81787109375, 'atr_exit': 69.54999651227679, 'EntryATR': 69.81787109375, 'ExitATR': 69.54999651227679, 'entry_sma_short': 3584.960009765625, 'exit_sma_short': 3535.97998046875, 'entry_sma_long': 3567.5250244140625, 'exit_sma_long': 3546.485009765625, 'EntrySMA_Short': 3584.960009765625, 'ExitSMA_Short': 3535.97998046875, 'EntrySMA_Long': 3567.5250244140625, 'ExitSMA_Long': 3546.485009765625, 'entry_rsi': 23.730167341820987, 'exit_rsi': 23.97544930634372, 'EntryRSI': 23.730167341820987, 'ExitRSI': 23.97544930634372, 'rationale': 'Sell: short SMA crossed below long SMA at index 2025-03-17 00:00:00+05:30', 'Rationale': 'Sell: short SMA crossed below long SMA at index 2025-03-17 00:00:00+05:30', 'ticker': 'TCS.NS', 'context': [3483.25, 3493.050048828125, 3532.050048828125, 3547.050048828125, 3601.60009765625, 3611.199951171875, 3589.64990234375, 3575.300048828125, 3506.199951171875, 3511.050048828125, 3497.699951171875], 'indicators': {'sma_short': 3584.960009765625, 'sma_long': 3567.5250244140625, 'rsi': 23.730167341820987, 'atr': 69.81787109375, 'volatility': 58.68373789861608}, 'action': 'buy', 'qty': 1995450.0}, {'entry_index': Timestamp('2025-03-24 00:00:00+0530', tz='Asia/Kolkata'), 'exit_index': Timestamp('2025-04-03 00:00:00+0530', tz='Asia/Kolkata'), 'entry_price': 3628.949951171875, 'exit_price': 3403.14990234375, 'pnl': -225.800048828125, 'commission_cost': 0, 'regime': 'ranging', 'entry_regime': 'ranging', 'exit_regime': 'ranging', 'EntryRegime': 'ranging', 'ExitRegime': 'ranging', 'volatility': 49.85420920208332, 'exit_volatility': 75.84522591169444, 'entry_volatility': 49.85420920208332, 'EntryVolatility': 49.85420920208332, 'ExitVolatility': 75.84522591169444, 'volume': 1834751.0, 'exit_volume': 4537821.0, 'entry_volume': 1834751.0, 'volume_entry': 1834751.0, 'volume_exit': 4537821.0, 'EntryVolume': 1834751.0, 'ExitVolume': 4537821.0, 'atr_entry': 68.84995814732143, 'atr_exit': 72.43211146763393, 'EntryATR': 68.84995814732143, 'ExitATR': 72.43211146763393, 'entry_sma_short': 3553.0, 'exit_sma_short': 3551.049951171875, 'entry_sma_long': 3544.489990234375, 'exit_sma_long': 3581.8999755859377, 'EntrySMA_Short': 3553.0, 'ExitSMA_Short': 3551.049951171875, 'EntrySMA_Long': 3544.489990234375, 'ExitSMA_Long': 3581.8999755859377, 'entry_rsi': 68.17816658001782, 'exit_rsi': 38.91577053872717, 'EntryRSI': 68.17816658001782, 'ExitRSI': 38.91577053872717, 'rationale': 'Sell: short SMA crossed below long SMA at index 2025-04-03 00:00:00+05:30', 'Rationale': 'Sell: short SMA crossed below long SMA at index 2025-04-03 00:00:00+05:30', 'ticker': 'TCS.NS', 'context': [3497.10009765625, 3563.14990234375, 3578.10009765625, 3628.949951171875, 3657.75, 3635.800048828125, 3651.199951171875, 3606.14990234375, 3550.800048828125, 3543.949951171875, 3403.14990234375], 'indicators': {'sma_short': 3553.0, 'sma_long': 3544.489990234375, 'rsi': 68.17816658001782, 'atr': 68.84995814732143, 'volatility': 49.85420920208332}, 'action': 'buy', 'qty': 1834751.0}], 'strategy_params': {'short_window': 5, 'long_window': 10, 'position_size': 123, 'initial_cash': 5555}, 'assets': ['TCS.NS']}
[DEBUG] Trade log: [{'entry_index': Timestamp('2024-05-07 00:00:00+0530', tz='Asia/Kolkata'), 'exit_index': Timestamp('2024-05-15 00:00:00+0530', tz='Asia/Kolkata'), 'entry_price': 3922.1474609375, 'exit_price': 3825.004150390625, 'pnl': -97.143310546875, 'commission_cost': 0, 'regime': 'ranging', 'entry_regime': 'ranging', 'exit_regime': 'ranging', 'EntryRegime': 'ranging', 'ExitRegime': 'ranging', 'volatility': 56.90241322592916, 'exit_volatility': 53.15168265247338, 'entry_volatility': 56.90241322592916, 'EntryVolatility': 56.90241322592916, 'ExitVolatility': 53.15168265247338, 'volume': 2062112.0, 'exit_volume': 1115021.0, 'entry_volume': 2062112.0, 'volume_entry': 2062112.0, 'volume_exit': 1115021.0, 'EntryVolume': 2062112.0, 'ExitVolume': 1115021.0, 'atr_entry': 80.57475746387483, 'atr_exit': 72.52878284862204, 'EntryATR': 80.57475746387483, 'ExitATR': 72.52878284862204, 'entry_sma_short': 3830.0021484375, 'exit_sma_short': 3860.786181640625, 'entry_sma_long': 3827.4934895833335, 'exit_sma_long': 3860.801025390625, 'EntrySMA_Short': 3830.0021484375, 'ExitSMA_Short': 3860.786181640625, 'EntrySMA_Long': 3827.4934895833335, 'ExitSMA_Long': 3860.801025390625, 'entry_rsi': nan, 'exit_rsi': nan, 'EntryRSI': nan, 'ExitRSI': nan, 'rationale': 'Sell: short SMA crossed below long SMA at index 2024-05-15 00:00:00+05:30', 'Rationale': 'Sell: short SMA crossed below long SMA at index 2024-05-15 00:00:00+05:30', 'ticker': 'TCS.NS', 'context': [3766.107421875, 3808.14892578125, 3788.53271484375, 3865.07421875, 3922.1474609375, 3920.176025390625, 3903.665283203125, 3838.311767578125, 3891.4423828125, 3845.50732421875, 3825.004150390625], 'indicators': {'sma_short': 3830.0021484375, 'sma_long': 3827.4934895833335, 'rsi': nan, 'atr': 80.57475746387483, 'volatility': 56.90241322592916}, 'action': 'buy', 'qty': 2062112.0}, {'entry_index': Timestamp('2024-06-10 00:00:00+0530', tz='Asia/Kolkata'), 'exit_index': Timestamp('2024-06-19 00:00:00+0530', tz='Asia/Kolkata'), 'entry_price': 3831.25927734375, 'exit_price': 3774.6650390625, 'pnl': -56.59423828125, 'commission_cost': 0, 'regime': 'ranging', 'entry_regime': 'ranging', 'exit_regime': 'ranging', 'EntryRegime': 'ranging', 'ExitRegime': 'ranging', 'volatility': 73.70093435753122, 'exit_volatility': 52.95708470234185, 'entry_volatility': 73.70093435753122, 'EntryVolatility': 73.70093435753122, 'ExitVolatility': 52.95708470234185, 'volume': 1734661.0, 'exit_volume': 1509050.0, 'entry_volume': 1734661.0, 'volume_entry': 1734661.0, 'volume_exit': 1509050.0, 'EntryVolume': 1734661.0, 'ExitVolume': 1509050.0, 'atr_entry': 74.99142294418286, 'atr_exit': 75.27159552378791, 'EntryATR': 74.99142294418286, 'ExitATR': 75.27159552378791, 'entry_sma_short': 3781.813671875, 'exit_sma_short': 3804.481396484375, 'entry_sma_long': 3752.9156494140625, 'exit_sma_long': 3806.7600341796874, 'EntrySMA_Short': 3781.813671875, 'ExitSMA_Short': 3804.481396484375, 'EntrySMA_Long': 3752.9156494140625, 'ExitSMA_Long': 3806.7600341796874, 'entry_rsi': 53.47471514144394, 'exit_rsi': 49.81979324291707, 'EntryRSI': 53.47471514144394, 'ExitRSI': 49.81979324291707, 'rationale': 'Sell: short SMA crossed below long SMA at index 2024-06-19 00:00:00+05:30', 'Rationale': 'Sell: short SMA crossed below long SMA at index 2024-06-19 00:00:00+05:30', 'ticker': 'TCS.NS', 'context': [3688.58154296875, 3719.807861328125, 3803.160888671875, 3866.2587890625, 3831.25927734375, 3824.70654296875, 3804.40185546875, 3850.5712890625, 3804.799072265625, 3787.9697265625, 3774.6650390625], 'indicators': {'sma_short': 3781.813671875, 'sma_long': 3752.9156494140625, 'rsi': 53.47471514144394, 'atr': 74.99142294418286, 'volatility': 73.70093435753122}, 'action': 'buy', 'qty': 1734661.0}, {'entry_index': Timestamp('2024-06-27 00:00:00+0530', tz='Asia/Kolkata'), 'exit_index': Timestamp('2024-07-11 00:00:00+0530', tz='Asia/Kolkata'), 'entry_price': 3906.1728515625, 'exit_price': 3895.79736328125, 'pnl': -10.37548828125, 'commission_cost': 0, 'regime': 'ranging', 'entry_regime': 'ranging', 'exit_regime': 'ranging', 'EntryRegime': 'ranging', 'ExitRegime': 'ranging', 'volatility': 40.741686812511006, 'exit_volatility': 43.121540784374076, 'entry_volatility': 40.741686812511006, 'EntryVolatility': 40.741686812511006, 'ExitVolatility': 43.121540784374076, 'volume': 4526556.0, 'exit_volume': 4872189.0, 'entry_volume': 4526556.0, 'volume_entry': 4526556.0, 'volume_exit': 4872189.0, 'EntryVolume': 4526556.0, 'ExitVolume': 4872189.0, 'atr_entry': 60.573288337544646, 'atr_exit': 68.12633870847655, 'EntryATR': 60.573288337544646, 'ExitATR': 68.12633870847655, 'entry_sma_short': 3823.812841796875, 'exit_sma_short': 3936.4759765625, 'entry_sma_long': 3809.7386962890623, 'exit_sma_long': 3942.6914306640624, 'EntrySMA_Short': 3823.812841796875, 'ExitSMA_Short': 3936.4759765625, 'EntrySMA_Long': 3809.7386962890623, 'ExitSMA_Long': 3942.6914306640624, 'entry_rsi': 62.647786876351525, 'exit_rsi': 61.27584449657174, 'EntryRSI': 62.647786876351525, 'ExitRSI': 61.27584449657174, 'rationale': 'Sell: short SMA crossed below long SMA at index 2024-07-11 00:00:00+05:30', 'Rationale': 'Sell: short SMA crossed below long SMA at index 2024-07-11 00:00:00+05:30', 'ticker': 'TCS.NS', 'context': [3906.1728515625, 3876.38623046875, 3949.90966796875, 3988.8310546875, 3937.0517578125, 3992.355712890625, 3983.270751953125, 3964.80322265625, 3957.15771484375, 3881.350830078125, 3895.79736328125], 'indicators': {'sma_short': 3823.812841796875, 'sma_long': 3809.7386962890623, 'rsi': 62.647786876351525, 'atr': 60.573288337544646, 'volatility': 40.741686812511006}, 'action': 'buy', 'qty': 4526556.0}, {'entry_index': Timestamp('2024-07-12 00:00:00+0530', tz='Asia/Kolkata'), 'exit_index': Timestamp('2024-08-05 00:00:00+0530', tz='Asia/Kolkata'), 'entry_price': 4154.19677734375, 'exit_price': 4135.083984375, 'pnl': -19.11279296875, 'commission_cost': 0, 'regime': 'ranging', 'entry_regime': 'ranging', 'exit_regime': 'ranging', 'EntryRegime': 'ranging', 'ExitRegime': 'ranging', 'volatility': 76.19057751949774, 'exit_volatility': 70.71970117528711, 'entry_volatility': 76.19057751949774, 'EntryVolatility': 76.19057751949774, 'ExitVolatility': 70.71970117528711, 'volume': 7525190.670000001, 'exit_volume': 2787771.0, 'entry_volume': 7525190.670000001, 'volume_entry': 7525190.670000001, 'volume_exit': 2787771.0, 'EntryVolume': 7525190.670000001, 'ExitVolume': 2787771.0, 'atr_entry': 83.0586884719575, 'atr_exit': 87.59512199688733, 'EntryATR': 83.0586884719575, 'ExitATR': 87.59512199688733, 'entry_sma_short': 3970.661181640625, 'exit_sma_short': 4296.43486328125, 'entry_sma_long': 3970.4724853515627, 'exit_sma_long': 4307.794970703125, 'EntrySMA_Short': 3970.661181640625, 'ExitSMA_Short': 4296.43486328125, 'EntrySMA_Long': 3970.4724853515627, 'ExitSMA_Long': 4307.794970703125, 'entry_rsi': 74.31296453276182, 'exit_rsi': 49.59988735626555, 'EntryRSI': 74.31296453276182, 'ExitRSI': 49.59988735626555, 'rationale': 'Sell: short SMA crossed below long SMA at index 2024-08-05 00:00:00+05:30', 'Rationale': 'Sell: short SMA crossed below long SMA at index 2024-08-05 00:00:00+05:30', 'ticker': 'TCS.NS', 'context': [4266.748046875, 4281.67626953125, 4285.55712890625, 4301.72900390625, 4366.76513671875, 4360.0478515625, 4344.37353515625, 4364.27734375, 4375.970703125, 4262.46875, 4135.083984375], 'indicators': {'sma_short': 3970.661181640625, 'sma_long': 3970.4724853515627, 'rsi': 74.31296453276182, 'atr': 83.0586884719575, 'volatility': 76.19057751949774}, 'action': 'buy', 'qty': 7525190.670000001}, {'entry_index': Timestamp('2024-08-16 00:00:00+0530', tz='Asia/Kolkata'), 'exit_index': Timestamp('2024-09-06 00:00:00+0530', tz='Asia/Kolkata'), 'entry_price': 4394.82958984375, 'exit_price': 4435.333984375, 'pnl': 40.50439453125, 'commission_cost': 0, 'regime': 'ranging', 'entry_regime': 'ranging', 'exit_regime': 'ranging', 'EntryRegime': 'ranging', 'ExitRegime': 'ranging', 'volatility': 90.18373170491661, 'exit_volatility': 22.83686693167127, 'entry_volatility': 90.18373170491661, 'EntryVolatility': 90.18373170491661, 'ExitVolatility': 22.83686693167127, 'volume': 3457058.0, 'exit_volume': 1649179.0, 'entry_volume': 3457058.0, 'volume_entry': 3457058.0, 'volume_exit': 1649179.0, 'EntryVolume': 3457058.0, 'ExitVolume': 1649179.0, 'atr_entry': 88.00362633133464, 'atr_exit': 68.90238267528086, 'EntryATR': 88.00362633133464, 'ExitATR': 68.90238267528086, 'entry_sma_short': 4246.02822265625, 'exit_sma_short': 4467.49873046875, 'entry_sma_long': 4211.1615234375, 'exit_sma_long': 4476.960168457032, 'EntrySMA_Short': 4246.02822265625, 'ExitSMA_Short': 4467.49873046875, 'EntrySMA_Long': 4211.1615234375, 'ExitSMA_Long': 4476.960168457032, 'entry_rsi': 52.07566521249242, 'exit_rsi': 42.706203209016586, 'EntryRSI': 52.07566521249242, 'ExitRSI': 42.706203209016586, 'rationale': 'Buy: short SMA crossed above long SMA at index 2024-08-16 00:00:00+05:30', 'Rationale': 'Buy: short SMA crossed above long SMA at index 2024-08-16 00:00:00+05:30', 'ticker': 'TCS.NS', 'context': [4442.44970703125, 4480.814453125, 4475.5400390625, 4484.39697265625, 4490.11962890625, 4501.2369384765625, 4499.32470703125, 4490.6669921875, 4457.72607421875, 4454.44189453125, 4435.333984375], 'indicators': {'sma_short': 4246.02822265625, 'sma_long': 4211.1615234375, 'rsi': 52.07566521249242, 'atr': 88.00362633133464, 'volatility': 90.18373170491661}, 'action': 'buy', 'qty': 3457058.0}, {'entry_index': Timestamp('2024-09-13 00:00:00+0530', tz='Asia/Kolkata'), 'exit_index': Timestamp('2024-09-19 00:00:00+0530', tz='Asia/Kolkata'), 'entry_price': 4500.8681640625, 'exit_price': 4275.50537109375, 'pnl': -225.36279296875, 'commission_cost': 0, 'regime': 'ranging', 'entry_regime': 'ranging', 'exit_regime': 'ranging', 'EntryRegime': 'ranging', 'ExitRegime': 'ranging', 'volatility': 27.41547925522337, 'exit_volatility': 73.80808359558365, 'entry_volatility': 27.41547925522337, 'EntryVolatility': 27.41547925522337, 'ExitVolatility': 73.80808359558365, 'volume': 1458786.0, 'exit_volume': 2927551.0, 'entry_volume': 1458786.0, 'volume_entry': 1458786.0, 'volume_exit': 2927551.0, 'EntryVolume': 1458786.0, 'ExitVolume': 2927551.0, 'atr_entry': 71.93715416122015, 'atr_exit': 82.31733460326164, 'EntryATR': 71.93715416122015, 'ExitATR': 82.31733460326164, 'entry_sma_short': 4473.8083984375, 'exit_sma_short': 4415.44013671875, 'entry_sma_long': 4470.653564453125, 'exit_sma_long': 4438.070849609375, 'EntrySMA_Short': 4473.8083984375, 'ExitSMA_Short': 4415.44013671875, 'EntrySMA_Long': 4470.653564453125, 'ExitSMA_Long': 4438.070849609375, 'entry_rsi': 54.294798661051814, 'exit_rsi': 23.620649466291155, 'EntryRSI': 54.294798661051814, 'ExitRSI': 23.620649466291155, 'rationale': 'Sell: short SMA crossed below long SMA at index 2024-09-19 00:00:00+05:30', 'Rationale': 'Sell: short SMA crossed below long SMA at index 2024-09-19 00:00:00+05:30', 'ticker': 'TCS.NS', 'context': [4454.44189453125, 4435.333984375, 4428.16845703125, 4486.1884765625, 4457.82568359375, 4495.9912109375, 4500.8681640625, 4491.5625, 4483.9990234375, 4325.265625, 4275.50537109375], 'indicators': {'sma_short': 4473.8083984375, 'sma_long': 4470.653564453125, 'rsi': 54.294798661051814, 'atr': 71.93715416122015, 'volatility': 27.41547925522337}, 'action': 'buy', 'qty': 1458786.0}, {'entry_index': Timestamp('2024-11-08 00:00:00+0530', tz='Asia/Kolkata'), 'exit_index': Timestamp('2024-11-19 00:00:00+0530', tz='Asia/Kolkata'), 'entry_price': 4137.14111328125, 'exit_price': 4029.946533203125, 'pnl': -107.194580078125, 'commission_cost': 0, 'regime': 'ranging', 'entry_regime': 'ranging', 'exit_regime': 'ranging', 'EntryRegime': 'ranging', 'ExitRegime': 'ranging', 'volatility': 74.04313080270711, 'exit_volatility': 86.5855992275758, 'entry_volatility': 74.04313080270711, 'EntryVolatility': 74.04313080270711, 'ExitVolatility': 86.5855992275758, 'volume': 1648039.0, 'exit_volume': 1776233.0, 'entry_volume': 1648039.0, 'volume_entry': 1648039.0, 'volume_exit': 1776233.0, 'EntryVolume': 1648039.0, 'ExitVolume': 1776233.0, 'atr_entry': 81.19928138178213, 'atr_exit': 92.4937800499738, 'EntryATR': 81.19928138178213, 'ExitATR': 92.4937800499738, 'entry_sma_short': 4064.923046875, 'exit_sma_short': 4100.767578125, 'entry_sma_long': 4047.998388671875, 'exit_sma_long': 4106.244580078125, 'EntrySMA_Short': 4064.923046875, 'ExitSMA_Short': 4100.767578125, 'EntrySMA_Long': 4047.998388671875, 'ExitSMA_Long': 4106.244580078125, 'entry_rsi': 56.171307635388764, 'exit_rsi': 47.039815845575866, 'EntryRSI': 56.171307635388764, 'ExitRSI': 47.039815845575866, 'rationale': 'Sell: short SMA crossed below long SMA at index 2024-11-19 00:00:00+05:30', 'Rationale': 'Sell: short SMA crossed below long SMA at index 2024-11-19 00:00:00+05:30', 'ticker': 'TCS.NS', 'context': [3954.7255859375, 3961.90869140625, 4129.80810546875, 4141.03173828125, 4137.14111328125, 4188.71826171875, 4187.4208984375, 4140.48291015625, 4136.04345703125, 4009.944091796875, 4029.946533203125], 'indicators': {'sma_short': 4064.923046875, 'sma_long': 4047.998388671875, 'rsi': 56.171307635388764, 'atr': 81.19928138178213, 'volatility': 74.04313080270711}, 'action': 'buy', 'qty': 1648039.0}, {'entry_index': Timestamp('2024-11-26 00:00:00+0530', tz='Asia/Kolkata'), 'exit_index': Timestamp('2024-12-17 00:00:00+0530', tz='Asia/Kolkata'), 'entry_price': 4342.35205078125, 'exit_price': 4318.20947265625, 'pnl': -24.142578125, 'commission_cost': 0, 'regime': 'ranging', 'entry_regime': 'ranging', 'exit_regime': 'ranging', 'EntryRegime': 'ranging', 'ExitRegime': 'ranging', 'volatility': 105.65264530579341, 'exit_volatility': 58.15581541489277, 'entry_volatility': 105.65264530579341, 'EntryVolatility': 105.65264530579341, 'ExitVolatility': 58.15581541489277, 'volume': 2060669.0, 'exit_volume': 3225027.0, 'entry_volume': 2060669.0, 'volume_entry': 2060669.0, 'volume_exit': 3225027.0, 'EntryVolume': 2060669.0, 'ExitVolume': 3225027.0, 'atr_entry': 101.66837201153193, 'atr_exit': 81.38469892513929, 'EntryATR': 101.66837201153193, 'ExitATR': 81.38469892513929, 'entry_sma_short': 4194.96318359375, 'exit_sma_short': 4409.4919921875, 'entry_sma_long': 4163.7425537109375, 'exit_sma_long': 4414.3453125, 'EntrySMA_Short': 4194.96318359375, 'ExitSMA_Short': 4409.4919921875, 'EntrySMA_Long': 4163.7425537109375, 'ExitSMA_Long': 4414.3453125, 'entry_rsi': 75.7403112990855, 'exit_rsi': 49.630874818649524, 'EntryRSI': 75.7403112990855, 'ExitRSI': 49.630874818649524, 'rationale': 'Sell: short SMA crossed below long SMA at index 2024-12-17 00:00:00+05:30', 'Rationale': 'Sell: short SMA crossed below long SMA at index 2024-12-17 00:00:00+05:30', 'ticker': 'TCS.NS', 'context': [4292.5205078125, 4344.0478515625, 4453.43701171875, 4434.93115234375, 4441.5654296875, 4422.01171875, 4416.92431640625, 4444.35888671875, 4463.263671875, 4404.70361328125, 4318.20947265625], 'indicators': {'sma_short': 4194.96318359375, 'sma_long': 4163.7425537109375, 'rsi': 75.7403112990855, 'atr': 101.66837201153193, 'volatility': 105.65264530579341}, 'action': 'buy', 'qty': 2060669.0}, {'entry_index': Timestamp('2025-01-13 00:00:00+0530', tz='Asia/Kolkata'), 'exit_index': Timestamp('2025-01-21 00:00:00+0530', tz='Asia/Kolkata'), 'entry_price': 4280.8984375, 'exit_price': 4035.85009765625, 'pnl': -245.04833984375, 'commission_cost': 0, 'regime': 'ranging', 'entry_regime': 'ranging', 'exit_regime': 'ranging', 'EntryRegime': 'ranging', 'ExitRegime': 'ranging', 'volatility': 83.42780760673094, 'exit_volatility': 98.31322678513557, 'entry_volatility': 83.42780760673094, 'EntryVolatility': 83.42780760673094, 'ExitVolatility': 98.31322678513557, 'volume': 4003771.0, 'exit_volume': 1971591.0, 'entry_volume': 4003771.0, 'volume_entry': 4003771.0, 'volume_exit': 1971591.0, 'EntryVolume': 4003771.0, 'ExitVolume': 1971591.0, 'atr_entry': 97.83472139194328, 'atr_exit': 104.15944718454502, 'EntryATR': 97.83472139194328, 'ExitATR': 104.15944718454502, 'entry_sma_short': 4136.602294921875, 'exit_sma_short': 4134.749365234375, 'entry_sma_long': 4121.1990234375, 'exit_sma_long': 4156.1021484375, 'EntrySMA_Short': 4136.602294921875, 'ExitSMA_Short': 4134.749365234375, 'EntrySMA_Long': 4121.1990234375, 'ExitSMA_Long': 4156.1021484375, 'entry_rsi': 59.01930124083204, 'exit_rsi': 46.242774725169134, 'EntryRSI': 59.01930124083204, 'ExitRSI': 46.242774725169134, 'rationale': 'Sell: short SMA crossed below long SMA at index 2025-01-21 00:00:00+05:30', 'Rationale': 'Sell: short SMA crossed below long SMA at index 2025-01-21 00:00:00+05:30', 'ticker': 'TCS.NS', 'context': [4018.72314453125, 4098.6328125, 4029.248291015625, 4255.5087890625, 4280.8984375, 4222.986328125, 4239.4970703125, 4196.2998046875, 4124.2998046875, 4077.800048828125, 4035.85009765625], 'indicators': {'sma_short': 4136.602294921875, 'sma_long': 4121.1990234375, 'rsi': 59.01930124083204, 'atr': 97.83472139194328, 'volatility': 83.42780760673094}, 'action': 'buy', 'qty': 4003771.0}, {'entry_index': Timestamp('2025-02-06 00:00:00+0530', tz='Asia/Kolkata'), 'exit_index': Timestamp('2025-02-07 00:00:00+0530', tz='Asia/Kolkata'), 'entry_price': 4082.75, 'exit_price': 4029.39990234375, 'pnl': -53.35009765625, 'commission_cost': 0, 'regime': 'ranging', 'entry_regime': 'ranging', 'exit_regime': 'ranging', 'EntryRegime': 'ranging', 'ExitRegime': 'ranging', 'volatility': 29.593025243778882, 'exit_volatility': 26.887761650462465, 'entry_volatility': 29.593025243778882, 'EntryVolatility': 29.593025243778882, 'ExitVolatility': 26.887761650462465, 'volume': 2284536.0, 'exit_volume': 1548940.0, 'entry_volume': 2284536.0, 'volume_entry': 2284536.0, 'volume_exit': 1548940.0, 'EntryVolume': 2284536.0, 'ExitVolume': 1548940.0, 'atr_entry': 76.97858537946429, 'atr_exit': 77.05001395089286, 'EntryATR': 76.97858537946429, 'ExitATR': 77.05001395089286, 'entry_sma_short': 4084.53994140625, 'exit_sma_short': 4075.78994140625, 'entry_sma_long': 4084.0399169921875, 'exit_sma_long': 4080.4649169921877, 'EntrySMA_Short': 4084.53994140625, 'ExitSMA_Short': 4075.78994140625, 'EntrySMA_Long': 4084.0399169921875, 'ExitSMA_Long': 4080.4649169921877, 'entry_rsi': 50.52508304210972, 'exit_rsi': 49.33193145141306, 'EntryRSI': 50.52508304210972, 'ExitRSI': 49.33193145141306, 'rationale': 'Sell: short SMA crossed below long SMA at index 2025-02-07 00:00:00+05:30', 'Rationale': 'Sell: short SMA crossed below long SMA at index 2025-02-07 00:00:00+05:30', 'ticker': 'TCS.NS', 'context': [4065.14990234375, 4040.300048828125, 4099.7998046875, 4100.0498046875, 4112.39990234375, 4073.14990234375, 4068.64990234375, 4107.0498046875, 4091.10009765625, 4082.75, 4029.39990234375], 'indicators': {'sma_short': 4084.53994140625, 'sma_long': 4084.0399169921875, 'rsi': 50.52508304210972, 'atr': 76.97858537946429, 'volatility': 29.593025243778882}, 'action': 'buy', 'qty': 2284536.0}, {'entry_index': Timestamp('2025-03-11 00:00:00+0530', tz='Asia/Kolkata'), 'exit_index': Timestamp('2025-03-17 00:00:00+0530', tz='Asia/Kolkata'), 'entry_price': 3575.300048828125, 'exit_price': 3497.699951171875, 'pnl': -77.60009765625, 'commission_cost': 0, 'regime': 'ranging', 'entry_regime': 'ranging', 'exit_regime': 'ranging', 'EntryRegime': 'ranging', 'ExitRegime': 'ranging', 'volatility': 58.68373789861608, 'exit_volatility': 46.772694032445195, 'entry_volatility': 58.68373789861608, 'EntryVolatility': 58.68373789861608, 'ExitVolatility': 46.772694032445195, 'volume': 1995450.0, 'exit_volume': 2690906.0, 'entry_volume': 1995450.0, 'volume_entry': 1995450.0, 'volume_exit': 2690906.0, 'EntryVolume': 1995450.0, 'ExitVolume': 2690906.0, 'atr_entry': 69.81787109375, 'atr_exit': 69.54999651227679, 'EntryATR': 69.81787109375, 'ExitATR': 69.54999651227679, 'entry_sma_short': 3584.960009765625, 'exit_sma_short': 3535.97998046875, 'entry_sma_long': 3567.5250244140625, 'exit_sma_long': 3546.485009765625, 'EntrySMA_Short': 3584.960009765625, 'ExitSMA_Short': 3535.97998046875, 'EntrySMA_Long': 3567.5250244140625, 'ExitSMA_Long': 3546.485009765625, 'entry_rsi': 23.730167341820987, 'exit_rsi': 23.97544930634372, 'EntryRSI': 23.730167341820987, 'ExitRSI': 23.97544930634372, 'rationale': 'Sell: short SMA crossed below long SMA at index 2025-03-17 00:00:00+05:30', 'Rationale': 'Sell: short SMA crossed below long SMA at index 2025-03-17 00:00:00+05:30', 'ticker': 'TCS.NS', 'context': [3483.25, 3493.050048828125, 3532.050048828125, 3547.050048828125, 3601.60009765625, 3611.199951171875, 3589.64990234375, 3575.300048828125, 3506.199951171875, 3511.050048828125, 3497.699951171875], 'indicators': {'sma_short': 3584.960009765625, 'sma_long': 3567.5250244140625, 'rsi': 23.730167341820987, 'atr': 69.81787109375, 'volatility': 58.68373789861608}, 'action': 'buy', 'qty': 1995450.0}, {'entry_index': Timestamp('2025-03-24 00:00:00+0530', tz='Asia/Kolkata'), 'exit_index': Timestamp('2025-04-03 00:00:00+0530', tz='Asia/Kolkata'), 'entry_price': 3628.949951171875, 'exit_price': 3403.14990234375, 'pnl': -225.800048828125, 'commission_cost': 0, 'regime': 'ranging', 'entry_regime': 'ranging', 'exit_regime': 'ranging', 'EntryRegime': 'ranging', 'ExitRegime': 'ranging', 'volatility': 49.85420920208332, 'exit_volatility': 75.84522591169444, 'entry_volatility': 49.85420920208332, 'EntryVolatility': 49.85420920208332, 'ExitVolatility': 75.84522591169444, 'volume': 1834751.0, 'exit_volume': 4537821.0, 'entry_volume': 1834751.0, 'volume_entry': 1834751.0, 'volume_exit': 4537821.0, 'EntryVolume': 1834751.0, 'ExitVolume': 4537821.0, 'atr_entry': 68.84995814732143, 'atr_exit': 72.43211146763393, 'EntryATR': 68.84995814732143, 'ExitATR': 72.43211146763393, 'entry_sma_short': 3553.0, 'exit_sma_short': 3551.049951171875, 'entry_sma_long': 3544.489990234375, 'exit_sma_long': 3581.8999755859377, 'EntrySMA_Short': 3553.0, 'ExitSMA_Short': 3551.049951171875, 'EntrySMA_Long': 3544.489990234375, 'ExitSMA_Long': 3581.8999755859377, 'entry_rsi': 68.17816658001782, 'exit_rsi': 38.91577053872717, 'EntryRSI': 68.17816658001782, 'ExitRSI': 38.91577053872717, 'rationale': 'Sell: short SMA crossed below long SMA at index 2025-04-03 00:00:00+05:30', 'Rationale': 'Sell: short SMA crossed below long SMA at index 2025-04-03 00:00:00+05:30', 'ticker': 'TCS.NS', 'context': [3497.10009765625, 3563.14990234375, 3578.10009765625, 3628.949951171875, 3657.75, 3635.800048828125, 3651.199951171875, 3606.14990234375, 3550.800048828125, 3543.949951171875, 3403.14990234375], 'indicators': {'sma_short': 3553.0, 'sma_long': 3544.489990234375, 'rsi': 68.17816658001782, 'atr': 68.84995814732143, 'volatility': 49.85420920208332}, 'action': 'buy', 'qty': 1834751.0}]
[DEBUG] Stats for report: {'strategy': {'total_return': 0.0, 'win_rate': 0.08333333333333333, 'sharpe_ratio': 0.0, 'max_drawdown': 0.0, 'average_win': 40.50439453125, 'average_loss': -103.7931241122159, 'largest_win': 40.50439453125, 'largest_loss': -245.04833984375, 'profit_factor': 0.03547650883576895, 'expectancy': -91.76833089192708}, '_trades':                  entry_index                exit_index  ...         qty         PnL
0  2024-05-07 00:00:00+05:30 2024-05-15 00:00:00+05:30  ...  2062112.00  -97.143311
1  2024-06-10 00:00:00+05:30 2024-06-19 00:00:00+05:30  ...  1734661.00  -56.594238
2  2024-06-27 00:00:00+05:30 2024-07-11 00:00:00+05:30  ...  4526556.00  -10.375488
3  2024-07-12 00:00:00+05:30 2024-08-05 00:00:00+05:30  ...  7525190.67  -19.112793
4  2024-08-16 00:00:00+05:30 2024-09-06 00:00:00+05:30  ...  3457058.00   40.504395
5  2024-09-13 00:00:00+05:30 2024-09-19 00:00:00+05:30  ...  1458786.00 -225.362793
6  2024-11-08 00:00:00+05:30 2024-11-19 00:00:00+05:30  ...  1648039.00 -107.194580
7  2024-11-26 00:00:00+05:30 2024-12-17 00:00:00+05:30  ...  2060669.00  -24.142578
8  2025-01-13 00:00:00+05:30 2025-01-21 00:00:00+05:30  ...  4003771.00 -245.048340
9  2025-02-06 00:00:00+05:30 2025-02-07 00:00:00+05:30  ...  2284536.00  -53.350098
10 2025-03-11 00:00:00+05:30 2025-03-17 00:00:00+05:30  ...  1995450.00  -77.600098
11 2025-03-24 00:00:00+05:30 2025-04-03 00:00:00+05:30  ...  1834751.00 -225.800049

[12 rows x 47 columns], 'trades': [{'entry_index': Timestamp('2024-05-07 00:00:00+0530', tz='Asia/Kolkata'), 'exit_index': Timestamp('2024-05-15 00:00:00+0530', tz='Asia/Kolkata'), 'entry_price': 3922.1474609375, 'exit_price': 3825.004150390625, 'pnl': -97.143310546875, 'commission_cost': 0, 'regime': 'ranging', 'entry_regime': 'ranging', 'exit_regime': 'ranging', 'EntryRegime': 'ranging', 'ExitRegime': 'ranging', 'volatility': 56.90241322592916, 'exit_volatility': 53.15168265247338, 'entry_volatility': 56.90241322592916, 'EntryVolatility': 56.90241322592916, 'ExitVolatility': 53.15168265247338, 'volume': 2062112.0, 'exit_volume': 1115021.0, 'entry_volume': 2062112.0, 'volume_entry': 2062112.0, 'volume_exit': 1115021.0, 'EntryVolume': 2062112.0, 'ExitVolume': 1115021.0, 'atr_entry': 80.57475746387483, 'atr_exit': 72.52878284862204, 'EntryATR': 80.57475746387483, 'ExitATR': 72.52878284862204, 'entry_sma_short': 3830.0021484375, 'exit_sma_short': 3860.786181640625, 'entry_sma_long': 3827.4934895833335, 'exit_sma_long': 3860.801025390625, 'EntrySMA_Short': 3830.0021484375, 'ExitSMA_Short': 3860.786181640625, 'EntrySMA_Long': 3827.4934895833335, 'ExitSMA_Long': 3860.801025390625, 'entry_rsi': nan, 'exit_rsi': nan, 'EntryRSI': nan, 'ExitRSI': nan, 'rationale': 'Sell: short SMA crossed below long SMA at index 2024-05-15 00:00:00+05:30', 'Rationale': 'Sell: short SMA crossed below long SMA at index 2024-05-15 00:00:00+05:30', 'ticker': 'TCS.NS', 'context': [3766.107421875, 3808.14892578125, 3788.53271484375, 3865.07421875, 3922.1474609375, 3920.176025390625, 3903.665283203125, 3838.311767578125, 3891.4423828125, 3845.50732421875, 3825.004150390625], 'indicators': {'sma_short': 3830.0021484375, 'sma_long': 3827.4934895833335, 'rsi': nan, 'atr': 80.57475746387483, 'volatility': 56.90241322592916}, 'action': 'buy', 'qty': 2062112.0}, {'entry_index': Timestamp('2024-06-10 00:00:00+0530', tz='Asia/Kolkata'), 'exit_index': Timestamp('2024-06-19 00:00:00+0530', tz='Asia/Kolkata'), 'entry_price': 3831.25927734375, 'exit_price': 3774.6650390625, 'pnl': -56.59423828125, 'commission_cost': 0, 'regime': 'ranging', 'entry_regime': 'ranging', 'exit_regime': 'ranging', 'EntryRegime': 'ranging', 'ExitRegime': 'ranging', 'volatility': 73.70093435753122, 'exit_volatility': 52.95708470234185, 'entry_volatility': 73.70093435753122, 'EntryVolatility': 73.70093435753122, 'ExitVolatility': 52.95708470234185, 'volume': 1734661.0, 'exit_volume': 1509050.0, 'entry_volume': 1734661.0, 'volume_entry': 1734661.0, 'volume_exit': 1509050.0, 'EntryVolume': 1734661.0, 'ExitVolume': 1509050.0, 'atr_entry': 74.99142294418286, 'atr_exit': 75.27159552378791, 'EntryATR': 74.99142294418286, 'ExitATR': 75.27159552378791, 'entry_sma_short': 3781.813671875, 'exit_sma_short': 3804.481396484375, 'entry_sma_long': 3752.9156494140625, 'exit_sma_long': 3806.7600341796874, 'EntrySMA_Short': 3781.813671875, 'ExitSMA_Short': 3804.481396484375, 'EntrySMA_Long': 3752.9156494140625, 'ExitSMA_Long': 3806.7600341796874, 'entry_rsi': 53.47471514144394, 'exit_rsi': 49.81979324291707, 'EntryRSI': 53.47471514144394, 'ExitRSI': 49.81979324291707, 'rationale': 'Sell: short SMA crossed below long SMA at index 2024-06-19 00:00:00+05:30', 'Rationale': 'Sell: short SMA crossed below long SMA at index 2024-06-19 00:00:00+05:30', 'ticker': 'TCS.NS', 'context': [3688.58154296875, 3719.807861328125, 3803.160888671875, 3866.2587890625, 3831.25927734375, 3824.70654296875, 3804.40185546875, 3850.5712890625, 3804.799072265625, 3787.9697265625, 3774.6650390625], 'indicators': {'sma_short': 3781.813671875, 'sma_long': 3752.9156494140625, 'rsi': 53.47471514144394, 'atr': 74.99142294418286, 'volatility': 73.70093435753122}, 'action': 'buy', 'qty': 1734661.0}, {'entry_index': Timestamp('2024-06-27 00:00:00+0530', tz='Asia/Kolkata'), 'exit_index': Timestamp('2024-07-11 00:00:00+0530', tz='Asia/Kolkata'), 'entry_price': 3906.1728515625, 'exit_price': 3895.79736328125, 'pnl': -10.37548828125, 'commission_cost': 0, 'regime': 'ranging', 'entry_regime': 'ranging', 'exit_regime': 'ranging', 'EntryRegime': 'ranging', 'ExitRegime': 'ranging', 'volatility': 40.741686812511006, 'exit_volatility': 43.121540784374076, 'entry_volatility': 40.741686812511006, 'EntryVolatility': 40.741686812511006, 'ExitVolatility': 43.121540784374076, 'volume': 4526556.0, 'exit_volume': 4872189.0, 'entry_volume': 4526556.0, 'volume_entry': 4526556.0, 'volume_exit': 4872189.0, 'EntryVolume': 4526556.0, 'ExitVolume': 4872189.0, 'atr_entry': 60.573288337544646, 'atr_exit': 68.12633870847655, 'EntryATR': 60.573288337544646, 'ExitATR': 68.12633870847655, 'entry_sma_short': 3823.812841796875, 'exit_sma_short': 3936.4759765625, 'entry_sma_long': 3809.7386962890623, 'exit_sma_long': 3942.6914306640624, 'EntrySMA_Short': 3823.812841796875, 'ExitSMA_Short': 3936.4759765625, 'EntrySMA_Long': 3809.7386962890623, 'ExitSMA_Long': 3942.6914306640624, 'entry_rsi': 62.647786876351525, 'exit_rsi': 61.27584449657174, 'EntryRSI': 62.647786876351525, 'ExitRSI': 61.27584449657174, 'rationale': 'Sell: short SMA crossed below long SMA at index 2024-07-11 00:00:00+05:30', 'Rationale': 'Sell: short SMA crossed below long SMA at index 2024-07-11 00:00:00+05:30', 'ticker': 'TCS.NS', 'context': [3906.1728515625, 3876.38623046875, 3949.90966796875, 3988.8310546875, 3937.0517578125, 3992.355712890625, 3983.270751953125, 3964.80322265625, 3957.15771484375, 3881.350830078125, 3895.79736328125], 'indicators': {'sma_short': 3823.812841796875, 'sma_long': 3809.7386962890623, 'rsi': 62.647786876351525, 'atr': 60.573288337544646, 'volatility': 40.741686812511006}, 'action': 'buy', 'qty': 4526556.0}, {'entry_index': Timestamp('2024-07-12 00:00:00+0530', tz='Asia/Kolkata'), 'exit_index': Timestamp('2024-08-05 00:00:00+0530', tz='Asia/Kolkata'), 'entry_price': 4154.19677734375, 'exit_price': 4135.083984375, 'pnl': -19.11279296875, 'commission_cost': 0, 'regime': 'ranging', 'entry_regime': 'ranging', 'exit_regime': 'ranging', 'EntryRegime': 'ranging', 'ExitRegime': 'ranging', 'volatility': 76.19057751949774, 'exit_volatility': 70.71970117528711, 'entry_volatility': 76.19057751949774, 'EntryVolatility': 76.19057751949774, 'ExitVolatility': 70.71970117528711, 'volume': 7525190.670000001, 'exit_volume': 2787771.0, 'entry_volume': 7525190.670000001, 'volume_entry': 7525190.670000001, 'volume_exit': 2787771.0, 'EntryVolume': 7525190.670000001, 'ExitVolume': 2787771.0, 'atr_entry': 83.0586884719575, 'atr_exit': 87.59512199688733, 'EntryATR': 83.0586884719575, 'ExitATR': 87.59512199688733, 'entry_sma_short': 3970.661181640625, 'exit_sma_short': 4296.43486328125, 'entry_sma_long': 3970.4724853515627, 'exit_sma_long': 4307.794970703125, 'EntrySMA_Short': 3970.661181640625, 'ExitSMA_Short': 4296.43486328125, 'EntrySMA_Long': 3970.4724853515627, 'ExitSMA_Long': 4307.794970703125, 'entry_rsi': 74.31296453276182, 'exit_rsi': 49.59988735626555, 'EntryRSI': 74.31296453276182, 'ExitRSI': 49.59988735626555, 'rationale': 'Sell: short SMA crossed below long SMA at index 2024-08-05 00:00:00+05:30', 'Rationale': 'Sell: short SMA crossed below long SMA at index 2024-08-05 00:00:00+05:30', 'ticker': 'TCS.NS', 'context': [4266.748046875, 4281.67626953125, 4285.55712890625, 4301.72900390625, 4366.76513671875, 4360.0478515625, 4344.37353515625, 4364.27734375, 4375.970703125, 4262.46875, 4135.083984375], 'indicators': {'sma_short': 3970.661181640625, 'sma_long': 3970.4724853515627, 'rsi': 74.31296453276182, 'atr': 83.0586884719575, 'volatility': 76.19057751949774}, 'action': 'buy', 'qty': 7525190.670000001}, {'entry_index': Timestamp('2024-08-16 00:00:00+0530', tz='Asia/Kolkata'), 'exit_index': Timestamp('2024-09-06 00:00:00+0530', tz='Asia/Kolkata'), 'entry_price': 4394.82958984375, 'exit_price': 4435.333984375, 'pnl': 40.50439453125, 'commission_cost': 0, 'regime': 'ranging', 'entry_regime': 'ranging', 'exit_regime': 'ranging', 'EntryRegime': 'ranging', 'ExitRegime': 'ranging', 'volatility': 90.18373170491661, 'exit_volatility': 22.83686693167127, 'entry_volatility': 90.18373170491661, 'EntryVolatility': 90.18373170491661, 'ExitVolatility': 22.83686693167127, 'volume': 3457058.0, 'exit_volume': 1649179.0, 'entry_volume': 3457058.0, 'volume_entry': 3457058.0, 'volume_exit': 1649179.0, 'EntryVolume': 3457058.0, 'ExitVolume': 1649179.0, 'atr_entry': 88.00362633133464, 'atr_exit': 68.90238267528086, 'EntryATR': 88.00362633133464, 'ExitATR': 68.90238267528086, 'entry_sma_short': 4246.02822265625, 'exit_sma_short': 4467.49873046875, 'entry_sma_long': 4211.1615234375, 'exit_sma_long': 4476.960168457032, 'EntrySMA_Short': 4246.02822265625, 'ExitSMA_Short': 4467.49873046875, 'EntrySMA_Long': 4211.1615234375, 'ExitSMA_Long': 4476.960168457032, 'entry_rsi': 52.07566521249242, 'exit_rsi': 42.706203209016586, 'EntryRSI': 52.07566521249242, 'ExitRSI': 42.706203209016586, 'rationale': 'Buy: short SMA crossed above long SMA at index 2024-08-16 00:00:00+05:30', 'Rationale': 'Buy: short SMA crossed above long SMA at index 2024-08-16 00:00:00+05:30', 'ticker': 'TCS.NS', 'context': [4442.44970703125, 4480.814453125, 4475.5400390625, 4484.39697265625, 4490.11962890625, 4501.2369384765625, 4499.32470703125, 4490.6669921875, 4457.72607421875, 4454.44189453125, 4435.333984375], 'indicators': {'sma_short': 4246.02822265625, 'sma_long': 4211.1615234375, 'rsi': 52.07566521249242, 'atr': 88.00362633133464, 'volatility': 90.18373170491661}, 'action': 'buy', 'qty': 3457058.0}, {'entry_index': Timestamp('2024-09-13 00:00:00+0530', tz='Asia/Kolkata'), 'exit_index': Timestamp('2024-09-19 00:00:00+0530', tz='Asia/Kolkata'), 'entry_price': 4500.8681640625, 'exit_price': 4275.50537109375, 'pnl': -225.36279296875, 'commission_cost': 0, 'regime': 'ranging', 'entry_regime': 'ranging', 'exit_regime': 'ranging', 'EntryRegime': 'ranging', 'ExitRegime': 'ranging', 'volatility': 27.41547925522337, 'exit_volatility': 73.80808359558365, 'entry_volatility': 27.41547925522337, 'EntryVolatility': 27.41547925522337, 'ExitVolatility': 73.80808359558365, 'volume': 1458786.0, 'exit_volume': 2927551.0, 'entry_volume': 1458786.0, 'volume_entry': 1458786.0, 'volume_exit': 2927551.0, 'EntryVolume': 1458786.0, 'ExitVolume': 2927551.0, 'atr_entry': 71.93715416122015, 'atr_exit': 82.31733460326164, 'EntryATR': 71.93715416122015, 'ExitATR': 82.31733460326164, 'entry_sma_short': 4473.8083984375, 'exit_sma_short': 4415.44013671875, 'entry_sma_long': 4470.653564453125, 'exit_sma_long': 4438.070849609375, 'EntrySMA_Short': 4473.8083984375, 'ExitSMA_Short': 4415.44013671875, 'EntrySMA_Long': 4470.653564453125, 'ExitSMA_Long': 4438.070849609375, 'entry_rsi': 54.294798661051814, 'exit_rsi': 23.620649466291155, 'EntryRSI': 54.294798661051814, 'ExitRSI': 23.620649466291155, 'rationale': 'Sell: short SMA crossed below long SMA at index 2024-09-19 00:00:00+05:30', 'Rationale': 'Sell: short SMA crossed below long SMA at index 2024-09-19 00:00:00+05:30', 'ticker': 'TCS.NS', 'context': [4454.44189453125, 4435.333984375, 4428.16845703125, 4486.1884765625, 4457.82568359375, 4495.9912109375, 4500.8681640625, 4491.5625, 4483.9990234375, 4325.265625, 4275.50537109375], 'indicators': {'sma_short': 4473.8083984375, 'sma_long': 4470.653564453125, 'rsi': 54.294798661051814, 'atr': 71.93715416122015, 'volatility': 27.41547925522337}, 'action': 'buy', 'qty': 1458786.0}, {'entry_index': Timestamp('2024-11-08 00:00:00+0530', tz='Asia/Kolkata'), 'exit_index': Timestamp('2024-11-19 00:00:00+0530', tz='Asia/Kolkata'), 'entry_price': 4137.14111328125, 'exit_price': 4029.946533203125, 'pnl': -107.194580078125, 'commission_cost': 0, 'regime': 'ranging', 'entry_regime': 'ranging', 'exit_regime': 'ranging', 'EntryRegime': 'ranging', 'ExitRegime': 'ranging', 'volatility': 74.04313080270711, 'exit_volatility': 86.5855992275758, 'entry_volatility': 74.04313080270711, 'EntryVolatility': 74.04313080270711, 'ExitVolatility': 86.5855992275758, 'volume': 1648039.0, 'exit_volume': 1776233.0, 'entry_volume': 1648039.0, 'volume_entry': 1648039.0, 'volume_exit': 1776233.0, 'EntryVolume': 1648039.0, 'ExitVolume': 1776233.0, 'atr_entry': 81.19928138178213, 'atr_exit': 92.4937800499738, 'EntryATR': 81.19928138178213, 'ExitATR': 92.4937800499738, 'entry_sma_short': 4064.923046875, 'exit_sma_short': 4100.767578125, 'entry_sma_long': 4047.998388671875, 'exit_sma_long': 4106.244580078125, 'EntrySMA_Short': 4064.923046875, 'ExitSMA_Short': 4100.767578125, 'EntrySMA_Long': 4047.998388671875, 'ExitSMA_Long': 4106.244580078125, 'entry_rsi': 56.171307635388764, 'exit_rsi': 47.039815845575866, 'EntryRSI': 56.171307635388764, 'ExitRSI': 47.039815845575866, 'rationale': 'Sell: short SMA crossed below long SMA at index 2024-11-19 00:00:00+05:30', 'Rationale': 'Sell: short SMA crossed below long SMA at index 2024-11-19 00:00:00+05:30', 'ticker': 'TCS.NS', 'context': [3954.7255859375, 3961.90869140625, 4129.80810546875, 4141.03173828125, 4137.14111328125, 4188.71826171875, 4187.4208984375, 4140.48291015625, 4136.04345703125, 4009.944091796875, 4029.946533203125], 'indicators': {'sma_short': 4064.923046875, 'sma_long': 4047.998388671875, 'rsi': 56.171307635388764, 'atr': 81.19928138178213, 'volatility': 74.04313080270711}, 'action': 'buy', 'qty': 1648039.0}, {'entry_index': Timestamp('2024-11-26 00:00:00+0530', tz='Asia/Kolkata'), 'exit_index': Timestamp('2024-12-17 00:00:00+0530', tz='Asia/Kolkata'), 'entry_price': 4342.35205078125, 'exit_price': 4318.20947265625, 'pnl': -24.142578125, 'commission_cost': 0, 'regime': 'ranging', 'entry_regime': 'ranging', 'exit_regime': 'ranging', 'EntryRegime': 'ranging', 'ExitRegime': 'ranging', 'volatility': 105.65264530579341, 'exit_volatility': 58.15581541489277, 'entry_volatility': 105.65264530579341, 'EntryVolatility': 105.65264530579341, 'ExitVolatility': 58.15581541489277, 'volume': 2060669.0, 'exit_volume': 3225027.0, 'entry_volume': 2060669.0, 'volume_entry': 2060669.0, 'volume_exit': 3225027.0, 'EntryVolume': 2060669.0, 'ExitVolume': 3225027.0, 'atr_entry': 101.66837201153193, 'atr_exit': 81.38469892513929, 'EntryATR': 101.66837201153193, 'ExitATR': 81.38469892513929, 'entry_sma_short': 4194.96318359375, 'exit_sma_short': 4409.4919921875, 'entry_sma_long': 4163.7425537109375, 'exit_sma_long': 4414.3453125, 'EntrySMA_Short': 4194.96318359375, 'ExitSMA_Short': 4409.4919921875, 'EntrySMA_Long': 4163.7425537109375, 'ExitSMA_Long': 4414.3453125, 'entry_rsi': 75.7403112990855, 'exit_rsi': 49.630874818649524, 'EntryRSI': 75.7403112990855, 'ExitRSI': 49.630874818649524, 'rationale': 'Sell: short SMA crossed below long SMA at index 2024-12-17 00:00:00+05:30', 'Rationale': 'Sell: short SMA crossed below long SMA at index 2024-12-17 00:00:00+05:30', 'ticker': 'TCS.NS', 'context': [4292.5205078125, 4344.0478515625, 4453.43701171875, 4434.93115234375, 4441.5654296875, 4422.01171875, 4416.92431640625, 4444.35888671875, 4463.263671875, 4404.70361328125, 4318.20947265625], 'indicators': {'sma_short': 4194.96318359375, 'sma_long': 4163.7425537109375, 'rsi': 75.7403112990855, 'atr': 101.66837201153193, 'volatility': 105.65264530579341}, 'action': 'buy', 'qty': 2060669.0}, {'entry_index': Timestamp('2025-01-13 00:00:00+0530', tz='Asia/Kolkata'), 'exit_index': Timestamp('2025-01-21 00:00:00+0530', tz='Asia/Kolkata'), 'entry_price': 4280.8984375, 'exit_price': 4035.85009765625, 'pnl': -245.04833984375, 'commission_cost': 0, 'regime': 'ranging', 'entry_regime': 'ranging', 'exit_regime': 'ranging', 'EntryRegime': 'ranging', 'ExitRegime': 'ranging', 'volatility': 83.42780760673094, 'exit_volatility': 98.31322678513557, 'entry_volatility': 83.42780760673094, 'EntryVolatility': 83.42780760673094, 'ExitVolatility': 98.31322678513557, 'volume': 4003771.0, 'exit_volume': 1971591.0, 'entry_volume': 4003771.0, 'volume_entry': 4003771.0, 'volume_exit': 1971591.0, 'EntryVolume': 4003771.0, 'ExitVolume': 1971591.0, 'atr_entry': 97.83472139194328, 'atr_exit': 104.15944718454502, 'EntryATR': 97.83472139194328, 'ExitATR': 104.15944718454502, 'entry_sma_short': 4136.602294921875, 'exit_sma_short': 4134.749365234375, 'entry_sma_long': 4121.1990234375, 'exit_sma_long': 4156.1021484375, 'EntrySMA_Short': 4136.602294921875, 'ExitSMA_Short': 4134.749365234375, 'EntrySMA_Long': 4121.1990234375, 'ExitSMA_Long': 4156.1021484375, 'entry_rsi': 59.01930124083204, 'exit_rsi': 46.242774725169134, 'EntryRSI': 59.01930124083204, 'ExitRSI': 46.242774725169134, 'rationale': 'Sell: short SMA crossed below long SMA at index 2025-01-21 00:00:00+05:30', 'Rationale': 'Sell: short SMA crossed below long SMA at index 2025-01-21 00:00:00+05:30', 'ticker': 'TCS.NS', 'context': [4018.72314453125, 4098.6328125, 4029.248291015625, 4255.5087890625, 4280.8984375, 4222.986328125, 4239.4970703125, 4196.2998046875, 4124.2998046875, 4077.800048828125, 4035.85009765625], 'indicators': {'sma_short': 4136.602294921875, 'sma_long': 4121.1990234375, 'rsi': 59.01930124083204, 'atr': 97.83472139194328, 'volatility': 83.42780760673094}, 'action': 'buy', 'qty': 4003771.0}, {'entry_index': Timestamp('2025-02-06 00:00:00+0530', tz='Asia/Kolkata'), 'exit_index': Timestamp('2025-02-07 00:00:00+0530', tz='Asia/Kolkata'), 'entry_price': 4082.75, 'exit_price': 4029.39990234375, 'pnl': -53.35009765625, 'commission_cost': 0, 'regime': 'ranging', 'entry_regime': 'ranging', 'exit_regime': 'ranging', 'EntryRegime': 'ranging', 'ExitRegime': 'ranging', 'volatility': 29.593025243778882, 'exit_volatility': 26.887761650462465, 'entry_volatility': 29.593025243778882, 'EntryVolatility': 29.593025243778882, 'ExitVolatility': 26.887761650462465, 'volume': 2284536.0, 'exit_volume': 1548940.0, 'entry_volume': 2284536.0, 'volume_entry': 2284536.0, 'volume_exit': 1548940.0, 'EntryVolume': 2284536.0, 'ExitVolume': 1548940.0, 'atr_entry': 76.97858537946429, 'atr_exit': 77.05001395089286, 'EntryATR': 76.97858537946429, 'ExitATR': 77.05001395089286, 'entry_sma_short': 4084.53994140625, 'exit_sma_short': 4075.78994140625, 'entry_sma_long': 4084.0399169921875, 'exit_sma_long': 4080.4649169921877, 'EntrySMA_Short': 4084.53994140625, 'ExitSMA_Short': 4075.78994140625, 'EntrySMA_Long': 4084.0399169921875, 'ExitSMA_Long': 4080.4649169921877, 'entry_rsi': 50.52508304210972, 'exit_rsi': 49.33193145141306, 'EntryRSI': 50.52508304210972, 'ExitRSI': 49.33193145141306, 'rationale': 'Sell: short SMA crossed below long SMA at index 2025-02-07 00:00:00+05:30', 'Rationale': 'Sell: short SMA crossed below long SMA at index 2025-02-07 00:00:00+05:30', 'ticker': 'TCS.NS', 'context': [4065.14990234375, 4040.300048828125, 4099.7998046875, 4100.0498046875, 4112.39990234375, 4073.14990234375, 4068.64990234375, 4107.0498046875, 4091.10009765625, 4082.75, 4029.39990234375], 'indicators': {'sma_short': 4084.53994140625, 'sma_long': 4084.0399169921875, 'rsi': 50.52508304210972, 'atr': 76.97858537946429, 'volatility': 29.593025243778882}, 'action': 'buy', 'qty': 2284536.0}, {'entry_index': Timestamp('2025-03-11 00:00:00+0530', tz='Asia/Kolkata'), 'exit_index': Timestamp('2025-03-17 00:00:00+0530', tz='Asia/Kolkata'), 'entry_price': 3575.300048828125, 'exit_price': 3497.699951171875, 'pnl': -77.60009765625, 'commission_cost': 0, 'regime': 'ranging', 'entry_regime': 'ranging', 'exit_regime': 'ranging', 'EntryRegime': 'ranging', 'ExitRegime': 'ranging', 'volatility': 58.68373789861608, 'exit_volatility': 46.772694032445195, 'entry_volatility': 58.68373789861608, 'EntryVolatility': 58.68373789861608, 'ExitVolatility': 46.772694032445195, 'volume': 1995450.0, 'exit_volume': 2690906.0, 'entry_volume': 1995450.0, 'volume_entry': 1995450.0, 'volume_exit': 2690906.0, 'EntryVolume': 1995450.0, 'ExitVolume': 2690906.0, 'atr_entry': 69.81787109375, 'atr_exit': 69.54999651227679, 'EntryATR': 69.81787109375, 'ExitATR': 69.54999651227679, 'entry_sma_short': 3584.960009765625, 'exit_sma_short': 3535.97998046875, 'entry_sma_long': 3567.5250244140625, 'exit_sma_long': 3546.485009765625, 'EntrySMA_Short': 3584.960009765625, 'ExitSMA_Short': 3535.97998046875, 'EntrySMA_Long': 3567.5250244140625, 'ExitSMA_Long': 3546.485009765625, 'entry_rsi': 23.730167341820987, 'exit_rsi': 23.97544930634372, 'EntryRSI': 23.730167341820987, 'ExitRSI': 23.97544930634372, 'rationale': 'Sell: short SMA crossed below long SMA at index 2025-03-17 00:00:00+05:30', 'Rationale': 'Sell: short SMA crossed below long SMA at index 2025-03-17 00:00:00+05:30', 'ticker': 'TCS.NS', 'context': [3483.25, 3493.050048828125, 3532.050048828125, 3547.050048828125, 3601.60009765625, 3611.199951171875, 3589.64990234375, 3575.300048828125, 3506.199951171875, 3511.050048828125, 3497.699951171875], 'indicators': {'sma_short': 3584.960009765625, 'sma_long': 3567.5250244140625, 'rsi': 23.730167341820987, 'atr': 69.81787109375, 'volatility': 58.68373789861608}, 'action': 'buy', 'qty': 1995450.0}, {'entry_index': Timestamp('2025-03-24 00:00:00+0530', tz='Asia/Kolkata'), 'exit_index': Timestamp('2025-04-03 00:00:00+0530', tz='Asia/Kolkata'), 'entry_price': 3628.949951171875, 'exit_price': 3403.14990234375, 'pnl': -225.800048828125, 'commission_cost': 0, 'regime': 'ranging', 'entry_regime': 'ranging', 'exit_regime': 'ranging', 'EntryRegime': 'ranging', 'ExitRegime': 'ranging', 'volatility': 49.85420920208332, 'exit_volatility': 75.84522591169444, 'entry_volatility': 49.85420920208332, 'EntryVolatility': 49.85420920208332, 'ExitVolatility': 75.84522591169444, 'volume': 1834751.0, 'exit_volume': 4537821.0, 'entry_volume': 1834751.0, 'volume_entry': 1834751.0, 'volume_exit': 4537821.0, 'EntryVolume': 1834751.0, 'ExitVolume': 4537821.0, 'atr_entry': 68.84995814732143, 'atr_exit': 72.43211146763393, 'EntryATR': 68.84995814732143, 'ExitATR': 72.43211146763393, 'entry_sma_short': 3553.0, 'exit_sma_short': 3551.049951171875, 'entry_sma_long': 3544.489990234375, 'exit_sma_long': 3581.8999755859377, 'EntrySMA_Short': 3553.0, 'ExitSMA_Short': 3551.049951171875, 'EntrySMA_Long': 3544.489990234375, 'ExitSMA_Long': 3581.8999755859377, 'entry_rsi': 68.17816658001782, 'exit_rsi': 38.91577053872717, 'EntryRSI': 68.17816658001782, 'ExitRSI': 38.91577053872717, 'rationale': 'Sell: short SMA crossed below long SMA at index 2025-04-03 00:00:00+05:30', 'Rationale': 'Sell: short SMA crossed below long SMA at index 2025-04-03 00:00:00+05:30', 'ticker': 'TCS.NS', 'context': [3497.10009765625, 3563.14990234375, 3578.10009765625, 3628.949951171875, 3657.75, 3635.800048828125, 3651.199951171875, 3606.14990234375, 3550.800048828125, 3543.949951171875, 3403.14990234375], 'indicators': {'sma_short': 3553.0, 'sma_long': 3544.489990234375, 'rsi': 68.17816658001782, 'atr': 68.84995814732143, 'volatility': 49.85420920208332}, 'action': 'buy', 'qty': 1834751.0}], 'equity_curve': [5555, 5555, 5555, 5555, 5555, 5555, 5555, 5555, 5555, 5555, 5555, 5555, 5555, 5555, 5555, 5555, 5555, 5555, 5555, 5555, 5555, 5555, 5555, 5555, 5555, 5555, 5555, 5555, 5555, 5555, 5555, 5555, 5555, 5555, 5555, 5555, 5555, 5555, 5555, 5555, 5555, 5555, 5555, 5555, 5555, 5555, 5555, 5555, 5555, 5555, 5555, 5555, 5555, 5555, 5555, 5555, 5555, 5555, 5555, 5555, 5555, 5555, 5555, 5555, 5555, 5555, 5555, 5555, 5555, 5555, 5555, 5555, 5555, 5555, 5555, 5555, 5555, 5555, 5555, 5555, 5555, 5555, 5555, 5555, 5555, 5555, 5555, 5555, 5555, 5555, 5555, 5555, 5555, 5555, 5555, 5555, 5555, 5555, 5555, 5555, 5555, 5555, 5555, 5555, 5555, 5555, 5555, 5555, 5555, 5555, 5555, 5555, 5555, 5555, 5555, 5555, 5555, 5555, 5555, 5555, 5555, 5555, 5555, 5555, 5555, 5555, 5555, 5555, 5555, 5555, 5555, 5555, 5555, 5555, 5555, 5555, 5555, 5555, 5555, 5555, 5555, 5555, 5555, 5555, 5555, 5555, 5555, 5555, 5555, 5555, 5555, 5555, 5555, 5555, 5555, 5555, 5555, 5555, 5555, 5555, 5555, 5555, 5555, 5555, 5555, 5555, 5555, 5555, 5555, 5555, 5555, 5555, 5555, 5555, 5555, 5555, 5555, 5555, 5555, 5555, 5555, 5555, 5555, 5555, 5555, 5555, 5555, 5555, 5555, 5555, 5555, 5555, 5555, 5555, 5555, 5555, 5555, 5555, 5555, 5555, 5555, 5555, 5555, 5555, 5555, 5555, 5555, 5555, 5555, 5555, 5555, 5555, 5555, 5555, 5555, 5555, 5555, 5555, 5555, 5555, 5555, 5555, 5555, 5555, 5555, 5555, 5555, 5555, 5555, 5555, 5555, 5555, 5555, 5555, 5555, 5555, 5555, 5555, 5555, 5555, 5555, 5555, 5555, 5555, 5555, 5555, 5555], 'regime_series': Date
2024-04-29 00:00:00+05:30        calm
2024-04-30 00:00:00+05:30    trending
2024-05-02 00:00:00+05:30     ranging
2024-05-03 00:00:00+05:30     ranging
2024-05-06 00:00:00+05:30     ranging
                               ...   
2025-04-23 00:00:00+05:30     ranging
2025-04-24 00:00:00+05:30     ranging
2025-04-25 00:00:00+05:30    trending
2025-04-28 00:00:00+05:30    trending
2025-04-29 00:00:00+05:30    trending
Name: regime, Length: 248, dtype: object, 'regime_summary': 'Ranging: 100%', 'drawdown_curve': array([0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0,
       0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0,
       0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0,
       0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0,
       0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0,
       0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0,
       0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0,
       0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0,
       0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0,
       0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0,
       0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0,
       0, 0, 0, 0, 0]), 'returns_distribution': array([0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0.,
       0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0.,
       0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0.,
       0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0.,
       0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0.,
       0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0.,
       0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0.,
       0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0.,
       0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0.,
       0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0.,
       0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0.,
       0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0.,
       0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0.,
       0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0.,
       0., 0., 0., 0., 0., 0., 0., 0.]), 'strategy_params': {'position_size': 123, 'initial_cash': 5555}}
DEBUG: Trade log keys (first entry): ['entry_index', 'exit_index', 'entry_price', 'exit_price', 'pnl', 'commission_cost', 'regime', 'entry_regime', 'exit_regime', 'EntryRegime', 'ExitRegime', 'volatility', 'exit_volatility', 'entry_volatility', 'EntryVolatility', 'ExitVolatility', 'volume', 'exit_volume', 'entry_volume', 'volume_entry', 'volume_exit', 'EntryVolume', 'ExitVolume', 'atr_entry', 'atr_exit', 'EntryATR', 'ExitATR', 'entry_sma_short', 'exit_sma_short', 'entry_sma_long', 'exit_sma_long', 'EntrySMA_Short', 'ExitSMA_Short', 'EntrySMA_Long', 'ExitSMA_Long', 'entry_rsi', 'exit_rsi', 'EntryRSI', 'ExitRSI', 'rationale', 'Rationale', 'ticker', 'context', 'indicators', 'action', 'qty']
[DEBUG] Exception in generate_markdown_report: 'numpy.ndarray' object is not callable
---------------------------- Captured stderr call -----------------------------
Traceback (most recent call last):
  File "D:\Code\projects\tapp\code\2025\simpler_st\pipeline.py", line 144, in run_pipeline
    generate_markdown_report(stats, pf)
  File "D:\Code\projects\tapp\code\2025\simpler_st\report_generator.py", line 686, in generate_markdown_report
    regime_counts = pd.Series(list(regime_series.values())).value_counts()
TypeError: 'numpy.ndarray' object is not callable
____________________ test_regime_table_filters_short_runs _____________________

tmp_path = WindowsPath('C:/Users/user/AppData/Local/Temp/pytest-of-user/pytest-262/test_regime_table_filters_shor0')

    def test_regime_table_filters_short_runs(tmp_path):
        import pandas as pd
        # Create a regime series: 2 days trending, 4 days ranging, 3 days volatile, 5 days calm
        dates = pd.date_range("2025-04-01", periods=14)
        regimes = [
            'trending', 'trending', # 2 days (should be skipped)
            'ranging', 'ranging', 'ranging', 'ranging', # 4 days (should be included)
            'volatile', 'volatile', 'volatile', # 3 days (should be skipped)
            'calm', 'calm', 'calm', 'calm', 'calm' # 5 days (should be included)
        ]
        regime_series = pd.Series(regimes, index=dates)
        stats = {
            'regime_summary': 'Trending: 15%, Ranging: 30%, Volatile: 20%, Calm: 35%',
            'regime_series': regime_series,
            'strategy_params': {'position_size': 1, 'initial_cash': 1}
        }
        bt = dummy_bt()
        os.chdir(tmp_path)
>       generate_markdown_report(stats, bt)

D:\Code\projects\tapp\code\2025\simpler_st\tests\test_report_generation.py:197: 
_ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _

stats = {'regime_series': 2025-04-01    trending
2025-04-02    trending
2025-04-03     ranging
2025-04-04     ranging
2025-04-...': 'Trending: 15%, Ranging: 30%, Volatile: 20%, Calm: 35%', 'strategy_params': {'initial_cash': 1, 'position_size': 1}}
bt = <test_report_generation.dummy_bt.<locals>.DummyBT object at 0x000001BD3D103400>
parameter_sensitivity_results = None

    def generate_markdown_report(stats, bt, parameter_sensitivity_results=None):
        """
        Generates a portfolio report in Markdown format, including all key sections.
        Output file: reports/portfolio_report.md
        """
        os.makedirs("plots", exist_ok=True)
        os.makedirs("reports", exist_ok=True)
        # --- Pre-initialize chart path variables to None to avoid UnboundLocalError ---
        abs_legacy_equity_chart_path = None
        abs_chart_path = None
        abs_drawdown_chart_path = None
        abs_return_dist_chart_path = None
        md_lines = []
        # Cover Page
        md_lines.append("# Technical Analysis Report\n")
        md_lines.append("## Portfolio-Level Report\n")
        md_lines.append("---\n")
        # Table of Contents
        md_lines.append("## Table of Contents\n")
        md_lines.append("1. [Cover Page](#technical-analysis-report)")
        md_lines.append("2. [Table of Contents](#table-of-contents)")
        md_lines.append("3. [Assumptions: Slippage and Commission](#assumptions-slippage-and-commission)")
        md_lines.append("4. [Performance Metrics](#performance-metrics)")
        md_lines.append("5. [Benchmark Comparison](#benchmark-comparison)")
        md_lines.append("6. [Trade Log](#trade-log)")
        md_lines.append("7. [Regime Summary](#regime-summary)")
        md_lines.append("8. [Strategy Parameters](#strategy-parameters)")
        md_lines.append("9. [Risk and Position Sizing Logic](#risk-and-position-sizing-logic)")
        md_lines.append("10. [Analyst Notes and Suggestions](#analyst-notes-and-suggestions)")
        md_lines.append("11. [Rationale Summary](#rationale-summary)")
        md_lines.append("12. [Trade Statistics Breakdown](#trade-statistics-breakdown)")
        md_lines.append("13. [Regime Breakdown](#regime-breakdown)\n")
        # --- Out-of-Sample/Walk-Forward Validation Section ---
        out_of_sample = stats.get('out_of_sample')
        if out_of_sample:
            md_lines.append("## Out-of-Sample Walk-Forward Results\n")
            period = out_of_sample.get('period', '')
            ret = out_of_sample.get('return', None)
            sharpe = out_of_sample.get('sharpe', None)
            max_dd = out_of_sample.get('max_drawdown', None)
            note = out_of_sample.get('note', '')
            line = f"> The strategy was tested on {period} data not used in optimization. "
            if ret is not None:
                line += f"Out-of-sample return: {ret:.1f}%, "
            if sharpe is not None:
                line += f"Sharpe: {sharpe:.2f}, "
            if max_dd is not None:
                line += f"Max Drawdown: {max_dd:.1f}%. "
            if note:
                line += note
            md_lines.append(line + "\n")
        # --- Equity Curve Chart (legacy, always present) ---
        legacy_equity_chart_path = f"plots/portfolio_equity.png"
        equity_curve = stats.get('equity_curve')
        # If dict (multi-ticker), pick first ticker for legacy chart
        if isinstance(equity_curve, dict):
            first_ticker = next(iter(equity_curve)) if equity_curve else None
            equity_curve_legacy = equity_curve.get(first_ticker) if first_ticker else None
        else:
            equity_curve_legacy = equity_curve
        if equity_curve_legacy is not None:
            plt.figure(facecolor='white')
            plt.rcParams.update({
                'font.size': 12,
                'axes.labelsize': 12,
                'axes.titlesize': 14,
                'legend.fontsize': 12,
                'axes.edgecolor': 'gray',
                'axes.linewidth': 1,
                'axes.grid': True,
                'grid.color': '#e0e0e0',
                'axes.prop_cycle': plt.cycler(color=["#1f77b4"])
            })
            plt.plot(equity_curve_legacy, label='Equity Curve', color='#1f77b4')
            plt.legend(loc='best', frameon=True)
            plt.tight_layout()
            abs_legacy_equity_chart_path = os.path.abspath(legacy_equity_chart_path)
            os.makedirs(os.path.dirname(abs_legacy_equity_chart_path), exist_ok=True)
            plt.savefig(abs_legacy_equity_chart_path)
            plt.close()
    
        # --- Benchmark Comparison Plot (new, if both present) ---
        benchmark_curve = stats.get('benchmark_curve') or stats.get('benchmark_equity_curve')
        chart_path = f"plots/benchmark_comparison.png"
        benchmark_name = stats.get('benchmark_name', 'Benchmark')
        # Handle dicts for benchmark too
        if isinstance(benchmark_curve, dict):
            benchmark_curve_legacy = benchmark_curve.get(first_ticker) if first_ticker else None
        else:
            benchmark_curve_legacy = benchmark_curve
        if equity_curve_legacy is not None and benchmark_curve_legacy is not None:
            plt.figure(facecolor='white')
            plt.rcParams.update({
                'font.size': 12,
                'axes.labelsize': 12,
                'axes.titlesize': 14,
                'legend.fontsize': 12,
                'axes.edgecolor': 'gray',
                'axes.linewidth': 1,
                'axes.grid': True,
                'grid.color': '#e0e0e0',
                'axes.prop_cycle': plt.cycler(color=["#1f77b4", "#ff7f0e"])
            })
            plt.plot(equity_curve_legacy, label='Portfolio', color='#1f77b4')
            plt.plot(benchmark_curve_legacy, label=benchmark_name, color='#ff7f0e', linestyle='--')
            plt.legend(loc='best', frameon=True)
            plt.title(f"Portfolio vs {benchmark_name}")
            plt.tight_layout()
            abs_chart_path = os.path.abspath(chart_path)
            os.makedirs(os.path.dirname(abs_chart_path), exist_ok=True)
            plt.savefig(abs_chart_path)
            plt.close()
    
        # --- Drawdown Curve Visualization ---
        drawdown_curve = stats.get('drawdown_curve')
        drawdown_chart_path = f"plots/drawdown_curve.png"
        if drawdown_curve is not None:
            plt.figure(facecolor='white')
            plt.plot(drawdown_curve, label='Drawdown', color='red')
            plt.title('Drawdown Curve')
            plt.xlabel('Time')
            plt.ylabel('Drawdown')
            plt.legend()
            plt.tight_layout()
            abs_drawdown_chart_path = os.path.abspath(drawdown_chart_path)
            os.makedirs(os.path.dirname(abs_drawdown_chart_path), exist_ok=True)
            plt.savefig(abs_drawdown_chart_path)
            plt.close()
    
        # --- Return Distribution Visualization ---
        returns_dist = stats.get('returns_distribution')
        return_dist_chart_path = f"plots/return_distribution.png"
        if returns_dist is not None:
            plt.figure(facecolor='white')
            mean = np.mean(returns_dist)
            std = np.std(returns_dist)
            outliers = (np.abs(returns_dist - mean) > 2 * std)
            plt.hist(returns_dist[~outliers], bins=20, color='#1f77b4', alpha=0.7, label='Normal')
            if np.any(outliers):
                plt.hist(returns_dist[outliers], bins=5, color='red', alpha=0.8, label='Outlier')
            plt.title('Return Distribution')
            plt.xlabel('Return')
            plt.ylabel('Frequency')
            plt.legend()
            plt.tight_layout()
            abs_return_dist_chart_path = os.path.abspath(return_dist_chart_path)
            os.makedirs(os.path.dirname(abs_return_dist_chart_path), exist_ok=True)
            plt.savefig(abs_return_dist_chart_path)
            plt.close()
    
        # --- Drawdown Table Section ---
        equity_curve = stats.get('equity_curve')
        # Defensive: handle dict (multi-ticker) vs. list/array (single-ticker)
        equity_curve_for_drawdown = equity_curve
        if isinstance(equity_curve, dict):
            first_ticker = next(iter(equity_curve)) if equity_curve else None
            equity_curve_for_drawdown = equity_curve.get(first_ticker) if first_ticker else None
        if equity_curve_for_drawdown is not None:
            from tech_analysis.backtest import extract_drawdown_periods
            periods = extract_drawdown_periods(equity_curve_for_drawdown)
            if periods:
                df = pd.DataFrame(periods)
                df2 = df.copy()
                df2['depth'] = (df2['depth'] * 100).round(2)
                df2 = df2.rename(columns={'start': 'Start', 'trough': 'Trough', 'end': 'End', 'depth': 'Depth (%)', 'recovery': 'Recovery (bars)'})
                plots_dir = os.path.join(os.getcwd(), 'plots')
                os.makedirs(plots_dir, exist_ok=True)
                table_path = os.path.join(plots_dir, 'drawdown_table.png')
                fig, ax = plt.subplots(figsize=(min(10, 2+len(df2)*0.5), 1+0.5*len(df2)))
                ax.axis('off')
                tbl = ax.table(cellText=df2.values, colLabels=df2.columns, loc='center', cellLoc='center')
                tbl.auto_set_font_size(False)
                tbl.set_fontsize(10)
                tbl.scale(1, 1.5)
                plt.tight_layout()
                plt.savefig(table_path, bbox_inches='tight', dpi=150)
                plt.close(fig)
                md_lines.append('## Drawdown Table\n')
                md_lines.append('![](plots/drawdown_table.png)\n')
    
        # --- Holding Duration Histogram ---
        holding_duration_chart_path = f"plots/holding_duration.png"
        trade_log = stats.get('trades') or stats.get('_trades')
        holding_durations = []
        if isinstance(trade_log, pd.DataFrame) and not trade_log.empty:
            for idx, trade in trade_log.iterrows():
                entry = trade.get('entry_time')
                exit = trade.get('exit_time')
                if entry and exit:
                    try:
                        entry_dt = pd.to_datetime(entry)
                        exit_dt = pd.to_datetime(exit)
                        duration = (exit_dt - entry_dt).days
                        if duration >= 0:
                            holding_durations.append(duration)
                    except Exception:
                        continue
        elif isinstance(trade_log, list):
            for trade in trade_log:
                entry = trade.get('entry_time')
                exit = trade.get('exit_time')
                if entry and exit:
                    try:
                        entry_dt = pd.to_datetime(entry)
                        exit_dt = pd.to_datetime(exit)
                        duration = (exit_dt - entry_dt).days
                        if duration >= 0:
                            holding_durations.append(duration)
                    except Exception:
                        continue
        if holding_durations:
            plt.figure(facecolor='white')
            plt.hist(holding_durations, bins=range(1, max(holding_durations)+2), color='#1f77b4', alpha=0.7, rwidth=0.85)
            plt.title('Trade Holding Duration Distribution')
            plt.xlabel('Holding Duration (days)')
            plt.ylabel('Number of Trades')
            plt.tight_layout()
            abs_holding_duration_chart_path = os.path.abspath(holding_duration_chart_path)
            os.makedirs(os.path.dirname(abs_holding_duration_chart_path), exist_ok=True)
            plt.savefig(abs_holding_duration_chart_path)
            plt.close()
            md_lines.append("\n## Trade Holding Duration Distribution\n")
            md_lines.append(f"![Trade Holding Duration]({holding_duration_chart_path})\n")
    
        # --- Markdown Content ---
        # Section: Assumptions
        md_lines.append("## Assumptions: Slippage and Commission\n")
        commission = getattr(bt, '_commission', stats.get('strategy_params', {}).get('commission', 0.002))
        slippage = getattr(bt, '_slippage', stats.get('strategy_params', {}).get('slippage', 0.0))
        md_lines.append(f"- **Slippage:** A slippage of {slippage} per trade is applied to all executions (entry and exit prices adjusted by ±slippage). (slippage={slippage})\n")
        md_lines.append(f"- **Commission:** A fixed commission rate of {commission * 100:.2f}% per trade is applied, as set in the backtesting engine (commission={commission}).\n")
        md_lines.append("\nThese assumptions may affect real-world applicability and should be reviewed for live trading scenarios.\n")
        # Section: Performance Metrics
        md_lines.append("## Performance Metrics\n")
        strat_metrics = stats.get('strategy', {})
        bench_metrics = stats.get('benchmark', {})
        metrics = [
            f"- **Strategy Return:** {100 * strat_metrics.get('total_return', 0.0):.2f}%",
            f"- **Strategy Sharpe Ratio:** {strat_metrics.get('sharpe_ratio', 0.0):.2f}",
            f"- **Strategy Max Drawdown:** {100 * strat_metrics.get('max_drawdown', 0.0):.2f}%",
            f"- **Strategy Win Rate:** {100 * strat_metrics.get('win_rate', 0.0):.2f}%"
        ]
        if bench_metrics:
            metrics.extend([
                f"- **Benchmark Return:** {100 * bench_metrics.get('total_return', 0.0):.2f}%",
                f"- **Benchmark Sharpe Ratio:** {bench_metrics.get('sharpe_ratio', 0.0):.2f}",
                f"- **Benchmark Max Drawdown:** {100 * bench_metrics.get('max_drawdown', 0.0):.2f}%",
                f"- **Benchmark Win Rate:** {100 * bench_metrics.get('win_rate', 0.0):.2f}%"
            ])
        md_lines.extend(metrics)
        # Embed equity curve chart (legacy)
        if abs_legacy_equity_chart_path is not None and os.path.exists(abs_legacy_equity_chart_path):
            md_lines.append(f"\n![Equity Curve]({legacy_equity_chart_path})\n")
        # Benchmark Comparison Section (new)
        if abs_chart_path is not None and os.path.exists(abs_chart_path):
            md_lines.append(f"\n## Benchmark Comparison\n")
            md_lines.append(f"![]({chart_path})\n")
            # Minimal table comparing returns if both present
            strat_return = stats.get('Return [%]', None)
            bench_curve = stats.get('benchmark_curve') or stats.get('benchmark_equity_curve')
            if strat_return is not None and bench_curve is not None:
                # Calculate benchmark return as percent change from first to last
                bench_return = 100 * (bench_curve[-1] - bench_curve[0]) / bench_curve[0]
                md_lines.append("\n| Metric | Portfolio | " + benchmark_name + " |\n|---|---|---|")
                md_lines.append(f"| Total Return (%) | {strat_return:.2f} | {bench_return:.2f} |\n")
        # Drawdown Curve Section
        if abs_drawdown_chart_path is not None and os.path.exists(abs_drawdown_chart_path):
            md_lines.append(f"\n## Drawdown Curve\n")
            md_lines.append(f"![Drawdown Curve]({drawdown_chart_path})\n")
        # Return Distribution Section
        if abs_return_dist_chart_path is not None and os.path.exists(abs_return_dist_chart_path):
            md_lines.append(f"\n## Return Distribution\n")
            md_lines.append(f"![Return Distribution]({return_dist_chart_path})\n")
            if returns_dist is not None:
                mean = np.mean(returns_dist)
                std = np.std(returns_dist)
                outliers = (np.abs(returns_dist - mean) > 2 * std)
                if np.any(outliers):
                    md_lines.append("Note: Outlier(s) highlighted in red.\n")
        # Section: Trade Log
        md_lines.append("## Trade Log\n")
        trade_log = stats.get('trades') or stats.get('_trades')
        # Debug: Print trade log columns/keys for first entry
        if isinstance(trade_log, pd.DataFrame) and not trade_log.empty:
            print("DEBUG: Trade log columns:", list(trade_log.columns))
        elif isinstance(trade_log, list) and len(trade_log) > 0:
            print("DEBUG: Trade log keys (first entry):", list(trade_log[0].keys()))
        elif trade_log is not None:
            print("DEBUG: Trade log type:", type(trade_log))
        if isinstance(trade_log, pd.DataFrame):
            trade_log = trade_log.to_dict(orient='records')
        if isinstance(trade_log, list) and len(trade_log) > 0:
            # Helper for formatting numbers
            def fmt(val):
                if isinstance(val, float) or isinstance(val, int):
                    return f"{val:.2f}"
                return str(val)
            for trade in trade_log:
                def get_any(trade, *keys):
                    for k in keys:
                        v = trade.get(k)
                        if v not in (None, ""):
                            return v
                    return ''
                ticker = get_any(trade, 'ticker')
                entry_index = get_any(trade, 'entry_index', 'EntryIndex')
                exit_index = get_any(trade, 'exit_index', 'ExitIndex')
                entry_price = get_any(trade, 'entry_price', 'EntryPrice')
                exit_price = get_any(trade, 'exit_price', 'ExitPrice')
                pnl = get_any(trade, 'pnl', 'PnL')
                commission_cost = get_any(trade, 'commission_cost', 'CommissionCost')
                regime = get_any(trade, 'regime', 'Regime')
                exit_regime = get_any(trade, 'exit_regime', 'ExitRegime')
                volatility = get_any(trade, 'volatility', 'Volatility')
                exit_volatility = get_any(trade, 'exit_volatility', 'ExitVolatility')
                volume = get_any(trade, 'volume', 'Volume')
                exit_volume = get_any(trade, 'exit_volume', 'ExitVolume')
                atr_entry = get_any(trade, 'atr_entry', 'EntryATR')
                atr_exit = get_any(trade, 'atr_exit', 'ExitATR')
                entry_sma_short = get_any(trade, 'entry_sma_short', 'EntrySMA_Short', 'EntrySMA')
                exit_sma_short = get_any(trade, 'exit_sma_short', 'ExitSMA_Short', 'ExitSMA')
                entry_sma_long = get_any(trade, 'entry_sma_long', 'EntrySMA_Long')
                exit_sma_long = get_any(trade, 'exit_sma_long', 'ExitSMA_Long')
                entry_rsi = get_any(trade, 'entry_rsi', 'EntryRSI')
                exit_rsi = get_any(trade, 'exit_rsi', 'ExitRSI')
                rationale = get_any(trade, 'rationale', 'Rationale')
                context = trade.get('context', '')
                indicators = trade.get('indicators', '')
                # --- Output both bolded and plain versions for all critical trade log fields ---
                md_lines.append(f"**Ticker:** {ticker}")
                md_lines.append(f"Ticker: {ticker}")
                md_lines.append(f"**Entry:** {fmt(get_any(trade, 'entry_time', 'EntryTime', 'entry_index', 'EntryIndex'))}")
                md_lines.append(f"Entry: {fmt(get_any(trade, 'entry_time', 'EntryTime', 'entry_index', 'EntryIndex'))}")
                md_lines.append(f"**Entry Price:** {fmt(get_any(trade, 'entry_price', 'EntryPrice'))}")
                md_lines.append(f"Entry Price: {fmt(get_any(trade, 'entry_price', 'EntryPrice'))}")
                md_lines.append(f"**Exit:** {fmt(get_any(trade, 'exit_time', 'ExitTime', 'exit_index', 'ExitIndex'))}")
                md_lines.append(f"Exit: {fmt(get_any(trade, 'exit_time', 'ExitTime', 'exit_index', 'ExitIndex'))}")
                md_lines.append(f"**Exit Price:** {fmt(get_any(trade, 'exit_price', 'ExitPrice'))}")
                md_lines.append(f"Exit Price: {fmt(get_any(trade, 'exit_price', 'ExitPrice'))}")
                md_lines.append(f"**PnL:** {fmt(get_any(trade, 'pnl', 'PnL'))}")
                md_lines.append(f"PnL: {fmt(get_any(trade, 'pnl', 'PnL'))}")
                md_lines.append(f"**Commission Cost:** {fmt(get_any(trade, 'commission_cost', 'CommissionCost'))}")
                md_lines.append(f"Commission Cost: {fmt(get_any(trade, 'commission_cost', 'CommissionCost'))}")
                md_lines.append(f"**Position Size:** {fmt(get_any(trade, 'position_size', 'PositionSize'))}")
                md_lines.append(f"Position Size: {fmt(get_any(trade, 'position_size', 'PositionSize'))}")
                md_lines.append(f"**Entry Regime:** {get_any(trade, 'entry_regime', 'EntryRegime')}")
                md_lines.append(f"Entry Regime: {get_any(trade, 'entry_regime', 'EntryRegime')}")
                md_lines.append(f"**Exit Regime:** {get_any(trade, 'exit_regime', 'ExitRegime')}")
                md_lines.append(f"Exit Regime: {get_any(trade, 'exit_regime', 'ExitRegime')}")
                md_lines.append(f"**Entry Volatility:** {fmt(get_any(trade, 'entry_volatility', 'EntryVolatility'))}")
                md_lines.append(f"Entry Volatility: {fmt(get_any(trade, 'entry_volatility', 'EntryVolatility'))}")
                md_lines.append(f"**Exit Volatility:** {fmt(get_any(trade, 'exit_volatility', 'ExitVolatility'))}")
                md_lines.append(f"Exit Volatility: {fmt(get_any(trade, 'exit_volatility', 'ExitVolatility'))}")
                md_lines.append(f"**Entry Volume:** {fmt(get_any(trade, 'entry_volume', 'EntryVolume'))}")
                md_lines.append(f"Entry Volume: {fmt(get_any(trade, 'entry_volume', 'EntryVolume'))}")
                md_lines.append(f"**Exit Volume:** {fmt(get_any(trade, 'exit_volume', 'ExitVolume'))}")
                md_lines.append(f"Exit Volume: {fmt(get_any(trade, 'exit_volume', 'ExitVolume'))}")
                md_lines.append(f"**Entry SMA:** {fmt(get_any(trade, 'entry_sma_short', 'EntrySMA_Short', 'EntrySMA'))}")
                md_lines.append(f"Entry SMA: {fmt(get_any(trade, 'entry_sma_short', 'EntrySMA_Short', 'EntrySMA'))}")
                md_lines.append(f"**Exit SMA:** {fmt(get_any(trade, 'exit_sma_short', 'ExitSMA_Short', 'ExitSMA'))}")
                md_lines.append(f"Exit SMA: {fmt(get_any(trade, 'exit_sma_short', 'ExitSMA_Short', 'ExitSMA'))}")
                md_lines.append(f"**Entry RSI:** {fmt(get_any(trade, 'entry_rsi', 'EntryRSI'))}")
                md_lines.append(f"Entry RSI: {fmt(get_any(trade, 'entry_rsi', 'EntryRSI'))}")
                md_lines.append(f"**Exit RSI:** {fmt(get_any(trade, 'exit_rsi', 'ExitRSI'))}")
                md_lines.append(f"Exit RSI: {fmt(get_any(trade, 'exit_rsi', 'ExitRSI'))}")
                md_lines.append(f"**Rationale:** {get_any(trade, 'rationale', 'Rationale')}")
                md_lines.append(f"Rationale: {get_any(trade, 'rationale', 'Rationale')}")
                md_lines.append(f"**Context:** {trade.get('context', '')}")
                md_lines.append(f"Context: {trade.get('context', '')}")
                md_lines.append(f"**Indicators:** {trade.get('indicators', '')}\n")
                md_lines.append(f"Indicators: {trade.get('indicators', '')}\n")
        else:
            md_lines.append("No trade log available.\n")
        # Section: Regime Summary
        md_lines.append("## Regime Summary\n")
        params = stats.get('strategy_params', {})
        short_sma = params.get('short_window', 20)
        long_sma = params.get('long_window', 50)
        min_days = params.get('min_regime_days', 4)
        rsi_period = params.get('rsi_period', 14)
        overbought = params.get('overbought', 70)
        oversold = params.get('oversold', 30)
        md_lines.append("**Regime Definitions and Classification Criteria:**\n")
        md_lines.append(f"- **Trending:** A period where price exhibits a clear upward or downward movement, typically identified by the short-term SMA (window: {short_sma}) being consistently above (uptrend) or below (downtrend) the long-term SMA (window: {long_sma}) for more than {min_days - 1} days.\n")
        md_lines.append(f"- **Ranging:** A period where price oscillates within a horizontal channel, identified when the short-term SMA crosses above and below the long-term SMA frequently, with no sustained trend for more than {min_days - 1} days.\n")
        md_lines.append("- **Quantitative Parameters:**\n" +
            f"**Short SMA window:** {short_sma} days\n" +
            f"**Long SMA window:** {long_sma} days\n" +
            f"**Minimum regime duration:** {min_days} days (regimes shorter than this are filtered out)\n" +
            f"**RSI period:** {rsi_period}\n" +
            f"**RSI thresholds:** Overbought ({overbought}), Oversold ({oversold})\n"
        )
        regime_summary = stats.get('regime_summary')
        if regime_summary:
            md_lines.append(f"{regime_summary}\n")
        # Render filtered regime series table
        regime_series = stats.get('regime_series')
        if regime_series is not None and len(regime_series) > 0:
            # Pass min_days to the filter function
            def filter_regime_series(series, min_duration):
                filtered = []
                prev_regime = None
                start_date = None
                count = 0
                threshold = min_duration - 1 # Check against min_duration - 1
                for date, regime in series.items():
                    if regime != prev_regime:
                        # Use the threshold derived from min_duration
                        if prev_regime is not None and count > threshold:
                            filtered.append((start_date, date, prev_regime, count))
                        start_date = date
                        count = 1
                        prev_regime = regime
                    else:
                        count += 1
                # Handle last segment, using the threshold
                if prev_regime is not None and count > threshold:
                    filtered.append((start_date, date, prev_regime, count))
                return filtered
            # Call the function with the min_days parameter
            filtered_regimes = filter_regime_series(regime_series, min_days)
            if filtered_regimes:
                md_lines.append("\n| Start Date | End Date | Regime | Days |\n|---|---|---|---|")
                for start, end, regime, days in filtered_regimes:
                    md_lines.append(f"| {start} | {end} | {regime} | {days} |")
            else:
                # Update the message to use min_days
                md_lines.append(f"\n_No regime persisted more than {min_days - 1} days in a row._\n")
        # Trade-level chart with entry/exit markers and indicator overlays
        trade_chart_path = f"plots/trade_chart.png"
        price = stats.get('equity_curve')
        sma = stats.get('sma_curve')
        rsi = stats.get('rsi_curve')
        trades = stats.get('_trades')
        if trades is None or not hasattr(trades, 'iterrows'):
            trades = stats.get('trades')
        # Only plot summary chart if price and sma are 1D (not dict)
        if price is not None and sma is not None and trades is not None and not isinstance(price, dict) and not isinstance(sma, dict):
            plt.figure(facecolor='white')
            plt.plot(price, label='Price', color='#1f77b4')
            plt.plot(sma, label='SMA', color='orange')
            if rsi is not None and not isinstance(rsi, dict):
                ax1 = plt.gca()
                ax2 = ax1.twinx()
                ax2.plot(rsi, label='RSI', color='purple', alpha=0.4)
                ax2.set_ylabel('RSI', color='purple')
            # Plot trade entry/exit markers
            if hasattr(trades, 'iterrows'):
                for idx, trade in trades.iterrows():
                    entry = trade.get('entry_time')
                    entry_price = trade.get('entry_price')
                    exit = trade.get('exit_time')
                    exit_price = trade.get('exit_price')
                    if entry is not None and entry_price is not None:
                        plt.scatter(entry, entry_price, marker='^', color='green', label='Entry' if idx == 0 else "")
                    if exit is not None and exit_price is not None:
                        plt.scatter(exit, exit_price, marker='v', color='red', label='Exit' if idx == 0 else "")
            elif isinstance(trades, list):
                for i, trade in enumerate(trades):
                    entry = trade.get('entry_time')
                    entry_price = trade.get('entry_price')
                    exit = trade.get('exit_time')
                    exit_price = trade.get('exit_price')
                    if entry is not None and entry_price is not None:
                        plt.scatter(entry, entry_price, marker='^', color='green', label='Entry' if i == 0 else "")
                    if exit is not None and exit_price is not None:
                        plt.scatter(exit, exit_price, marker='v', color='red', label='Exit' if i == 0 else "")
            plt.legend(loc='best', frameon=True)
            plt.title('Trade Chart with Entry/Exit, SMA, Regime')
            plt.tight_layout()
            abs_trade_chart_path = os.path.abspath(trade_chart_path)
            os.makedirs(os.path.dirname(abs_trade_chart_path), exist_ok=True)
            plt.savefig(abs_trade_chart_path)
            plt.close()
            if os.path.exists(abs_trade_chart_path):
                md_lines.append(f"\n![Trade Chart]({trade_chart_path})\n")
        # If price is a dict (multi-ticker), skip this summary chart (per-ticker charts are generated below)
        # Trade Outcome Heatmap Visualization
        heatmap_chart_path = f"plots/trade_heatmap.png"
        trades_df = None
        if isinstance(trade_log, pd.DataFrame):
            trades_df = trade_log
        elif isinstance(trade_log, list) and len(trade_log) > 0:
            trades_df = pd.DataFrame(trade_log)
        if trades_df is not None and all(col in trades_df.columns for col in ['ticker', 'regime', 'pnl']):
            pivot = trades_df.pivot_table(index='ticker', columns='regime', values='pnl', aggfunc='mean', fill_value=0)
            plt.figure(figsize=(6,4), facecolor='white')
            sns.heatmap(pivot, annot=True, fmt=".2f", cmap="RdYlGn", cbar=True)
            plt.title('Trade Outcome Heatmap (Mean PnL by Ticker & Regime)')
            plt.tight_layout()
            abs_heatmap_chart_path = os.path.abspath(heatmap_chart_path)
            os.makedirs(os.path.dirname(abs_heatmap_chart_path), exist_ok=True)
            plt.savefig(abs_heatmap_chart_path)
            plt.close()
            md_lines.append(f"\n## Trade Outcome Heatmap\n")
            md_lines.append(f"![Trade Outcome Heatmap]({heatmap_chart_path})\n")
        # Section: Strategy Parameters
        md_lines.append("## Strategy Parameters\n")
        params = stats.get('strategy_params', {})
        if params:
            for k, v in params.items():
                md_lines.append(f"- **{k}:** {v}")
        else:
            md_lines.append("No strategy parameters available.\n")
        # Section: Risk and Position Sizing Logic
        if 'position_size' not in params or 'initial_cash' not in params:
            raise KeyError("Both 'position_size' and 'initial_cash' must be present in strategy parameters (from config.json).")
        position_size = params['position_size']
        initial_cash = params['initial_cash']
        percent_risked = (position_size / initial_cash) * 100 if initial_cash else 0
        max_positions = params.get('max_simultaneous_positions', None)
        md_lines.append("\n## Risk and Position Sizing Logic\n")
        md_lines.append(f"- **% Risked Per Trade:** {percent_risked:.2f}% of initial capital allocated to each trade (position_size={position_size}, initial_cash={initial_cash}).")
        md_lines.append("- **Allocation Rule:** Fixed allocation per trade; no leverage or short selling. Trades only executed if sufficient cash is available.")
        if max_positions is not None:
            md_lines.append(f"- **Max Simultaneous Positions:** {max_positions} (as set in configuration).")
        else:
            md_lines.append("- **Max Simultaneous Positions:** No explicit maximum; limited by available cash.")
        md_lines.append("\nEach trade allocates capital using a fixed position size. The number of shares bought is calculated as:\n")
        md_lines.append("\n    qty = int(position_size // price)\n")
        md_lines.append("\nThis ensures that:\n- No trade exceeds the specified position size or available cash.\n- No leverage or short selling is used.\n- Trades are only executed if sufficient cash is available.\n\nThis simple approach provides basic risk control by capping exposure per trade and preventing over-allocation. More advanced risk management (e.g., stop-loss, volatility targeting) is not implemented in this version.\n")
        # Section: Analyst Notes and Suggestions (substantive note)
        md_lines.append("## Analyst Notes and Suggestions\n")
        analyst_note = stats.get('analyst_notes', None)
        if analyst_note:
            md_lines.append(f"{analyst_note}\n")
        else:
            md_lines.append("The strategy underperformed in ranging markets; consider parameter tuning or regime filtering.\n")
        # Section: Rationale Summary
        md_lines.append("## Rationale Summary\n")
        trades = trade_log
        if isinstance(trades, pd.DataFrame):
            has_trades = not trades.empty
        else:
            has_trades = bool(trades)
        rationales = []
        if has_trades:
            if isinstance(trades, pd.DataFrame):
                for idx, trade in trades.iterrows():
                    if hasattr(trade, 'get'):
                        rationale = trade.get('rationale')
                        if rationale:
                            rationales.append(rationale)
                    elif isinstance(trade, str):
                        rationales.append(trade)
            elif isinstance(trades, list):
                for trade in trades:
                    if hasattr(trade, 'get'):
                        rationale = trade.get('rationale')
                        if rationale:
                            rationales.append(rationale)
                    elif isinstance(trade, str):
                        rationales.append(trade)
        if rationales:
            md_lines.append("\n".join([f"- {r}" for r in rationales]))
        else:
            md_lines.append("No rationale provided.\n")
        # Parameter Sensitivity Analysis
        param_sens_path = "plots/parameter_sensitivity.png"
        # Section header always present if results or plot exist
        if (parameter_sensitivity_results and len(parameter_sensitivity_results) > 0) or os.path.exists(param_sens_path):
            md_lines.append("\n## Parameter Sensitivity Analysis\n")
            if parameter_sensitivity_results and len(parameter_sensitivity_results) > 0:
                # Generate Markdown table
                keys = list(parameter_sensitivity_results[0].keys())
                md_lines.append("| " + " | ".join(keys) + " |")
                md_lines.append("|" + "---|" * len(keys))
                for row in parameter_sensitivity_results:
                    md_lines.append("| " + " | ".join(str(row[k]) for k in keys) + " |")
                md_lines.append("")
            if os.path.exists(param_sens_path):
                md_lines.append("The plot below compares equity curves for different parameter values, illustrating the impact of parameter changes on strategy performance.\n")
                md_lines.append(f"![Parameter Sensitivity]({param_sens_path})\n")
        # Strategy Logic Summary Section
        strategy_rule_summary = stats.get('strategy_rule_summary')
        if strategy_rule_summary:
            md_lines.append('## Strategy Logic Summary\n')
            md_lines.append(strategy_rule_summary + '\n')
        # Trade Duration and Exposure Statistics Section
        trade_duration_stats = stats.get('trade_duration_stats')
        if trade_duration_stats:
            md_lines.append('## Trade Duration and Exposure Statistics\n')
            md_lines.append(f"Average Duration: {trade_duration_stats['avg_duration']} days\n")
            md_lines.append(f"Median Duration: {trade_duration_stats['median_duration']} days\n")
            md_lines.append(f"Max Duration: {trade_duration_stats['max_duration']} days\n")
            md_lines.append(f"Average Portfolio Exposure: {trade_duration_stats['avg_exposure']*100:.1f}%\n")
        # Slippage/Commission Sensitivity Analysis Section
        slippage_commission_sensitivity = stats.get('slippage_commission_sensitivity')
        if slippage_commission_sensitivity:
            md_lines.append('## Slippage/Commission Sensitivity Analysis\n')
            md_lines.append('| Slippage | Commission | Sharpe | Return | Drawdown |\n')
            md_lines.append('|---|---|---|---|---|\n')
            for row in slippage_commission_sensitivity:
                md_lines.append(f"| {row['slippage']} | {row['commission']} | {row['sharpe']} | {row['return']} | {row['drawdown']} |\n")
        # Per-Period Benchmark Comparison Section
        per_period_benchmark = stats.get('per_period_benchmark')
        if per_period_benchmark:
            md_lines.append('## Per-Period Benchmark Comparison\n')
            md_lines.append('| Period | Strategy Return | Benchmark Return |\n')
            md_lines.append('|---|---|---|\n')
            for row in per_period_benchmark:
                md_lines.append(f"| {row['period']} | {row['strategy_return']} | {row['benchmark_return']} |\n")
        # Trade Statistics Breakdown
        md_lines.append("## Trade Statistics Breakdown\n")
        metrics = stats.get('strategy', {})
        if isinstance(trade_log, pd.DataFrame):
            has_trades = not trade_log.empty
        else:
            has_trades = bool(trade_log)
        if has_trades and metrics:
            md_lines.append("| Metric | Value |")
            md_lines.append("|---|---|")
            md_lines.append(f"| Average Win | {metrics.get('average_win', 0.0):.2f} |")
            md_lines.append(f"| Average Loss | {metrics.get('average_loss', 0.0):.2f} |")
            md_lines.append(f"| Largest Win | {metrics.get('largest_win', 0.0):.2f} |")
            md_lines.append(f"| Largest Loss | {metrics.get('largest_loss', 0.0):.2f} |")
            md_lines.append(f"| Profit Factor | {metrics.get('profit_factor', 0.0):.2f} |")
            md_lines.append(f"| Expectancy | {metrics.get('expectancy', 0.0):.2f} |")
        else:
            md_lines.append("No trade statistics available.\n")
        # Regime Breakdown
        md_lines.append("\n### Regime Breakdown\n")
        from tech_analysis.backtest import correlate_performance_with_regimes
        if isinstance(trade_log, pd.DataFrame):
            has_trades = not trade_log.empty
        else:
            has_trades = bool(trade_log)
        if has_trades:
            # Ensure trade_log is a list of dicts, not a DataFrame, before passing to correlate_performance_with_regimes
            if hasattr(trade_log, 'to_dict'):
                trade_log_records = trade_log.to_dict('records')
            else:
                trade_log_records = trade_log
            regime_stats = correlate_performance_with_regimes(trade_log_records)
            if regime_stats:
                md_lines.append("| Regime | Trades | Win Rate | Avg Win | Avg Loss | Largest Win | Largest Loss | Profit Factor | Expectancy | Mean PnL |")
                md_lines.append("|---|---|---|---|---|---|---|---|---|---|")
                for regime, regime_stat in regime_stats.items():
                    md_lines.append(
                        f"| {regime} | {regime_stat['count']} | {regime_stat['win_rate']:.2f} | {regime_stat['average_win']:.2f} | {regime_stat['average_loss']:.2f} | {regime_stat['largest_win']:.2f} | {regime_stat['largest_loss']:.2f} | {regime_stat['profit_factor']:.2f} | {regime_stat['expectancy']:.2f} | {regime_stat['mean_pnl']:.2f} |"
                    )
                # --- Regime-wise Barplot and Boxplot ---
                # Convert to DataFrame for plotting
                trades_df = pd.DataFrame(trade_log_records)
                if 'regime' in trades_df.columns and 'pnl' in trades_df.columns:
                    plots_dir = os.path.join(os.getcwd(), 'plots')
                    os.makedirs(plots_dir, exist_ok=True)
                    # Barplot: Mean PnL per regime
                    barplot_path = os.path.join(plots_dir, 'regime_barplot.png')
                    plt.figure(figsize=(5,3), facecolor='white')
                    sns.barplot(data=trades_df, x='regime', y='pnl', estimator='mean', errorbar=None, hue='regime', palette='Set2', legend=False)
                    plt.title('Mean PnL by Regime')
                    plt.xlabel('Regime')
                    plt.ylabel('Mean PnL')
                    plt.tight_layout()
                    plt.savefig(barplot_path)
                    plt.close()
                    md_lines.append(f"\n![Mean PnL by Regime](plots/regime_barplot.png)\n")
                    # Boxplot: PnL distribution per regime
                    boxplot_path = os.path.join(plots_dir, 'regime_boxplot.png')
                    plt.figure(figsize=(5,3), facecolor='white')
                    sns.boxplot(data=trades_df, x='regime', y='pnl', hue='regime', palette='Set2', legend=False)
                    plt.title('PnL Distribution by Regime')
                    plt.xlabel('Regime')
                    plt.ylabel('PnL')
                    plt.tight_layout()
                    plt.savefig(boxplot_path)
                    plt.close()
                    md_lines.append(f"\n![PnL Distribution by Regime](plots/regime_boxplot.png)\n")
            else:
                md_lines.append("No regime breakdown available.\n")
        else:
            md_lines.append("No trades for regime breakdown.\n")
        # --- Regime Barplot (always generate if regime_series present) ---
        regime_barplot_path = f"plots/regime_barplot.png"
        regime_series = stats.get('regime_series')
        if regime_series is not None and len(regime_series) > 0:
>           regime_counts = pd.Series(list(regime_series.values())).value_counts()
E           TypeError: 'numpy.ndarray' object is not callable

D:\Code\projects\tapp\code\2025\simpler_st\report_generator.py:686: TypeError
____________________ test_markdown_includes_trade_heatmap _____________________

tmp_path = WindowsPath('C:/Users/user/AppData/Local/Temp/pytest-of-user/pytest-262/test_markdown_includes_trade_h0')

    def test_markdown_includes_trade_heatmap(tmp_path):
        import numpy as np
        import pandas as pd
        stats = {
            'Return [%]': 10.0,
            'Sharpe Ratio': 1.0,
            'Max. Drawdown [%]': -4.0,
            '_trades': pd.DataFrame({
                'Ticker': ['A', 'B', 'A', 'B'],
                'PnL': [1, -1, 2, -2],
                'Regime': ['Trending', 'Ranging', 'Trending', 'Ranging']
            }),
            'regime_summary': 'Trending: 50%, Ranging: 50%',
            'strategy_params': {'position_size': 1, 'initial_cash': 1}
        }
        bt = dummy_bt()
        os.chdir(tmp_path)
        generate_markdown_report(stats, bt)
        chart_path = tmp_path / "plots/trade_heatmap.png"
>       assert chart_path.exists(), "Trade heatmap not generated."
E       AssertionError: Trade heatmap not generated.
E       assert False
E        +  where False = <bound method Path.exists of WindowsPath('C:/Users/user/AppData/Local/Temp/pytest-of-user/pytest-262/test_markdown_includes_trade_h0/plots/trade_heatmap.png')>()
E        +    where <bound method Path.exists of WindowsPath('C:/Users/user/AppData/Local/Temp/pytest-of-user/pytest-262/test_markdown_includes_trade_h0/plots/trade_heatmap.png')> = WindowsPath('C:/Users/user/AppData/Local/Temp/pytest-of-user/pytest-262/test_markdown_includes_trade_h0/plots/trade_heatmap.png').exists

D:\Code\projects\tapp\code\2025\simpler_st\tests\test_report_generation.py:343: AssertionError
---------------------------- Captured stdout call -----------------------------
DEBUG: Trade log columns: ['Ticker', 'PnL', 'Regime']
[INFO] Markdown report generated at reports/portfolio_report.md
_____________ test_markdown_includes_trade_level_chart_per_ticker _____________

tmp_path = WindowsPath('C:/Users/user/AppData/Local/Temp/pytest-of-user/pytest-262/test_markdown_includes_trade_l2')

    def test_markdown_includes_trade_level_chart_per_ticker(tmp_path):
        import pandas as pd
        stats = {
            'equity_curve': {
                'AAPL': [100, 102, 101, 105, 107, 106],
                'MSFT': [200, 202, 201, 205, 207, 206],
            },
            'sma_curve': {
                'AAPL': [100, 101, 101.5, 103, 104, 105],
                'MSFT': [200, 201, 201.5, 203, 204, 205],
            },
            'regime_series': {
                'AAPL': ['uptrend', 'uptrend', 'downtrend', 'downtrend', 'uptrend', 'uptrend'],
                'MSFT': ['downtrend', 'downtrend', 'uptrend', 'uptrend', 'downtrend', 'downtrend'],
            },
            '_trades': pd.DataFrame([
                {'Ticker': 'AAPL', 'EntryTime': 1, 'EntryPrice': 102, 'ExitTime': 4, 'ExitPrice': 107, 'PnL': 5.0, 'PositionSize': 10, 'Rationale': 'Buy: SMA cross'},
                {'Ticker': 'MSFT', 'EntryTime': 2, 'ExitTime': 5, 'EntryPrice': 202, 'ExitPrice': 206, 'PnL': 4.0, 'PositionSize': 8, 'Rationale': 'Sell: SMA cross'}
            ]),
            'strategy_params': {'position_size': 1, 'initial_cash': 1}
        }
        class DummyBT:
            def plot(self, filename=None, ticker=None):
                plt.figure()
                plt.plot([0, 1], [0, 1])
                plt.title(f"{ticker}")
                plt.savefig(filename)
                plt.close()
            _commission = 0.001
            @property
            def strategy(self):
                class DummyStrategy:
                    parameters = {'n1': 50, 'n2': 200}
                return DummyStrategy()
        bt = DummyBT()
        os.chdir(tmp_path)
        from report_generator import generate_markdown_report
        generate_markdown_report(stats, bt)
        for ticker in ['AAPL', 'MSFT']:
            chart_path = tmp_path / f"plots/trade_chart_{ticker}.png"
>           assert chart_path.exists(), f"Trade-level chart for {ticker} not generated."
E           AssertionError: Trade-level chart for AAPL not generated.
E           assert False
E            +  where False = <bound method Path.exists of WindowsPath('C:/Users/user/AppData/Local/Temp/pytest-of-user/pytest-262/test_markdown_includes_trade_l2/plots/trade_chart_AAPL.png')>()
E            +    where <bound method Path.exists of WindowsPath('C:/Users/user/AppData/Local/Temp/pytest-of-user/pytest-262/test_markdown_includes_trade_l2/plots/trade_chart_AAPL.png')> = WindowsPath('C:/Users/user/AppData/Local/Temp/pytest-of-user/pytest-262/test_markdown_includes_trade_l2/plots/trade_chart_AAPL.png').exists

D:\Code\projects\tapp\code\2025\simpler_st\tests\test_report_generation.py:672: AssertionError
---------------------------- Captured stdout call -----------------------------
DEBUG: Trade log columns: ['Ticker', 'EntryTime', 'EntryPrice', 'ExitTime', 'ExitPrice', 'PnL', 'PositionSize', 'Rationale']
[INFO] Markdown report generated at reports/portfolio_report.md
____________ test_markdown_includes_holding_duration_distribution _____________

tmp_path = WindowsPath('C:/Users/user/AppData/Local/Temp/pytest-of-user/pytest-262/test_markdown_includes_holding0')

    def test_markdown_includes_holding_duration_distribution(tmp_path):
        import pandas as pd
        import numpy as np
        from datetime import datetime, timedelta
        # Create dummy trades with varying holding durations
        base_date = datetime(2025, 4, 1)
        trades = []
        for i in range(5):
            entry = base_date + timedelta(days=i*5)
            exit = entry + timedelta(days=i+1)  # holding: 1,2,3,4,5 days
            trades.append({
                'EntryTime': entry.strftime('%Y-%m-%d'),
                'ExitTime': exit.strftime('%Y-%m-%d'),
                'EntryPrice': 100 + i*2,
                'ExitPrice': 105 + i*2,
                'PnL': 5.0 + i,
                'PositionSize': 10,
                'Rationale': 'Test trade'
            })
        stats = {
            'Return [%]': 10.0,
            'Sharpe Ratio': 1.0,
            'Max. Drawdown [%]': -4.0,
            '_trades': pd.DataFrame(trades),
            'strategy_params': {'position_size': 1, 'initial_cash': 1}
        }
        from report_generator import generate_markdown_report
        bt = dummy_bt()
        os.chdir(tmp_path)
        generate_markdown_report(stats, bt)
        chart_path = tmp_path / "plots/holding_duration.png"
        md_path = tmp_path / "reports/portfolio_report.md"
>       assert chart_path.exists(), "Holding duration histogram not generated."
E       AssertionError: Holding duration histogram not generated.
E       assert False
E        +  where False = <bound method Path.exists of WindowsPath('C:/Users/user/AppData/Local/Temp/pytest-of-user/pytest-262/test_markdown_includes_holding0/plots/holding_duration.png')>()
E        +    where <bound method Path.exists of WindowsPath('C:/Users/user/AppData/Local/Temp/pytest-of-user/pytest-262/test_markdown_includes_holding0/plots/holding_duration.png')> = WindowsPath('C:/Users/user/AppData/Local/Temp/pytest-of-user/pytest-262/test_markdown_includes_holding0/plots/holding_duration.png').exists

D:\Code\projects\tapp\code\2025\simpler_st\tests\test_report_generation.py:737: AssertionError
---------------------------- Captured stdout call -----------------------------
DEBUG: Trade log columns: ['EntryTime', 'ExitTime', 'EntryPrice', 'ExitPrice', 'PnL', 'PositionSize', 'Rationale']
[INFO] Markdown report generated at reports/portfolio_report.md
_____________________ test_markdown_includes_regime_plots _____________________

tmp_path = WindowsPath('C:/Users/user/AppData/Local/Temp/pytest-of-user/pytest-262/test_markdown_includes_regime_0')

    def test_markdown_includes_regime_plots(tmp_path):
        """
        Test that the Markdown report includes both a barplot (mean PnL per regime)
        and a boxplot (PnL distribution per regime) as static images in the regime breakdown section.
        """
        import pandas as pd
        from report_generator import generate_markdown_report
        trades = [
            {'PnL': 100, 'regime': 'trending'},
            {'PnL': -50, 'regime': 'trending'},
            {'PnL': 200, 'regime': 'ranging'},
            {'PnL': -30, 'regime': 'ranging'},
            {'PnL': 300, 'regime': 'trending'},
            {'PnL': -150, 'regime': 'volatile'},
        ]
        stats = {
            'equity_curve': [1000, 1100, 1050, 1250, 1220, 1520, 1370],
            'trades': trades,
            'strategy_params': {'position_size': 1, 'initial_cash': 1},
        }
        os.chdir(tmp_path)
        generate_markdown_report(stats, None)
        md_path = tmp_path / "reports/portfolio_report.md"
        assert md_path.exists(), "Markdown report not generated."
        with open(md_path, encoding="utf-8") as f:
            text = f.read()
        # Check for plot image references
>       assert "regime_barplot.png" in text, "Regime barplot not embedded in Markdown report."
E       AssertionError: Regime barplot not embedded in Markdown report.
E       assert 'regime_barplot.png' in '# Technical Analysis Report\n\n## Portfolio-Level Report\n\n---\n\n## Table of Contents\n\n1. [Cover Page](#technical... -30.00 | 6.67 | 85.00 | 85.00 |\n| volatile | 1 | 0.00 | 0.00 | -150.00 | 0.00 | -150.00 | 0.00 | -150.00 | -150.00 |'

D:\Code\projects\tapp\code\2025\simpler_st\tests\test_report_generation.py:770: AssertionError
---------------------------- Captured stdout call -----------------------------
DEBUG: Trade log keys (first entry): ['PnL', 'regime']
[INFO] Markdown report generated at reports/portfolio_report.md
________________ test_markdown_includes_strategy_rule_summary _________________

tmp_path = WindowsPath('C:/Users/user/AppData/Local/Temp/pytest-of-user/pytest-262/test_markdown_includes_strateg0')

    def test_markdown_includes_strategy_rule_summary(tmp_path):
        """
        Test that the Markdown report includes a plain-English summary of all strategy rules and exceptions.
        """
        stats = {
            'Return [%]': 10.0,
            'Sharpe Ratio': 1.0,
            'Max. Drawdown [%]': -4.0,
            'regime_summary': 'Trending: 60%, Ranging: 30%, Volatile: 10%',
            'strategy_params': {'position_size': 1, 'initial_cash': 1},
            'strategy_rules': [
                'Enter long when 10-period SMA crosses above 50-period SMA.',
                'Exit when 10-period SMA crosses below 50-period SMA.',
                'Skip trade if ATR(14) < 2.0.',
                'No trades on earnings announcement days.',
                'Position size is 2% of available capital, rounded down to nearest share.'
            ]
        }
        bt = dummy_bt()
        os.chdir(tmp_path)
        from report_generator import generate_markdown_report
        generate_markdown_report(stats, bt)
        md_path = tmp_path / "reports/portfolio_report.md"
        with open(md_path, encoding="utf-8") as f:
            text = f.read()
>       assert "Strategy Rules (Plain English)" in text, "Strategy rule summary section missing."
E       AssertionError: Strategy rule summary section missing.
E       assert 'Strategy Rules (Plain English)' in '# Technical Analysis Report\n\n## Portfolio-Level Report\n\n---\n\n## Table of Contents\n\n1. [Cover Page](#technical... Statistics Breakdown\n\nNo trade statistics available.\n\n\n### Regime Breakdown\n\nNo trades for regime breakdown.\n'

D:\Code\projects\tapp\code\2025\simpler_st\tests\test_report_generation.py:831: AssertionError
---------------------------- Captured stdout call -----------------------------
[INFO] Markdown report generated at reports/portfolio_report.md
============================== warnings summary ===============================
tests/test_report_generation.py::test_markdown_includes_trade_level_chart_per_ticker
  D:\Code\projects\tapp\code\2025\simpler_st\report_generator.py:692: UserWarning: Tight layout not applied. The bottom and top margins cannot be made large enough to accommodate all axes decorations.
    plt.tight_layout()

-- Docs: https://docs.pytest.org/en/stable/how-to/capture-warnings.html
=========================== short test summary info ===========================
FAILED tests/test_backtest_engine.py::test_rsi_strategy_basic - AttributeErro...
FAILED tests/test_backtest_engine.py::test_export_backtest_results_for_report
FAILED tests/test_pipeline.py::test_pipeline_generates_markdown_report - Type...
FAILED tests/test_pipeline.py::test_pipeline_uses_config_params - TypeError: ...
FAILED tests/test_report_generation.py::test_regime_table_filters_short_runs
FAILED tests/test_report_generation.py::test_markdown_includes_trade_heatmap
FAILED tests/test_report_generation.py::test_markdown_includes_trade_level_chart_per_ticker
FAILED tests/test_report_generation.py::test_markdown_includes_holding_duration_distribution
FAILED tests/test_report_generation.py::test_markdown_includes_regime_plots
FAILED tests/test_report_generation.py::test_markdown_includes_strategy_rule_summary
================== 10 failed, 51 passed, 1 warning in 13.13s ==================
